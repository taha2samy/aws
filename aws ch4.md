# **Amazon Virtual Private Cloud (VPC)**

---

**ุจุงููุณุจุฉ ูู `AWS Certified Solutions Architect Associate Exam Objectives`ุ ุงูุดุงุจุชุฑ ุฏู ุจูุบุทู ุฃูุฏุงู ุงูุงูุชุญุงู ุงููู ูููุง ุนูุงูุฉ ุจู `VPC`ุ ููููุง ุนูู ุณุจูู ุงููุซุงู ูููุณ ุงูุญุตุฑ:**

*   ๐ **Domain 1: Design Secure Architectures**
*   โป๏ธ **Domain 2: Design Resilient Architectures**
*   โก **Domain 3: Design High-Performing Architectures**
*   ๐ฐ **Domain 4: Design Cost-Optimized Architectures**

---

## **ููุฏูุฉ ุนู ุงูู `Amazon Virtual Private Cloud (VPC)`**

 `Amazon Virtual Private Cloud (VPC)` ุฏู ุญุชุฉ ุฃุณุงุณูุฉ ุฃูู ูู `AWS`ุ 
ุชูุฏุฑ ุชููู ุฅููุง ุงูู `networking layer` ุงููู ุจุชุดุชุบู ุนููู ุงูู `EC2 instances` ุจุชุงุนุชูุ 
ูุฃู `network resources` ุชุงููุฉ ูุฎุฏูุงุช `AWS` ุชุงููุฉ. ุจุจุณุงุทุฉ ูุฏูุ ุงูู `VPC` ูู `virtual network` ุฎุงุตุฉ ุจูู ุฃูุช ุจุณ.

**ุฅูู ูุนูู `virtual network` ุฎุงุตุฉ ุจููุ**
ุงูุฃูู ุฅููุง `isolated` ุจุดูู ูุงููุ ูุนูู ูุงูู ุนุงูู ุดุจูุฉ ุฎุงุตุฉ ุจูู ููุญุฏู ุฌูู `AWS Cloud`ุ ููุญุฏุด ุชุงูู ููุฏุฑ ููุตููุง `by default`. ุฃูุช ุงููู ุจุชุชุญูู ูููุง ูุชุญุฏุฏ ูู ุญุงุฌุฉ ุฌูู ุงูุดุจูุฉ ุฏูุ ูุงูู ุจุงูุถุจุท ุจุชุจูู
 `data center` ุฎุงุต ุจูู ุจุณ ุนูู `cloud`.

ุจุณ ุทุจุนุงูุ ูุด ูุญุจูุณุฉุ ุชูุฏุฑ ุชูุตู ุงูู `VPC` ุจุชุงุนู ุฏู ุจุฃู ุดุจูุฉ ุชุงููุฉ ุงูุช ุนุงูุฒูุง. ูููู ุชูุตูู ุจุงูู `Internet` ุนุดุงู ุงูู `users` ุจุชูุนู ููุฏุฑูุง ููุตููุง ููู `applications` ุจุชุงุนุชูุ ุฃู ุจุดุจูุงุช ุงูู `data center` ุจุชุงุนุชู ุงููู ุนูู ุงูุฃุฑุถ (`on-premises networks`) ุนุดุงู ุชุนูู `hybrid cloud setup`ุ ุฃู ุญุชู ุจู `VPCs` ุชุงููุฉ ููู ุฃู ูุนููุงุก ุชุงูููู ุฌูู `AWS` ุนุดุงู ูููููุง ุจุนุถ ุจุดูู `private`.

ุฎูู ุจุงูู ุจูู ูู ุงูููุทุฉ ุฏู ูููุณ ุฃูู: ุงูู `VPCs` ูุด ุจุณ ูู `EC2`. ูุฃ ุฏู ุญุฌุฑ ุฃุณุงุณ ูุฎุฏูุงุช `AWS` ูุชูุฑุฉ ุฌุฏุงู. ูุนูู ูููู ุฅุฒุงู ุงูู `VPC` ุฏู ุจูุดุชุบู ูู ููุชุงุญ ูุฌุงุญู ูู ุงูุงูุชุญุงูุ ูููุงู ุนุดุงู ุชุจูู `AWS architect` ุดุงุทุฑ. **ูุชูุชูุฑุด ุฅูู ูููู ุชุชุฌุงูู ุงูู `VPCs` ุฏู ููุฌุฑุฏ ุฅูู ูุด ุจุชุณุชุฎุฏู `EC2`ุ ุฏู ุชูููุฑ ุบูุท ุฌุฏุงู!** ุฃู `resource` ูููุฉ ุจุชุดุบููุง ูู `AWS`ุ ุบุงูุจุงู ูุชููู ุฌูู `VPC`.

## **`VPC` ู ุงูู `AWS Regions`:**

![Virtual Private Cloud icon](https://icon.icepanel.io/AWS/svg/Networking-Content-Delivery/Virtual-Private-Cloud.svg)

ุงูู `VPC` ุงููุงุญุฏุฉ ุฏู ุจุชุนูุด ุฌูู `AWS region` ูุงุญุฏุฉ ุจุณ. ูุนูู ูู ุนููุช `VPC` ูู `London region`ุ ูุด ูุชูุงูููุง ุธุงูุฑุฉ ุนูุฏู ูู `Ohio region` ูุซูุงู. ูู `region` ูููุง ุงูู `VPCs` ุจุชุงุนุชูุง ุงููุณุชููุฉ. ูุนุงุฏู ุฌุฏุงู ูุจูู ุนูุฏู `multiple VPCs` ูู ููุณ ุงูู `AWS account` ุจุชุงุนูุ ููููู ุชุนูู ุฃูุชุฑ ูู `VPC` ูู ููุณ ุงูู `region` ุงููุงุญุฏุฉ. ุนุดุงู ูุฎูู ุงูุฏููุง ุจุณูุทุฉ ูููููุฌุฉ ูุงุญูุง ุจูุชุนููุ ููุจุฏุฃ ุงูุดุฑุญ ุจุณููุงุฑูููุงุช ุจุชูุชุฑุถ ุฅู ุนูุฏูุง `VPC` ูุงุญุฏุฉ ุจุณ ูู `region` ูุงุญุฏุฉ. ูุจุนุฏ ูุฏูุ ููุง ูุชูุฏู ุดููุฉุ ููุฎุด ูู ุณููุงุฑูููุงุช ูููุง `multiple VPCs` ุฃูุชุฑ.

**ุงูู `VPC` ูุงูุดุจูุงุช ุงูุชูููุฏูุฉ:**
ูู ุฃูุช ุฑุงุฌู ุจุชุงุน `networking` ููุงูู ุงูู `components` ุจุชุงุนุช ุงูุดุจูุงุช ุงูุชูููุฏูุฉ (`TCP/IP network`)ุ ูุชูุงูู ุญุงุฌุงุช ูุชูุฑ ูู ุงูู `VPC` ุดุจููุง ุจุงูุธุจุท ููุชุชุนุฑู ุนูููุง. ููู ููุง ุจูู ุงููุฑู ุงูุฌููุฑู: ุนูู ุงูุฑุบู ูู ุฅู ุงูู `VPCs` ุจุชุดุชุบู ุจููุณ ูุจุฏุฃ ุงูุดุจูุฉ ุงูุชูููุฏูุฉุ ุฅูุง ุฅู ููู ูุฑููุงุช ูููุฉ ุฃูู.

ุฃูุจุฑ ูุฑู ูู ุฅู ุงูู `VPCs` ุฏู `scalable` ุจุดูู ูุง ููุงุฆู. ูุนูู ุชูุฏุฑ ุชูุณุน ูุชูุฏ ุงูุดุจูุฉ ุจุชุงุนุชู ุฒู ูุง ุฃูุช ุนุงูุฒ ูู ุบูุฑ ูุง ุชุญุชุงุฌ ุชุถูู ุฃู `physical hardware` ุฌุฏูุฏ. ุนุดุงู ุงูู `scalability` ุงูุฑููุจุฉ ุฏู ุชุจูู ููููุฉุ `AWS` ุนููุช `abstraction` ูุจุนุถ ุงูู `components` ุงููู ูุชูุงูููุง ูู ุฃู ุดุจูุฉ ุชูููุฏูุฉ (ุฒู ุงูู `switches` ูุงูู `VLANs`). ุงูุญุงุฌุงุช ุฏู ูุด ููุฌูุฏุฉ `physically` ูู ุงูู `VPC`. ุจุฏู ูุฏูุ ูู ูููุง ุนุจุงุฑุฉ ุนู
 `software functions` ุจุชุดุชุบู ูู ูุฑุง ุงูููุงููุณ ูุจุฃุณูุงุก ูุฎุชููุฉ ูู `AWS`ุ ูุฏู ุงููู ุจูุฎูู ุงูู `VPC` ูุฑูุฉ ููููุฉ ุฌุฏุงู.



### **`VPC CIDR Blocks` **

 ุงูู `VPC` ุฏู ุฒู ุฃู ุดุจูุฉ ุชูููุฏูุฉุ ูุงุฒู ูููู ููู ุนูู ุงูุฃูู `range`  ูุงุญุฏ ูู ุงูู `IP addresses` ุชููู ูุฑุง ุจุนุถูุง (`contiguous IP addresses`). ุงูู `range` ุฏู ุจูุนุจุฑ ุนูู ุจุญุงุฌุฉ ุงุณููุง 
**`Classless Inter-Domain Routing (CIDR) block`**.

ุงูู `CIDR block` ุฏู ูู ุงููู ุจูุญุฏุฏ ุจุงูุธุจุท ุฅูู ุงูู `IP addresses` ุงููู ูููู ูุฏููุง ููู `EC2 instances` ุจุชุงุนุชู ูุฃู `resources` ุชุงููุฉ ูุชุญุทูุง ุฌูู ุงูู `VPC` ุฏู. ููุง ุชูุฌู ุชุนูู `VPC` ุฌุฏูุฏุ ูุงุฒู ุฅุฌุจุงุฑู ุชุนูู `assign` (ุชุฏู) `primary CIDR block` ููู. ูุจุนุฏ ูุง ุชุนูู ุงูู `VPC`ุ ุจุชุงุฎุฏ ุงูู `primary VPC CIDR block` ุงููุจูุฑ ุฏู ูุชูุณูู ูุฃุฌุฒุงุก ุฃุตุบุฑ ุงุณููุง **`subnets`**ุ ูุงูู `subnets` ุฏู ูู ุงููู ุจุชุญุท ูููุง ุงูู `AWS resources` ุจุชุงุนุชู ุงููู ูุญุชุงุฌุฉ `IP addresses`.

ููู ุทุฑู ูุชูุฑ ุนุดุงู ุชุนุจุฑ ุนู `range` ูู ุงูู `IP addresses`ุ ุจุณ ุฃูุตุฑ ูุฃุดูุฑ ุทุฑููุฉ ูู ุงูู **`CIDR notation`**ุ ูุณุงุนุงุช ุจูุณูููุง `slash notation` (ุนุดุงู ูููุง ุนูุงูุฉ `slash /` ูู ุงูุขุฎุฑ).

*   ุนูู ุณุจูู ุงููุซุงูุ ูู ุนูุฏู ุงูู `CIDR` ุฏู: `172.16.0.0/16`. ุฏู ูุนูุงู ุฅูู ุฌูุงู ูู ุงูู `addresses` ุงููู ุจุชุจุฏุฃ ุจู `172.16`ุ ูุนูู ูู `172.16.0.0` ูุบุงูุฉ `172.16.255.255`. ูุฏู ุจูุฏููุง ุนุฏุฏ ุถุฎู ุฌุฏุงู ูู ุงูู `IP addresses`ุ ุชุญุฏูุฏุงู 65,536 `address` ุจุงูุธุจุท! (ูุซูุงู ูู ูุงู `/24` ูุงู ููุฏูู 256 `address`).

ูููู ุจุฑุถู ุชุณูุน ุฅู ุงูู `CIDR block` ุฏู ุจูุชูุงู ุนููู **`IP prefix`**. ุงูุฌุฒุก ุจุชุงุน `/16` ุงููู ูู ุขุฎุฑ ุงูู `CIDR` ุฏู ูู ุงููู ุจูุณููู **`prefix length`**. ุงูู `prefix length` ุฏู ุจูุนุจุฑ ุนู ุทูู ุงูู `subnet mask`ุ ูุงููู ูู ุญุงูุฉ ุงูู `VPC CIDR` ูููู ูููู ูู `/16` ูุบุงูุฉ `/28`.

**ููุญูุธุฉ ูููุฉ ุฃูู ููุง:** ููู **`inverse relationship`** (ุนูุงูุฉ ุนูุณูุฉ) ุจูู ุงูู `prefix length` ูุนุฏุฏ ุงูู `IP addresses` ุงููู ุฌูู ุงูู `CIDR` ุฏู. ูุนูู ูู ูุง ุงูู `prefix length` ุฏู ูุตุบุฑ (ุงูุฑูู ุงููู ุจุนุฏ ุงูู `/` ูุจูู ุฃุตุบุฑ)ุ ูู ูุง ุนุฏุฏ ุงูู `IP addresses` ุงููู ุฌูู ุงูู `CIDR` ุฏู ููุจุฑ. ุนุดุงู ูุฏูุ ุงูู `/28` `prefix length` ุจูุฏููู 16 `address` ุจุณุ ูู ุญูู ุฅู ุงูู `/16` `prefix length` ุจูุฏููู ุงูู 65,536 `address` ุงููู ุฐูุฑูุงูุง ููู.

ุงูู `IP` ููุง ุงุฎุชุตุงุฑ ูู `Internet Protocol version 4 (IPv4)`. ูุงูู `prefix lengths` ุงููุชุงุญุฉ ูู `IPv4` ุจุดูู ุนุงู ุจุชุจูู ูู `/0` ูุบุงูุฉ `/32`.

ุนูู ุงูุฑุบู ุฅูู ูููู ุชุญุฏุฏ ุฃู `IP range` ุตุญูุญ ุนุดุงู ูุจูู ุงูู `VPC CIDR` ุจุชุงุนูุ ุจุณ ุงูู **`best practice`** ูุงูุฃูุถู ุฏุงููุงู ุฅูู ุชุณุชุฎุฏู ูุงุญุฏ ูู ุงูู `ranges` ุฏู ุงููู ูุชุนุฑูุฉ ูู ุญุงุฌุฉ ุงุณููุง `RFC 1918` (ูุฏู `ranges` ูุฎุตุตุฉ ููุดุจูุงุช ุงูู `private` ุงููู ูุด ุจุชุธูุฑ ุนูู ุงูุฅูุชุฑูุช ูุจุงุดุฑุฉ) ุนุดุงู ุชุชุฌูุจ ุฃู `conflicts` (ุชุนุงุฑุถุงุช) ูุน ุงูู `public Internet addresses` (ุงูู `IPs` ุงููู ุจุชุชุดุงู ุนูู ุงูุฅูุชุฑูุช).

**ุงูู `RFC 1918` `ranges` ุฏู ูู:**
*   `10.0.0.0 โ 10.255.255.255` (ุงูู `CIDR` ุงูููุงูุฆ ูููุง ูู `10.0.0.0/8`)
*   `172.16.0.0 โ 172.31.255.255` (ุงูู `CIDR` ุงูููุงูุฆ ูููุง ูู `172.16.0.0/12`)
*   `192.168.0.0 โ 192.168.255.255` (ุงูู `CIDR` ุงูููุงูุฆ ูููุง ูู `192.168.0.0/16`)

**ููุทุฉ ูููุฉ ุฃูู ุฃูู ูุงุฒู ุชุงุฎุฏ ุจุงูู ูููุง:** ูู ุงูุช ูุงูู ุชุฑุจุท ุงูู `VPC` ุจุชุงุนู ุจุฃู ุดุจูุฉ ุชุงููุฉ โ ุณูุงุก ูุงูุช ุดุจูุฉ ุงูู `data center` ุจุชุงุนู ุงููู ุนูู ุงูุฃุฑุถ (`on-premises network`) ุฃู ุญุชู `VPC` ุชุงูู ุฌูู `AWS` โ ูุงุฒู ุชุชุฃูุฏ ูููุณ ุฃูู ุฅู ุงูู `VPC CIDR` ุงููู ูุชุฎุชุงุฑู **ูุด ุนุงูู `overlap` (ูุด ูุชุฏุงุฎู)** ูุน ุฃู `addresses` ูุณุชุฎุฏูุฉ ุจุงููุนู ูู ุงูุดุจูุฉ ุงูุชุงููุฉ ุฏู. ูู ุญุตู `overlap`ุ ุงูุดุจูุชูู ูุด ููุนุฑููุง ูููููุง ุจุนุถุ ููููู ุชุญุตูู ูุดุงูู ูุชูุฑ ูู ุงูู `routing` ูุงูุงุชุตุงู.



> [!IMPORTANT]
>
> ูุงุฒู ุชุจูู ุนุงุฑู ูููุณ ุฃูู ุฅูู **ูุชูุฏุฑุด ุชุบูุฑ ุงูู primary CIDR block ุจุนุฏ ูุง ุชุนูู ุงูู VPC ุจุชุงุนู**. ุงูุญุชุฉ ุฏู ูุด ุฒู ุฃู setting ูููู ุชุนุฏููุง ุจุนุฏูู. ุนุดุงู ูุฏูุ ูุจู ูุง ุชุนูู ุฃู VPC ุฌุฏูุฏุ ูููุฑ ูููุณ ุฃูู ูู ูู address requirements ุงููู ูููู ุชุญุชุงุฌูุง ุฏูููุชู ููู ุงููุณุชูุจู ููุงูุ ูุญุงูู ุชุชููุน ุงุญุชูุงุฌุงุชู ุตุญ ูู ุงูุฃูู. ูู ุงุฎุชุฑุช CIDR block ุตุบูุฑ ูุงุญุชุฌุช ุชูุจุฑู ุจุนุฏููุ ูุชุถุทุฑ ุชุนูู VPC ุฌุฏูุฏ ุฎุงูุต ูุชููู ูู ุญุงุฌุชู ุนูููุ ูุฏู ูุตุฉ ุชุงููุฉ ููููุฉ ููุชุนุจุฉ.



#### **`Secondary CIDR Blocks` **

 ุจูุง ุฅููุง ุนุฑููุง ุฅูู ูุชูุฏุฑุด ุชุบูุฑ ุงูู `primary CIDR block` ุจุชุงุน ุงูู `VPC` ุจุนุฏ ูุง ุชุนูููุ `AWS` ููุง ุจุชุฏููู ุญููู ุชุงููุฉ ุนุดุงู ุชูุณุน ุงูุดุจูุฉ ุจุชุงุนุชู ูู ุงุญุชุฌุช `IP addresses` ุฒูุงุฏุฉ ูู ุงููุณุชูุจู. ุงูุญู ุฏู ูู ุฅูู ูููู **ุงุฎุชูุงุฑููุง** ุชุนูู `specify` (ุชุญุฏุฏ) `secondary CIDR blocks` ูู `VPC` ุจุชุงุนู ุฏู ุจุนุฏ ูุง ุชููู ุนููุชู ุฎูุงุต.

ุจุณ ุงูู `secondary CIDR blocks` ุฏู ูููุง ุดุฑูุท ุนุดุงู ุชุดุชุบู ุตุญ:

1.  **ูุงุฒู ุชูุฌู ูุง ุฅูุง ูู ููุณ ุงูู `RFC 1918 address range` ุงููู ุงูู `primary CIDR` ุฌุงู ูููุ ูุง ุฅูุง ุชููู `publicly routable range`** (ูุนูู `IP range` ูููู ุชุดููู ุนูู ุงูุฅูุชุฑูุช).
2.  **ูุฃูู ุญุงุฌุฉ ุฅููุง `must not overlap` (ููุชุนุงุฏุด ุนูููุง ุฃู ูุชุชุฏุงุฎูุด)** ูุน ุงูู `primary CIDR block` ููุง ูุน ุฃู `secondary blocks` ุชุงููุฉ ุฃูุช ุนุงูููุง ุฌูู ููุณ ุงูู `VPC`.

**ุนุดุงู ููุถุญ ุจูุซุงู:**
*   ูู ุงูู `primary CIDR` ุจุชุงุน ุงูู `VPC` ุจุชุงุนู ูู `172.16.0.0/16`. ุฏู `range` ุฌุงู ูู ุนููุฉ ุงูู `172.16.0.0/12` (ุงููู ูู `172.16.0.0 โ 172.31.255.255`).
*   ููุง ูููุน ุชุนูู `secondary CIDR` ูููู `172.17.0.0/16`ุ ูููุ ูุฃู ุงูู `172.17.0.0/16` ุฏู ูุณู ุฌูู ููุณ ุนููุฉ ุงูู `172.16.0.0/12` ุงููู ุงูู `primary` ุจุชุงุนู ูููุงุ ููููุด ุจูููู `overlap`.
*   ูููุ ููููุนุด ุฎุงูุต ุชุญุฏุฏ `192.168.0.0/16` ูู `secondary CIDR`ุ ูุฃู ุฏู ุฌุงู ูู `RFC 1918 range` ูุฎุชููุฉ ุชูุงูุงู (`192.168.0.0/16`) ุนู ุงูู `range` ุจุชุงุน ุงูู `primary` ุจุชุงุนู (`172.16.0.0/12`).

**ูุตูุญุฉ ูููุฉ ุฌุฏุงู ูุฃูุช ุจุชุฎุชุงุฑ ุงูู `primary CIDR`:**
ูู ุจุชููุฑ ุฅูู ูููู ูู ุฃู ููุช ุชุญุชุงุฌ ุชุนูู `secondary CIDR` ูู ุงููุณุชูุจูุ ุฑูุฒ ุฃูู ูุฃูุช ุจุชุฎุชุงุฑ ุงูู `primary CIDR` ุจุชุงุนู ูู ุงูุจุฏุงูุฉ. ูู ุงุฎุชุฑุช `192.168.0.0/16` ูู `primary CIDR` (ูุงููู ูู `RFC 1918 range` ุตุบูุฑ ููุญุฏูุฏ)ุ ูุด ูุชูุฏุฑ ุชุนูู `secondary CIDR` ูู ุฃู `RFC 1918 address ranges` ุงูุชุงููุฉ (ูุนูู ูุด ูุชูุฏุฑ ุชุณุชุฎุฏู `10.0.0.0/8` ุฃู `172.16.0.0/12` ูู `secondary` ูุนุงู). ุนุดุงู ูุฏูุ ูู ูุงูู ุนูู ุชูุณุน ูุจูุฑ ูุณุชูุจูุงู ูู ุงูุดุจูุฉ ุงูุฏุงุฎููุฉุ ุณุงุนุงุช ุจูุจูู ุฃูุถู ุฅูู ุชุฎุชุงุฑ `primary CIDR` ูู ุงูู `range` ุงูุฃูุจุฑ ุฒู `10.0.0.0/8` ุนุดุงู ูุฏููู ูุณุงุญุฉ ุฃูุจุฑ ููุชูุณุน ุจู `secondary CIDRs` ูู ููุณ ุงูู `range` ูู ุงููุณุชูุจู.









---

#### **`IPv6 CIDR Blocks` **

ุจุต ูุง ูุนููุ ุจูุง ุฅู ุงูู `IPv4` ุจูู ุฎูุงุต ููู ูุดููุฉ ูู ุงูุนุฏุฏ ููุจูุงุด ููููุ ุงูู `IPv6` ุฌู ุนุดุงู ูุญู ุงููุดููุฉ ุฏู ููููุฑ ุนุฏุฏ `IP addresses` ูุง ููุงุฆู ุชูุฑูุจุงู.

ุจุงููุณุจุฉ ููู `IPv6 CIDR` ูู ุงูู `VPC` ุจุชุงุนูุ ููู ููุทุฉ ูููุฉ ุฌุฏุงู ูุงุฒู ุชุนุฑููุง: ุนูู ุนูุณ ุงูู `primary CIDR` ุจุชุงุน ุงูู `IPv4` ุงููู ุฃูุช ุจุชุฎุชุงุฑู ุจููุณู ูู `IP prefix`ุ ููุง ุฃูุช **ูุชูุฏุฑุด ุชุฎุชุงุฑ ุงูู `IPv6 CIDR` ุจุชุงุนู ุจูุฒุงุฌู** ูุจุดูู ุนุดูุงุฆู. ูุฃุ ููุง `AWS` ูู ุงููู ุจุชุนูู ุจุชุฏู `IPv6 CIDR` ูู `VPC` ุจุชุงุนู ููุง ุจุชุทูุจ ูููุง ูุฏู.

ุงูู `IPv6 CIDR` ุงููู `AWS` ุจุชุฏููููู ุฏู ุจูููู ุนุจุงุฑุฉ ุนู `publicly routable prefix`ุ ูุนูู `IP range` ุชูุฏุฑ ุชูุตูู ูุชุชุนุงูู ูุนุงู ูู `global unicast IPv6 address space`. ุฏู ูุนูุงู ุฅู ูู ุงูู `IPv6 addresses` ุงููู ุฌูู ุงูู `range` ุฏู ุจุชููู ูุงุจูุฉ ูููุตูู ูู ุงูู `Internet` ุจุดูู ูุจุงุดุฑ (ุทุจุนุงู ูู ุงูู `security groups` ูุงูู `network ACLs` ุนูุฏู ุชุณูุญ ุจูุฏู).

*   ุนูู ุณุจูู ุงููุซุงูุ ูููู `AWS` ุชุฏููู ุงูู `CIDR` ุฏู: `2600:1f18:2551:8900/56`.
*   **ููุญูุธุฉ ูููุฉ:** ุงูู `prefix length` ุจุชุงุน ุฃู `IPv6 VPC CIDR` ุจูุชู ุชุญุฏูุฏู ุจูุงุณุทุฉ `AWS` ุจูููู ุฏุงููุงู ` /56`.

**ุทุจ ูู ุฃูุง ุนูุฏู `public IPv6 CIDR block` ุฎุงุต ุจูุงุ**
ูู ุฃูุช ุจุงููุนู ุนูุฏู `public IPv6 CIDR block` ุฎุงุต ุจูู (ูุซูุงู ุฃูุช ุดุงุฑู `IPs` ุฏู ูู ูุฒูุฏ ุฎุฏูุฉ ุงูุฅูุชุฑูุช ุจุชุงุนู ุฃู ูู ุฌูุฉ ูุณุคููุฉ ุนู `IP addresses`)ุ ุฃููุฉ ูููู ุฌุฏุงู ุชุนููู `assign` ููู `VPC` ุจุชุงุนู ุจุงุณุชุฎุฏุงู ููุฒุฉ ุงุณููุง **`bring your own IP address (BYOIP)`**.

ููุง ุจุชุณุชุฎุฏู `BYOIP` ูุน `IPv6`ุ ุนูุฏู ุดููุฉ ูุฑููุฉ ูู ุงูู `prefix length`:
*   ูู ุนุงูุฒ ุงูู `IPv6 addresses` ุจุชุงุนุชู ุชููู ูุงุจูุฉ ูููุตูู ูู ุฎูุงู ุงูู `Internet` (ูุนูู ุนุงูุฒูุง `publicly routable`)ุ ูููู ุชุนูู `advertise` ูู `prefix length` ุตุบูุฑ ุฒู `/48`.
*   ูู ูุด ูุงุฑู ูุนุงู ุฅููุง ุชููู `publicly routable` ุจููุณ ุงูุฏุฑุฌุฉ ุฏูุ ุฃู ุนูุฏู `use case` ุชุงููุ ุฃูู `prefix length` ูููู ุชุณุชุฎุฏูู ูู `/56`.

ุจุงุฎุชุตุงุฑุ `AWS` ุจุชุฏููู `IPv6 CIDR` ุฌุงูุฒ ุจู `/56` ุนุดุงู ุชุณูู ุนูููุ ููู ุนูุฏู `IPs` ุฎุงุตุฉ ุจููุ ุชูุฏุฑ ุชุฏุฎููุง ุจู `BYOIP` ูุน ูุฑููุฉ ูู ุงูู `prefix length` ุญุณุจ ุงุญุชูุงุฌู.



> [!TIP]
>
>  ุนูู ุงูุฑุบู ูู ุฅูู ุชูุฏุฑ ุชูุนู ูุชุณุชุฎุฏู IPv6 ุจุดูู ูุงูู ูู ุงูู VPC ูุงูู subnets ุจุชุงุนุชูุ ุฅูุง ุฅู AWS ุจุชูุฑุถ ุนููู (ุญุชู ููุชูุง ูุฐุง) ูุฌูุฏ IPv4 CIDR block ุฃุณุงุณู ููู ูู ุงูู VPC ููุณู ูุฃู subnet ูุชุนููู ุฌูุงู.
>
> ุงูููุทุฉ ุงููููุฉ ููุง ุฅู ุงูู IPv4 ูุงูู IPv6 ุจูุดุชุบููุง ุจุดูู **ูุชูุงุฒู (Side-by-Side)**. ูุนูู ูู ูุงุญุฏ ูููู ุจููุตู ุงูู traffic ุจุชุงุนู ุจุทุฑููุฉ ูุณุชููุฉ ุชูุงูุงู ุนู ุงูุชุงููุ ููููุด ุจุฑูุชูููู ุจูุนุชูุฏ ุนูู ุงูุชุงูู ูู routing ุงูุฏุงุชุง ุจุชุงุนุชู ุฃู ุชุดุบูู ุงูู instances ุงููู ุจุชุณุชุฎุฏูู. ุจุจุณุงุทุฉุ ููุง ุฒู ูุณุงุฑูู ูููุตููู ููุงุชุตุงู ุฌูู ููุณ ุงูู subnet. ุงูู IPv4 ุฏู ุจูุจูู ููุฌูุฏ ูู architectural requirement ูู AWSุ ููู ุฃูุช ููู ูุทูู ุงูุญุฑูุฉ ูู ุฅูู ุชุฎูู IPv6 ูู ุงููุณุงุฑ ุงูุฃุณุงุณู ูุงูุฑุฆูุณู ููู communication ุจุชุงุนุชู.



------



------

> [!IMPORTANT]
>
> **ููููู ุงูู Default VPC**
>
> - **ุฅูู ููุ** ุฏู VPC AWS ุจุชุนูููููู ุจุดูู ุฃูุชููุงุชููู ุนุดุงู ุชุณูู ุนููู ุชุจุฏุฃ ุจุณุฑุนุฉ ูู ุบูุฑ ูุง ุชุจูู ุดุจูุฉ ูู ุงูุตูุฑ. ุจูููู ุฌูุงู public subnet ูู ูู Availability Zoneุ ู Internet Gatewayุ ู security group ุงูุชุฑุงุถู.
> - ุฃูุช ุจุชุจุฏุฃ ูุนูุฏู VPC ุฌุงูุฒ. ูุงูู best practice ูู ุงูุดุบู ุงูุญูููู ูู **ุฅูู ูุชุณุชุฎุฏูุด ุงูู Default VPC ุฏู ููู production**ุ ูุชุจูู ูุงุญุฏ ูุฎุตุต ุจููุณู ุนุดุงู ุชุชุญูู ูู ูู ุชูุตููุฉ
>
> ------



**`DNS Resolution` (`enableDnsSupport`)**

ููุง ุจุชูุนู ุฎุงุตูุฉ `DNS resolution` (ุงููู ูู ุจุชููู ูุชูุนูุฉ ุจุดูู ุงูุชุฑุงุถู ูู ุฃู `VPC` ุจุชุนููู)ุ ุฃูุช ูุฏู ุจุจุณุงุทุฉ ุจุชุดุบู **ุฎุฏูุฉ ุงูู `DNS server` ุงูุฏุงุฎููุฉ ุงููู `AWS` ุจุชููุฑูุง ููู `VPC` ุจุชุงุนู**. ุงูุฎุฏูุฉ ุฏู ูููุง ูุธููุชูู ุฃุณุงุณูุชูู:

1.  **ุจุชุฑุฏ ุนูู ุฃู `DNS query` (ุงุณุชุนูุงู `DNS`) ุทุงูุน ูู ุฃู `resource` ุฌูู ุงูู `VPC` ุจุชุงุนู.**
2.  **ุจุชุณูุญ ููู `resources` ุฏู ุฅููุง ุชุนูู `resolve`  ุงูู `public DNS hostnames`** (ุฒู `google.com`) ูู `IP addresses`.

ูู ุบูุฑ ุงูุฎุงุตูุฉ ุฏูุ ุงูู `EC2 instances` ุจุชุงุนุชู ูุชุจูู ูุนุฒููุฉ ุนู ุนุงูู ุงูู `DNS`ุ ููุด ูุชูุฏุฑ ุชููู ุฃู ุฎุฏูุฉ ุจุฑู ุจุงุณุชุฎุฏุงู ุงุณููุงุ ุฒู ูุซูุงู ุฅููุง ุชุนูู `download` ูู `update` ูู `repository` ุนูู ุงูุฅูุชุฑูุช.

> [!WARNING]
>
> **ุฅูู ูู ุงูู `Amazon-provided DNS Server` ุฏู ูุฅูู IPุ**
>
> ุงูู `Amazon-provided DNS Server` ูู ุฎุฏูุฉ `DNS resolver` ุจุชูุฏููุง `AWS` ุฌูู ุงูู `VPC` ุจุชุงุนู. ุงูุฎุฏูุฉ ุฏู ูููุง `IP address` ุซุงุจุช ููููุฒุ **ููู ุฏุงููุงู ุชุงูู `IP` ูู ุงูู `CIDR` ุงูุฑุฆูุณู ุจุชุงุน ุงูู `VPC` ููู**.
>
> *   **ุงููุนุงุฏูุฉ ูุญุณุงุจ ุนููุงูู:** ูู ุงูู `base` ุจุชุงุน ุงูู **`primary VPC CIDR`** ุจุชุงุนู + 2.
> *   **ูุซุงู ุนููู:** ูู ุงูู `VPC` ุจุชุงุนู ุงูู `primary CIDR` ุจุชุงุนู ูู `10.0.0.0/16`:
>     *   ุงูู `base` ูู `10.0.0.0`.
>     *   ุฅุฐูุ ุงูู `IP` ุจุชุงุน ุงูู `Amazon-provided DNS server` **ููู ุงูู `subnets` ุงููู ุฌูู ุงูู `VPC` ุฏู** ููููู **`10.0.0.2`**.
>     *   ููู ูุงู `172.31.0.0/16`ุ ููุจูู ุงูู `DNS server` ูู **`172.31.0.2`**.
>
> **ุทุจ ุฅุฒุงู ุงูู `instance` ุจุชูุตูู ูู ุฃู `subnet`ุ**
>
> ูููุง ุจุชูุฌู ุงูููุทุฉ ุงููููุฉ ุงููู ุฃูุช ูุงุญุธุชูุง. ุนูู ุงูุฑุบู ูู ุฅู ุนููุงู ุงูู `DNS server` ุซุงุจุช ูููุญุฏ ุนูู ูุณุชูู ุงูู `VPC` ูููุ ุฅูุง ุฅู ูู `subnet` ูู ุฏูุฑ ูู ุชูุตูู ุงูู `traffic` ุฏู.
>
> 1.  `AWS` ุจุชุญุฌุฒ 5 `IP addresses` **ูู ูู `subnet`** ุจุชุนููู. ูุงุญุฏ ูู ุงูู `IPs` ุงููุญุฌูุฒุฉ ุฏู (ููู ุงูู `IP` ุงูุชุงูุช ูู ุงูู `subnet range`ุ ูุนูู ูุซูุงู `10.0.1.2`) ุจูุชู ุงุณุชุฎุฏุงูู ุฏุงุฎูููุง ุนุดุงู ููุฌู ุงูู `DNS queries`.
> 2.  ููุง ุจุชุนูู `EC2 instance` ุฌูู ุฃู `subnet`ุ ูุธุงู ุงูุชุดุบูู ุจุชุงุนูุง ุจูุชุนููู `configuration` ุฃูุชููุงุชูู ุนู ุทุฑูู ุงูู `DHCP` ุนุดุงู ูุณุชุฎุฏู ุงูุนููุงู ุงูููุญุฏ (`10.0.0.2` ูู ูุซุงููุง) ูู `primary DNS server`.
> 3.  ููุง ุงูู `instance` ุจุชุจุนุช `DNS query` ููุนููุงู `10.0.0.2`ุ ุงูู `VPC Router` ุงููู ุฌูู ุงูู `subnet` ุจุชุงุนูุง ูู ุงููู ุจูููู ุฅู ุงูู `query` ุฏู ุฑุงูุญ ููู `DNS service` ุจุชุงุนุฉ `AWS`ุ ูุจููุฌูู ูููุฌูุฉ ุงูุตุญูุญุฉ ูู ูุฑุง ุงูููุงููุณ.
>
> 
>
> *   **ุนููุงู ุงูู `DNS Server` (`.2` address):** ูู ุนููุงู **ูุงุญุฏ ูุซุงุจุช** ููุญุณูุจ ูู ุงูู `VPC CIDR` ุงูุฑุฆูุณูุ ููู ุตุงูุญ ููู ุงูู `subnets` ุฏุงุฎู  ุงูู `VPC`.
> *   **ุญุฌุฒ ุงูู 5 `IPs`:** ุจูุชู **ุฏุงุฎู ูู `subnet` ุนูู ุญุฏุฉ**ุ ุนุดุงู ูู `subnet` ูููู ุนูุฏู ุงูู `infrastructure` ุงููุงุฒูุฉ ูุชูุฌูู ุงูู `traffic` ุจุชุงุนูุ ุจูุง ูู ุฐูู ุงูู `DNS traffic`.
>
> 

ุจุฑุงูู ุนูููุ ุฃูุช ููุงุญุธุชู ุตุญ 100% ููู ุงูุตููู. ููุง ูุนููุง ูุด ููุถูุนูู ูููุตูููุ ููุง ูุฌููู ูุนููุฉ ูุงุญุฏุฉุ ูุงูุนููุฉ ุฏู ูู ุฎุงุตูุฉ **`enableDnsHostnames`**.

ููุงูู ูุธุจูุทุ ุงูููุฑูุถ ุงูุงุชููู ููุฏูุฌูุง ุชุญุช ุนููุงู ุงูุฎุงุตูุฉ ุฏู ุนุดุงู ุงูุดุฑุญ ูููู ููุทูู ููุชูุงูู.

ุงุชูุถู ุงููุณุฎุฉ ุงูุฌุฏูุฏุฉ ุงููุฏูุฌุฉ ุงููู ุจุชุดุฑุญ ุงูููุถูุน ููุชูุฉ ูุงุญุฏุฉ:

---

### **ุฎุงุตูุฉ `DNS Hostnames (enableDnsHostnames)`: ุฅุฒุงู ุงูู `Instances` ุจุชุงุฎุฏ DNSุ**

ุฎุงุตูุฉ `enableDnsHostnames` ุฏู ูุด ุจุชุนูู ุญุงุฌุฉ ูุงุญุฏุฉุ ุฏู ูููุง ูุดูู ุฃู ุจุชุดุชุบู ุนูู ูุณุชูููู ูู ููุณ ุงูููุช. ูู ุงููุณุคููุฉ ุนู ุฅู ุงูู `instances` ุจุชุงุนุชู ูุจูู ูููุง identity ู dnsุ ุณูุงุก ูุงู publicุ ุฃู ูุงู private.

ุจุณ ูุจู ูุง ูุชููู  ููู ูุงุนุฏุฉ ุฃุณุงุณูุฉ ููููุฉ ุฌุฏูุง:

> [!WARNING]
>
> **`enableDnsHostnames` (ุฅูู ุชุฏู DNS) ุจุชุนุชูุฏ ุนูู `enableDnsSupport`**
>
> - ุนุดุงู ุชูุนู `enableDnsHostnames` ูุชุฎูููุง `true`ุ ูุงุฒู **ุฅุฌุจุงุฑู** ุชููู `enableDnsSupport` ูู ููุงู `true`.
> - **ูููุ** ูุฃู ูููุด ูุงูุฏุฉ ุฅูู ุชุฏู ููู `instances` ุจุชุงุนุชู `DNS`ุ ูู ุงูู `VPC` ููุณู ูุด ุนุงุฑู ูุนูู `resolve` ููุฃุณูุงุก ุฏู.



#### **1.  `Public DNS Hostname`**

ููุง ุจุชูุนู ุฎุงุตูุฉ `enableDnsHostnames`ุ ุฃูุช ุจุชุณูุญ ูู `AWS` ุฅููุง ุชุฏู **`public DNS hostname`** ููู `instances` ุจุชุงุนุชู. ุจุณ ุฏู ูุด ุจูุญุตู ููู ุงูู `instances`ุ ุฏู ุจูุญุตู **ุจุดุฑุท ุฃุณุงุณู**: ุฅู ุงูู `instance` ููุณูุง ูููู ูููุง **`public IP address`**. ูู ูุนูุฏูุงุดุ ูุด ููุชุนูููุง `public DNS hostname`.

*   **ุดูู ุงูู `Hostname` ุฏู ุจูุจูู ุฅููุ**
    ุจูููู ุงุณู ุทููู `AWS` ุจุชุนููู `generate`ุ ููุจูู ุนูู ุงูู `Public IP`ุ ูุดููู ุจูููู ุจุงูููุธุฑ ุฏู:
    `ec2-public-ipv4-address.region.compute.amazonaws.com`
    (ูุซูุงู: `ec2-54-123-45-67.us-east-1.compute.amazonaws.com`)

![image-20250808123257079](assets/image-20250808123257079.png)

---

#### **2. `Private DNS Hostname`**

ูู ููุณ ุงูููุชุ ูููุง ููุณ ุงูุฎุงุตูุฉ (`enableDnsHostnames`) ุจุชููู ูุชูุนูุฉุ `AWS` ุจุชุนูู ุญุงุฌุฉ ุชุงููุฉ ุฃูู ูุฃุดูู: ุจุชุฏู **`Private DNS Hostname`** **ููู `EC2 instance` ุจุชุชุนูู ุฌูู ุงูู `VPC`**ุ ุณูุงุก ูุงูุช `public` ุฃู `private`.

*   **ุดููู ุฅููุ**
    ุงูุงุณู ุฏู ุจูููู ูููุฒ ููุจูู ุนูู ุงูู `Private IP` ุจุชุงุน ุงูู `instance`ุ ูุดููู ุจูููู ูุงูุขุชู:
    `ip-10-0-1-50.us-east-1.compute.internal`

![image-20250808125616129](assets/image-20250808125616129.png)

ุงูุงุณู ุฏู ูู ูุณููุฉ ุงูุชูุงุตู ุจูู ุงูู instances ูุจุนุถูุง ุฌูู ุดุจูุชู ุงูุฎุงุตุฉ. ุทูู ูุง ุงูุฅุนุฏุงุฏูู (enableDnsSupport ู enableDnsHostnames) ูุชูุนูููุ ุฃู EC2 instance ูุชุนูููุง ูุชุงุฎุฏ ุงูู private DNS hostname ุจุชุงุนูุง ุจุดูู ุฃูุชููุงุชููู ูููููู ุดุบุงู ุนูู ุทูู.

ุงููุธุงู ุฏู ุจูุฏููู ุทุจูุฉ abstraction ุฃุณุงุณูุฉุ ุจุชุฎููู ุชุนูู ุชุตููู architecture ูุฑู ูุชูุฏุฑ ุชุตูุญู ุจุณูููุฉ. ูุนูู ุจุฏู ูุง ุชุฎูู ุงูู Web Server ุจุชุงุนู ูููู ุงูู Database ุจุงูู Private IP ุจุชุงุนูุง ุจุดูู ูุจุงุดุฑ (ูุฏู ุงุณูู hardcoding IP)ุ ุฃูุช ุจุชุณุชุฎุฏู ุฎุฏูุฉ ุฒู **Amazon Route 53 Private Hosted Zone** ุนุดุงู ุชุนูู DNS record ูุฎุตุต (ูุซูุงู db.internal.my-app) ูุชุฎููู ูุดุงูุฑ ุนูู ุงูู Private IP ุจุชุงุน ุงูู Database.

**ูููุง ุจูู ุจุชุดูู ุงูููุฉ ุงูุญููููุฉ:** ูู ุงุญุชุฌุช ูู ุงููุณุชูุจู ุชุณุชุจุฏู ุงูู instance ุจุชุงุนุฉ ุงูู Database ุฏู (ุนุดุงู ุจุงุธุช ุฃู ุนุดุงู ุชุนูููุง upgrade)ุ ุงูู instance ุงูุฌุฏูุฏุฉ ุฃููุฏ ูุชุงุฎุฏ Private IP ุฌุฏูุฏ ููุฎุชูู. ุจุฏู ูุง ุชูู ุนูู ูู ุงูู Web Servers ูุชุบูุฑ ุงูู IP ูู ุงูู configuration ุจุชุงุนุชููุ ูู ุงููู ูุชุนููู ูู ุฎุทูุฉ ูุงุญุฏุฉ: **ูุชุฎุด ุนูู Route 53 ูุชุนุฏู ุงูู DNS record ุฏู (db.internal.my-app) ุนุดุงู ูุดุงูุฑ ุนูู ุงูู Private IP ุงูุฌุฏูุฏ**. ุงูู Web Servers ูุชูุถู ุชููู ููุณ ุงูุงุณู ุงูุซุงุจุช ุงููู ูู ุญุงูุธุงูุ ูุงูู DNS ูููุฌููู ููู instance ุงูุฌุฏูุฏุฉ ูู ุบูุฑ ูุง ููุง ูุญุณูุง ุจุฃู ุญุงุฌุฉ. ุงูุขููุฉ ุฏู ุจุชูุตู "ูููุฉ ุงูุฎุฏูุฉ" ุนู "ุงูุณูุฑูุฑ ุงููุนูู ุงููู ุดุงูููุง"ุ ูุฏู ุจูุฎูู ุงูุณูุณุชู ุจุชุงุนู ูุณุชูุฑ ูุฅุฏุงุฑุชู ุณููุฉ ุนูู ุงููุฏู ุงูุทููู..

------

> [!IMPORTANT]
>
> **ููุญูุธุฉ ูููุฉ ุนู ุซุจุงุช ุงูู Private IP**
>
> ุนูู ุนูุณ ุงูู Public IP ุงููู ุจูุชุบูุฑ ูุน ูู ุนูููุฉ Stop/Start ููู EC2 instanceุ ุงูู **Private IP** ุงูุฃุณุงุณู ุจุชุงุน ุงูู instance **ูุตูู ููููู ุซุงุจุช ููุณุชูุฑ**. ุทุงููุง ุงูู instance ููุฌูุฏุฉ (ุญุชู ูู ูู ุญุงูุฉ stopped)ุ ุงูู Private IP ุจุชุงุนูุง ูุด ููุชุบูุฑ.
>
> ุณุจุจ ุงูุซุจุงุช ุฏู ูู ุฅู ุงูู Private IP ูุฑุจูุท ุจุดูู ุฏุงุฆู ุจุงูู Primary Network Interface (ENI) ุจุชุงุน ุงูู instanceุ ูุงูู ENI ุฏู ุจุชูุถู ูุฑุชุจุทุฉ ุจุงูู instance ุทูู ุนูุฑูุง. ุงูุซุจุงุช ุฏู ูู ุญุฌุฑ ุงูุฃุณุงุณ ุงููู ุจูุฎูู ุงูุชูุงุตู ุงูุฏุงุฎูู ุจูู ุงูู services ุฌูู ุงูู VPC ุจุชุงุนู ููุซูู ููุณุชูุฑุ ูุจูุฎูู ุงูู Private DNS Hostname ููู ูููุฉ ุญููููุฉ ูู ุงูุชุทุจููุงุช ุงูุนูููุฉ.
>
> ูุฏู ููุฎูู Private DNS Hostname ุซุงุจุช ุจุฑุฏู ูุงูู ุจูุนุชูุฏ ุนูู private ip

---



### **ุงููVPC Router**

ูู ููุจ ูู `VPC` ููู ุงูู `VPC Router` ุงููู ูู ุงูุนุถูุงุช ุงููู ุจุชูุฌู ุงูู `traffic`.

![Virtual router appliance to construct a VPC environment](https://symbols.getvecta.com/stencil_9/26_vpc-router.b72d081ff7.svg)

ููู ุงูู `Router` ุฏู ูุด ุจูุดุชุบู ูู ุฏูุงุบูุ ูุฃุ ุฏู ุจููุดู ุจุงููููู ุนูู ูุฌููุนุฉ ููุงุนุฏ ููุชูุจุฉ ูู ุญุงุฌุฉ ุงุณููุง **`Route Tables`**. ุงูู `Route Tables` ุฏู ูู ุงููู ุจุชุดุชุบู ูุนูู ููู `VPC`ุ ููู ุงููู ุจุชููู ููู `packet` ุจูุงูุงุช "ุฃูุช ุชุฑูุญ ูู ููุง" ู"ุฃูุช ุทุฑููู ูู ููุงู". ูู ูุงุนุฏุฉ ุฌูู ุงูุฌุฏูู ุฏู (ุจูุณูููุง `route`) ูููุง ุฌุฒุฆูู: **`Destination`** (ุงููุฌูุฉ ุงููู ุงูู `packet` ุฑุงูุญ ููุง) ู **`Target`** (getway ุงููู ุงูู `packet` ููุนุฏู ูููุง ุนุดุงู ููุตู ูููุฌูุฉ ุฏู ุณูุงุก internet getway ุงู vpn getway

![Amazon AWS Virtual Private Cloud (VPC) โ CISCONET Training Solutions](https://www.cisconetsolutions.com/wp-content/uploads/2024/11/vpc-vpn-private-subnet.png)

ูููุง ุจุชูุฌู ุงูููุทุฉ ุงูุฌููุฑูุฉ ูู ุชุตููู ุงูุดุจูุฉุ ููู ุฅู `AWS` ูุด ุจุชุฌุจุฑู ุนูู ุทุฑููุฉ ูุงุญุฏุฉุ ููู ุจุชุฏูู ูุธุงู ูุฑู ุจูุนุชูุฏ ุนูู ููุนูู ูู ุงูู `Route Tables`.

#### **ุงูู `Main Route Table`: **

ููุง ุจุชุนูู ุฃู `VPC` ุฌุฏูุฏุ `AWS` ุจุชุนููู **`Route Table` ูุงุญุฏ ุจุณ** ุจุดูู ุฃูุชููุงุชูููุ ูุฏู ุจูุณููู **`Main Route Table`**. ุงูุฌุฏูู ุฏู ุจูููู ููู `route` ูุงุญุฏ ุจุณ ุฃุณุงุณู ูููููุนุด ูุชูุณุญ: **ุงูู `local route`**. ุงูู `route` ุฏู ุจูููู "ุฃู `traffic` ุฑุงูุญ ูุฃู ุญุชุฉ ุฌูู ุงูู `VPC` ุฏู (`10.0.0.0/16` ูุซูุงู)ุ ุฎููู `local`". ูุฏู ูู ุงูุณุจุจ ุงููู ุจูุฎูู ุงูู `subnets` ูููุง ุชุนุฑู ุชููู ุจุนุถูุง ุจุดูู ุงูุชุฑุงุถู.

> [!IMPORTANT]
>
> ููู ุฏู (`10.0.0.0/16` ูุซูุงู)ุ ูุงูู cider block ุจุชุงุน vpc 

ูู ุงูุจุฏุงูุฉุ ุฃู `subnet` ุจุชุนููู ุจูุฑุชุจุท ููุญุฏู ุจุงูู `Main Route Table` ุฏู. ุฏู ูุนูุงู ุฅู ูู ุงูู `subnets` ุจุชุงุนุชู ุจุชุจุฏุฃ ููู ุจุชูุดู ุนูู ููุณ ูุฌููุนุฉ ุงูููุงุนุฏ ูููุณ "ูุงููู ุงููุฑูุฑ" ุงูููุญุฏ.

#### **ุงูู `Custom Route Tables`:**

ุงูููุฉ ุงูุญููููุฉ ุจูู ุจุชูุฌู ููุง ุชุนุฑู ุฅูู ูุด ูุญุจูุณ ูู ุงูู `Route Table` ุงููุงุญุฏ ุฏู. ุฃูุช ุชูุฏุฑ ุชุนูู **`Custom Route Tables`** ุจุงูุนุฏุฏ ุงููู ุฃูุช ุนุงูุฒู ุฌูู ููุณ ุงูู `VPC`.

ุงููุฏู ูููุง ุฅูู ุชูุตู ูุชุชุญูู ูู ูู `subnet` ููุญุฏู. ุจุชุนูู `Route Table` ุฌุฏูุฏ ุจููุงุนุฏ ูุฎุชููุฉ ุชูุงููุงุ ูุจุนุฏูู ุชุฑูุญ ููู `subnet` ุงููู ุฃูุช ุนุงูุฒู ูุชุฑุจุทู ุจุงูู `Route Table` ุงูุฌุฏูุฏ ุฏู ุจููุณู ูุจุดูู ูุจุงุดุฑ. ุฃูู ูุง ุจุชุนูู ูุฏูุ ุงูู `subnet` ุฏู ุจููุณู ุงูู `Main Route Table` ุฎุงูุต ูุจูุจุฏุฃ ููุดู ุนูู ุงูููุงุนุฏ ุงูุฌุฏูุฏุฉ ุงููู ูู ุงูู `Custom Route Table` ุจุชุงุนู. ุงูููุงุนุฏ ุฏู ูููู ุชูุฌู ุงูู `traffic` ูุฃูุฏุงู ูุชูุฑ ูุฎุชููุฉ ุฒู `Internet Gateway`, `NAT Gateway`, `VPN Gateway`, `VPC Peering Connection` ูุบูุฑูุง.

#### **ุงูุชุทุจูู ุงูุนููู: ูุตู ุงูู `Public` ุนู ุงูู `Private`**

ุฃุดูุฑ ูุซุงู ุจููุถุญ ุงููุตุฉ ุฏู ูู ููุง ุจููุตู ุงูู `subnets` ุงูุนุงูุฉ ุนู ุงูุฎุงุตุฉ:

*   **ููู `Public Subnet`:** ุจูุนููู `Custom Route Table` ููุญุท ููู `route` ูุงุถุญ ูุตุฑูุญ ุจูููู: "ุฃู `traffic` ุฑุงูุญ ููุฅูุชุฑูุช (`0.0.0.0/0`)ุ ุงุฑููู ุนูู ุงูู `Internet Gateway`". **ููู ุฏู ุงููู ุจูุฎูู ุงูู `subnet` ุฏู `public`ุ ูุด ุฃู ุญุงุฌุฉ ุชุงููุฉ.**

![Internet Gateway Diagram](https://www.cisconetsolutions.com/wp-content/uploads/2024/11/internet-gateway.png)

*   **ููู `Private Subnet`:** ุจูุณูุจู ุฒู ูุง ูู ูุฑุชุจุท ุจุงูู `Main Route Table`ุ ุงููู ูู ุจุทุจูุนุชู ูููููุด ุฃู `route` ููุฅูุชุฑูุชุ ูุฏู ุจูุถูู ุฅูู ููุถู ูุนุฒูู ููุญูู. **ุทุจ ูู `instance` ุฌูู ุงูู `Private Subnet` ุฏู ูุญุชุงุฌุฉ ุชุนูู `update` ูู ุงูุฅูุชุฑูุชุ** ููุง ุจูุนุฏู ูู ุงูู `Main Route Table` (ุฃู ุจูุนูู `custom route table` ุฎุงุต ุจุงูู `private subnets`) ููุถูู `route` ุจูููู: `0.0.0.0/0` -> `target: nat-gateway-xxxx`. ุจูุฏูุ ุงูู `private instances` ุชูุฏุฑ ุชุทูุน ููุฅูุชุฑูุชุ ููู ุงูุฅูุชุฑูุช ููุนุฑูุด ูุจุฏุฃ ุงุชุตุงู ุจููุง.

ุจุงูุทุฑููุฉ ุฏูุ ูุจูุฌุฑุฏ ุงุณุชุฎุฏุงู ุงุชููู `Route Tables` ุจุณุ ุจูููู ุนูููุง ุทุจูุชูู ุดุจูุฉ ูุฎุชููุชูู ุฌูู ููุณ ุงูู `VPC`ุ ูู ูุงุญุฏุฉ ูููุง ุณููู ูููุงุนุฏ ุฃูุงู ูุฎุชููุฉ ุชูุงููุง.

![Full VPC Architecture with Public and Private Subnets](https://dz2cdn1.dzone.com/storage/temp/14578716-1617089885596.png)
ูู `subnet` ูุงุฒู ูููู ูุฑุจูุท ุจู `Route Table` ูุงุญุฏ ุจุณ ูู ุฃู ููุช (ุนูุงูุฉ `one-to-one`). ููู ุงูู `Route Table` ุงููุงุญุฏ ูููู ูููู ูุฑุจูุท ุจูุฐุง `subnet` ูู ููุณ ุงูููุช (ุนูุงูุฉ `one-to-many`). ุงููุฑููุฉ ุฏู ูู ุงุณุชุฎุฏุงู ูุฐุง `Route Table` ูู ุงููู ุจุชุฏูู ุงูููุฉ ุฅูู ุชุตูู ุจููุฉ ุชุญุชูุฉ ููุดุจูุฉ ูุนูุฏุฉ ูุขููุฉ ุนูู `AWS`.

![่ๆ็งๆไบ็ฝ็ปVPC_vpc็ฝ็ป-CSDNๅๅฎข](https://i-blog.csdnimg.cn/blog_migrate/22ed7f9b34e222a7736603dec852960a.png)

AWS ุฎุตุตุช IP ููู service ุนุดุงู ุชูุธู ุงูุดุบู. ุงูู **IP ุงููู ุขุฎุฑู .1** ูู gateway  ุงููู ูู ุงูู traffic ุจูุนุฏู ุนูููุง ุนุดุงู ูุชูุฌู. ุฃูุง ุงูู **IP ุงููู ุขุฎุฑู .2** ููู ูุฌุฑุฏ endpoint ูุชุฎุตุต ูุฎุฏูุฉ ุงูู DNS ููุท. ูู ูุฑุง ุงูููุงููุณุ ุงูุฎุฏูุชูู ุฏูู ุดุบุงููู ุนูู ููุณ ุงูู infrastructure ุจุชุงุนุฉ ุงูู Router ูุนูู ุนูู ูู **IP ุงููู ุขุฎุฑู .1** ุ ููู ููู ูุงุญุฏุฉ ูููู IP ุฎุงุต ุจููุง ุนุดุงู AWS ุชูุตู ุจูู ูุธููุฉ ุงูู routing  ููุธููุฉ ุงูู DNS .

### **`DHCP Option Sets`**



ุฎุงุตูุฉ **`DHCP Option Sets`** ูู ูุงุญุฏุฉ ูู ุฃููู ุงูุฃุฏูุงุช ุงููู `AWS` ุจุชุฏููุง ูู ุนุดุงู ุชุชุญูู ูู ุงูู `network configurations` ุงูุฃุณุงุณูุฉ ุงููู ุงูู `EC2 instances` ุจุชุงุนุชู ุจุชุงุฎุฏูุง ุจุดูู ุฃูุชููุงุชููู ุฃูู ูุง ุชุดุชุบู ุฌูู ุงูู `VPC`. ููุฑ ููู ุนูู ุฅูู "ููู ุณูุงุณุฉ ุงูุดุจูุฉ" ุงููู ุจูุชุทุจู ุนูู ุงูู `VPC` ููู.

ุฃู `VPC` ุจุชุนูููุ ุณูุงุก ูุงู `Default` ุฃู `Custom`ุ ุจูุชุฑุจุท ุจู `DHCP Option Set` ุงูุชุฑุงุถู. ุงูุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉ ุฏู ุจุชุบุทู ุงูุฃุณุงุณูุงุช: ุจุชุฎูู ุงูู `instances` ุชุณุชุฎุฏู ุงูู `Amazon-provided DNS server` ูุจุชุฏููุง `domain name` ููุงุณุจ ููู `region`. ููู ุงูููุฉ ุงูุญููููุฉ ุจุชุธูุฑ ููุง ุจุชูุฑุฑ ุชุนูู **`Custom DHCP Option Set`** ุจููุณูุ ูุฏู ุจููุชุญูู ุงูุจุงุจ ุนุดุงู ุชุชุญูู ูู ุงูุฅุนุฏุงุฏุงุช ุฏู ุจุงูุชูุตูู:

#### **1. `Domain name` **
ููุง ุจุชูุฏุฑ ุชุญุฏุฏ ุงูู `domain suffix` ุงููู ุงูู `instances` ูุชุณุชุฎุฏูู ูู ุงูู `private DNS hostname` ุจุชุงุนูุง. ุจุฏู ุงูุงุณู ุงูุงูุชุฑุงุถู ุจุชุงุน `AWS` (ุฒู `eu-west-1.compute.internal`)ุ ูููู ุชุญุท ุงูู `domain` ุจุชุงุน ุดุฑูุชู (ุฒู `corp.mycompany.com`). ุงูุฎุทูุฉ ุฏู ุฃุณุงุณูุฉ ูู ุนุงูุฒ ุชุนูู `integration` ุณูุณ ูุน ุดุจูุฉ ุดุฑูุชู (`on-premises`) ุฃู ูู ุจุชุณุชุฎุฏู ุฎุฏูุงุช ุฒู `Route 53 Private Hosted Zones` ุนุดุงู ุชุฏูุฑ ุงูู `DNS` ุงูุฏุงุฎูู ุจุฃุณูุงุก ูููุง ูุนูู.

#### **2. `Domain name servers` (ุณูุฑูุฑุงุช ุงูู DNS)**
ุฏู ุฃูู ุฎุงุตูุฉ. ููุง ุจุชูุฏุฑ ุชุญุฏุฏ ุงูู `IP addresses` ุจุชุงุนุฉ ุงูู `DNS servers` ุงููู ูู ุงูู `instances` ูู ุงูู `VPC` ูุชููููุง. ุนูุฏู ูุฑููุฉ ูุงููุฉ: ูููู ุชุณูุจูุง `AmazonProvidedDNS` ุนุดุงู ุชุณุชุฎุฏู ุฎุฏูุฉ `AWS`ุ ุฃู ุชุญุท ุงูู `IPs` ุจุชุงุนุฉ ุงูู `Active Directory DNS servers` ุงููู ูู ุดุฑูุชู ุนุดุงู ุชุนูู `Hybrid DNS`ุ ุฃู ุชุญุท `IP` ุจุชุงุน `DNS resolver` ุฃูุช ุนุงููู ุจููุณู ุฌูู ุงูู `VPC` ุนุดุงู ุชุนูู `caching` ุฃู `filtering`.

#### **3. `NTP servers` **
ูู ุงูุฃูุธูุฉ ุงูุญุณุงุณุฉ ุฒู ุงูุฃูุธูุฉ ุงููุงููุฉ ุฃู ุงููู ุจุชุนุชูุฏ ุนูู `logging` ุฏูููุ ูุงุฒู ูู ุงูุณูุฑูุฑุงุช ุชููู ูุชููุฉ ุนูู ููุณ ุงูููุช ุจุงููููู. ููุง ุจุชูุฏุฑ ุชุญุท ุงูู `IP addresses` ุจุชุงุนุฉ ุณูุฑูุฑุงุช ุงูู `Network Time Protocol (NTP)` ุงููู ุฃูุช ุจุชุซู ูููุงุ ูุจูุฏู ุจุชุฌุจุฑ ูู ุงูู `instances` ุฅููุง ุชุธุจุท ุณุงุนุชูุง ูู ููุณ ุงููุตุฏุฑ ุงูููุญุฏุ ูุฏู ููู ุฌุฏูุง ููู `compliance` ูุงูู `auditing`.

#### **4. `NetBIOS name servers` & `NetBIOS node type`**
ุงูุฅุนุฏุงุฏูู ุฏูู ูุนุชุจุฑูุง `legacy` ููุฎุตุตูู ููุชูุงูู ูุน ุฃูุธูุฉ `Windows` ุงููุฏููุฉ ุฌุฏูุง ุงููู ูุณู ุจุชุนุชูุฏ ุนูู ุจุฑูุชูููู `NetBIOS` ุนุดุงู ุชุนูู `name resolution` ุนูู ุงูุดุจูุฉ. ูู 99% ูู ุญุงูุงุช ุงูุงุณุชุฎุฏุงู ุงูุญุฏูุซุฉุ **ูุชุณูุจ ุงูุฎุงูุงุช ุฏู ูุงุถูุฉ ุชูุงููุง**. ููู ูู ุจุชุนูู `migrate` ูุชุทุจูู ูุฏูู ุฌุฏูุง ุจูุนุชูุฏ ุนูู `WINS server`ุ ูุชุญุชุงุฌ ุชุญุท ุงูู `IP` ุจุชุงุนู ููุง ูุชุฎุชุงุฑ `node type 2 (P-node)` ุนุดุงู ูุดุชุบู ุตุญ ูู ุจูุฆุฉ `AWS` ุงููู ูุด ุจุชุฏุนู `broadcast`.

> [!TIP]
>
> ูู ุญุชุฉ ูู ุฑุงูู ูููุงุด ุงู ูุงุฒูู ุงุนุฑููุง ูุงูุดู
> **ุฅูู ูู ุงูู `NetBIOS`ุ (ูุตุฉ ูู ุฃูุงู ุฒูุงู)**
>
> ุจุต ูุงุจุงุดุงุ ูู ุฃูุงุฆู ุงูุชูุงูููุงุช ูุงูุชุณุนููุงุชุ ูุจู ูุง ุงูุฅูุชุฑูุช ูุงูู `TCP/IP` ูุจููุง ููุง ุงููุณูุทุฑูู ุนูู ุงูุนุงููุ `IBM` ุนููุช ุจุฑูุชูููู ุจุณูุท ุนุดุงู ุงูุฃุฌูุฒุฉ ุงููู ุดุบุงูุฉ `DOS` ู `Windows` ูู  ูุงุญุฏ `LAN` ุชุนุฑู ุชุดูู ุจุนุถ ูุชุดุงุฑู ุงููููุงุช ูุงูุทุงุจุนุงุช. ุงูุจุฑูุชูููู ุฏู ุงุณูู **`NetBIOS (Network Basic Input/Output System)`**.
>
> **ูุงู ุจูุนูู ุฅููุ**
> ูุงู ุจูุนูู ุญุงุฌุฉ ุฃุณุงุณูุฉ ุฌุฏูุง: ุจูุฏู ููู ุฌูุงุฒ ุนูู ุงูุดุจูุฉ **ุงุณู ูุฑูุฏ ููููุฒ** (ุฒู `HR-PC` ุฃู `SALES-PRINTER`)ุ ูุจูุณูุญ ููุฃุฌูุฒุฉ ุฅููุง ุชููู ุจุนุถ ุจุงูุฃุณูุงุก ุฏู ุจุฏู ุงูู `IPs` (ุงููู ูุงูุช ูุนูุฏุฉ ููุชูุง).
>
> **ูุงู ุจูุนุฑู ุงูุฃุณูุงุก ุฏู ุฅุฒุงูุ**
> ูุงู ุนูุฏู ุทุฑููุชูู:
>
> 1.  **`Broadcast` (ุตุฏุงุน):** ุงูุฌูุงุฒ ุงููู ุนุงูุฒ ูุนุฑู `IP` ุจุชุงุน `HR-PC`ุ ูุงู ุจูุตุฑุฎ ูู ุงูุดุจูุฉ ูููุง ููุณุฃู "ูุง ุฌูุงุนุฉุ ููู ูููู `HR-PC`ุ". `HR-PC` ููุง ูุงู ุจูุณูุน ุงููุฏุงุก ุฏูุ ูุงู ุจูุฑุฏ ุนููู ุจุงูู `IP` ุจุชุงุนู. ุงูุทุฑููุฉ ุฏู ูุงูุช ุจุชุนูู ุฏูุดุฉ ูุฒุญูุฉ ุฑููุจุฉ ูู ุงูุดุจูุงุช.
> 2.  **`WINS Server` (ุงูุญู ุงูุฃุฐูู):** ุงูุดุฑูุงุช ุงููุจูุฑุฉ ุนููุช ุณูุฑูุฑ ูุฑูุฒู ุงุณูู `WINS (Windows Internet Name Service)`. ุฏู ูุงู ุนุงูู ุฒู "ุฏููู ุงูุชูููููุงุช" ุจุชุงุน ุงูู `NetBIOS`. ุฃู ุฌูุงุฒ ุจููููุ ุจูุฑูุญ ูุณุฌู ุงุณูู ูุงูู `IP` ุจุชุงุนู ูู ุงูู `WINS server`. ูููุง ุฃู ุฌูุงุฒ ุชุงูู ูุญุจ ูููููุ ุจูุฑูุญ ูุณุฃู ุงูู `WINS server` ุงูุฃูู ุจุฏู ูุง ูุตุฑุฎ ูู ุงูุดุจูุฉ ูููุง.
>
> ---
>
> **ุทุจ ุฅูู ุนูุงูุฉ ุฏู ุจุงูู `DHCP Option Set` ุจุชุงุน `AWS`ุ**
>
> `AWS` ุนุงุฑูุฉ ุฅู ููู ุดุฑูุงุช ูุจูุฑุฉ ุฌุฏูุง ุนูุฏูุง ุชุทุจููุงุช ูุฏููุฉ (`legacy applications`) ููุชูุจุฉ ูู 20 ุฃู 30 ุณูุฉุ ููุณู ุดุบุงูุฉ ูุญุฏ ุงูููุงุฑุฏุฉ. ุงูุชุทุจููุงุช ุฏู ูููู ุชููู ูุชุจุฑูุฌุฉ ุฅููุง ุชููู ุณูุฑูุฑ ุงูู `database` ุจุชุงุนูุง ุจุงูุงุณู ุงูู `NetBIOS` ุจุชุงุนูุ ูุด ุจุงูู `DNS name`.
>
> ููุง ุงูุดุฑูุงุช ุฏู ุจุชุนูู `lift-and-shift` ููุชุทุจููุงุช ุฏู ูุชููููุง ุนูู `AWS`ุ ุงูุชุทุจููุงุช ุฏู ูุด ูุชุดุชุบู ุบูุฑ ูู ููุช ููุณ ุงูุจูุฆุฉ ุงููุฏููุฉ ุงููู ูุงูุช ูุชุนูุฏุฉ ุนูููุง.
>
> ูููุง ุจุชูุฌู ูุงูุฏุฉ ุงูุฎุงูุชูู ุฏูู ูู ุงูู `DHCP Option Set`:
>
> ![image-20250815174531557](assets/image-20250815174531557.png)
>
> **1. `NetBIOS name servers`**
>
> *   **ุฏู ุฎุงูุฉ "ุนููุงู ุณูุฑูุฑ ุงูู `WINS`":** ูู ุนูุฏู ุชุทุจูู ูุฏูู ูุญุชุงุฌ ูููู `WINS server` ุนุดุงู ูุนุฑู ุงูู `IPs` ุจุชุงุนุฉ ุงูุณูุฑูุฑุงุช ุงูุชุงููุฉุ ุฃูุช ุจุชุญุท ููุง ุงูู `IP address` ุจุชุงุน ุงูู `WINS server` ุจุชุงุนู (ุงููู ูููู ุชููู ุนุงููู ุนูู `EC2 instance` ุฌูู ุงูู `VPC`).
> *   ููุง ุจุชุนูู ูุฏูุ ุฃู `EC2 instance` (ุฎุตูุตูุง `Windows`) ูุชุงุฎุฏ ุงูู `configuration` ุฏู ููุชุนุฑู ุฃูุชููุงุชูู ุฅู ุฏู ูู ุฏููู ุงูุชูููููุงุช ุจุชุงุน ุงูู `NetBIOS` ุจุชุงุนูุง.
> *   ![image-20250815175116122](assets/image-20250815175116122.png)
>
> ุงูู NetBIOS Node Types**
>
> ุงูุฎุงูุฉ ุฏู ุจุชุฎููู ุชุฎุชุงุฑ ุงูุทุฑููุฉ (mode) ุงููู ุงูู Windows instance ูุชุณุชุฎุฏููุง ุนุดุงู ุชุฏูุฑ ุนูู IP ุจุชุงุน ุงุณู NetBIOS ูุนูู. ูู node type ูู ุนุจุงุฑุฉ ุนู ุงุณุชุฑุงุชูุฌูุฉ ุจุญุซ ูุฎุชููุฉ.
>
> **1. B-node (Broadcast)**
>
> - **ุฅุฒุงู ุจูุดุชุบูุ** ุฏู ุงูุทุฑููุฉ ุงูุจุฏุงุฆูุฉ. ุงูู instance ุจุชุตุฑุฎ ูู ุงูุดุจูุฉ ูููุง (broadcast) ูุจุชุณุฃู "ูุง ุฌูุงุนุฉุ ููู ูููู ุงูุณูุฑูุฑ ุงูููุงููุ". ุงูุณูุฑูุฑ ุตุงุญุจ ุงูุงุณู ุจูุฑุฏ ุนูููุง ุจุงูู IP ุจุชุงุนู.
> - **ููู ููููุนุด ูู AWSุ** ูุฃูู ุจูุนุชูุฏ ููููุง ุนูู ุงูู broadcastุ ูุงูู AWS VPC **ูุง ูุฏุนู ุงูู broadcast**. ูู ุงุฎุชุฑุช ุงูุงุฎุชูุงุฑ ุฏูุ ุงูู name resolution ูููุดู 100%.
>
> **2. P-node (Peer-to-Peer ุฃู Point-to-Point)**
>
> - **ุฅุฒุงู ุจูุดุชุบูุ** ุฏู ุงูุทุฑููุฉ ุงูููุธูุฉ. ุงูู instance ูุด ุจุชุตุฑุฎ ูู ุงูุดุจูุฉ. ูู ุจุชุฑูุญ ุชุณุฃู "ุฏููู ุงูุชูููููุงุช" ูุจุงุดุฑุฉุ ุงููู ูู ุงูู WINS server (ุฃู ุงูู NetBIOS name server). ูู ุจุชุจุนุช query ูุจุงุดุฑ (unicast) ููุณูุฑูุฑ ุฏูุ ููู ุจูุฑุฏ ุนูููุง ุจุงูู IP.
> - **ููู ุฏู ูู ุงูุตุญ ูู AWSุ** ูุฃูู ูุด ุจูุนุชูุฏ ุนูู broadcast ุฎุงูุต. ูู ุจูุณุชุฎุฏู ุงุชุตุงู ูุจุงุดุฑุ ูุฏู ุดุบุงู ูุฒู ุงููู ุฌูู ุงูู VPC. **ุนุดุงู ูุฏู ุฏู ูู ุงูุงุฎุชูุงุฑ ุงููุญูุฏ ุงููู AWS ุจุชูุตุญ ุจูู ูุจุชุฏุนูู.**
>
> **3. M-node (Mixed)**
>
> - **ุฅุฒุงู ุจูุดุชุบูุ** ุฏู ููุน ูุฌูู ุจูุญุงูู ูุฌูุน ุจูู ุงูุงุชููู. ุงูุฃูู ุจูุฌุฑุจ ูุนูู broadcast (B-node). ูู ูููุงุด ุฑุฏุ ุจูุฑูุญ ูุณุฃู ุงูู WINS server (P-node).
> - **ููู ููููุนุด ูู AWSุ** ูุฃูู ุจูุจุฏุฃ ุจุงูู broadcastุ ูุงูุฎุทูุฉ ุฏู ูุชูุดู ููุชุณุจุจ ุชุฃุฎูุฑ (delay) ูู ุบูุฑ ุฃู ูุงุฒูุฉ ูุจู ูุง ูุฑูุญ ููุฎุทูุฉ ุงูุชุงููุฉ ุงูุตุญ.
>
> **4. H-node (Hybrid)**
>
> - **ุฅุฒุงู ุจูุดุชุบูุ** ุฏู ุจุฑุถู ููุน ูุฌููุ ูููู ุฃุฐูู ูู ุงููู ูุจูู. ูู ุจูุนูู ุงูุนูุณ: ุงูุฃูู ุจูุฑูุญ ูุณุฃู ุงูู WINS server (P-node). ูู ุงูู server ุฏู ูุด ุจูุฑุฏ ุฃู ูุด ููุฌูุฏุ ุจูุถุทุฑ ููุฌุฃ ููุญู ุงูุฃุฎูุฑ ููู ุฅูู ูุนูู broadcast (B-node).
> - **ููู ุจุฑุถู ูุด ูุซุงูู ูู AWSุ** ุงูุฌุฒุก ุงูุฃููุงูู ููู (P-node) ููุดุชุบู ุตุญ. ููู ุงูุฌุฒุก ุงูุชุงูู (ุจุชุงุน ุงูู broadcast) ูููุดู. ูุธุฑููุง ูู ูููู ูุดุชุบูุ ููู P-node ุจูุถูู ุฅู ูููุด ุฃู ูุญุงููุงุช broadcast ูุงุดูุฉ ูุชุญุตู ูู ุงูุฃุณุงุณ.
>
> 
>
> ------
>
> ---
>
> **ุชูุถูุญ ุงูููุทุฉ ุงููู ุฃูุช ูููุชูุง (ููู ุตุญูุญุฉ ุชูุงููุง):**
>
> - **ุฌูู ุงูู VPC ููุณู (ุจูู EC2 instances):**
>   ุงูู Broadcast ููููุน ุชูุงููุง. ุนุดุงู ูุฏูุ ุงูุทุฑููุฉ ุงููุญูุฏุฉ ุงููู ุชุถูู ุจููุง ุงุชุตุงู NetBIOS ูู **P-node** (ุฅููู ูููููุง WINS server ูุจุงุดุฑุฉ).
> - **ููู ูู ุดุจูุฉ Hybrid (ููุง ุชุฑุจุท ุงูู VPC ุจุดุจูุฉ ุดุฑูุชู):**
>   ุดุจูุฉ ุดุฑูุชู ุงููู ุนูู ุงูุฃุฑุถ (on-premises) ูููู ุฌุฏูุง ุชููู ุดุจูุฉ ูุฏููุฉ ููุณู ุจุชุฏุนู ูุจุชุณุชุฎุฏู ุงูู **Broadcast**.
>
> **ูููุง ุจุชูุฌู ูุงูุฏุฉ ุงูู Options ุงูุชุงููุฉ ุฒู H-node:**
>
> ุชุฎูู ุงูุณููุงุฑูู ุฏู:
>
> 1. ุฃูุช ุนูุฏู EC2 instance ุนูู AWS.
> 2. ูุนูุฏู WINS server ูู ุงูุดุฑูุฉ (on-premises).
> 3. ูุนูุฏู ุณูุฑูุฑุงุช ุชุงููุฉ ูุฏููุฉ ูู ุงูุดุฑูุฉ ูุด ูุชุณุฌูุฉ ูู ุงูู WINS server ุฏู ูุจุชุนุชูุฏ ุนูู ุงูู Broadcast.
>
> ูู ุฎููุช ุงูู EC2 instance ุจุชุงุนุชู ุดุบุงูุฉ **H-node (Hybrid)**:
>
> - **ุงูุฎุทูุฉ ุงูุฃููู (ุงููุซุงููุฉ):** ุงูู instance ูุชุญุงูู ุชููู ุงูู WINS server ุงููู ูู ุงูุดุฑูุฉ ุนู ุทุฑูู ุงูู VPN/Direct Connect ุนุดุงู ุชุณุฃู ุนู ุงุณู ุณูุฑูุฑ ูุนูู. ูู ูููุชูุ ุฎูุงุต ุงูููุถูุน ุงูุชูู.
> - **ุงูุฎุทูุฉ ุงูุชุงููุฉ (ุงูุงุญุชูุงุทูุฉ):** ูู ุงูู WINS server ุฏู ููุน ุฃู ูุด ุจูุฑุฏุ ุฃู ุงูุงุณู ูุด ูุชุณุฌู ูููุ ุงูู EC2 instance ูุชุฑูุญ ุนุงููุฉ **Broadcast**. ุงูู Broadcast ุฏู ูุด ููุดุชุบู ุฌูู ุงูู VPC ููุณูุ ููู ูู ุงูู VPN ุจุชุงุนู ูุชุธุจุท ุฅูู ูุณูุญ ุจูุฑูุฑ ุงูู Broadcast traffic (ูุฏู ุฅุนุฏุงุฏ ูุชูุฏู)ุ ุงูู Broadcast ุฏู **ูููู ููุตู ูุดุจูุฉ ุงูุดุฑูุฉ ุงูุฏุงุฎููุฉ** ูุงูุณูุฑูุฑ ุงููุฏูู ุงููู ููุงู ูุณูุนู ููุฑุฏ ุนููู.
>
> ุงูู Options ุฒู M-node ู H-node ููุฌูุฏุฉ ุนุดุงู **ุงูุชูุงูููุฉ ูุน ุงูุดุจูุงุช ุงููุฌููุฉ (Hybrid Networks)**. ูู ุจุชุฏู ููู EC2 instance ุงููุฑููุฉ ุฅููุง ุชุฌุฑุจ ุงูุทุฑููุฉ ุงูุญุฏูุซุฉ ุงูุฃูู (P-node)ุ ููู ูุดูุชุ ุชุฑุฌุน ุชุฌุฑุจ ุงูุทุฑููุฉ ุงููุฏููุฉ (B-node) ุงููู ูููู ุชููู ูุณู ุดุบุงูุฉ ูู ุดุจูุฉ ุดุฑูุชู



#### **5. `IPv6 preferred lease time` (ูุฏุฉ ุฅูุฌุงุฑ IPv6)**
ูู ุงูู `VPC` ุจุชุงุนู ููุนู ููู `IPv6`ุ ุงูุฎุงุตูุฉ ุฏู ุจุชุฎููู ุชุชุญูู ูู ูุฏุฉ "ุฅูุฌุงุฑ" ุงูู `IPv6 address` ุงููู ุงูู `instance` ุจุชุงุฎุฏูุง ูู ุงูู `DHCPv6 server`. ุจุชูุฏุฑ ุชุญุฏุฏ ุงููุฏุฉ ุจุงูุซูุงูู. ุฏู ุฎุงุตูุฉ ูุชูุฏูุฉ ูููู ุชุญุชุงุฌูุง ูู ุนูุฏู ุณูุงุณุงุช ุฃูุงู ูุนููุฉ ุจุชุชุทูุจ ุชุบููุฑ ุงูู `IPs` ุจุดูู ุฏูุฑู. ูู ูุนูุฏูุด ูุชุทูุจ ุฒู ุฏูุ ุงูุฃูุถู ุชุณูุจูุง ูุงุถูุฉ ุนุดุงู ุชุณุชุฎุฏู ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ ุจุชุงุนุฉ `AWS`.

ูู ููุง ููุทุฉ ูุงุชูู  ุงุณููุจ ุชุนุงูู aws ูุน IPV4 ุบูุฑ IPV6 ุจุดูู ุชุงู ูุด ููุณ ุงูุงุฏุงุฑุฉ ู๏ปป ููุณ ุทุฑููุฉ ุงูุชุนุงูู ูููุด ูุฏุฉ preferred lease time ูููุด ุงูููุงู ุฏู ูู aws ูู IPV4 ูุธุฑุง ูุงุฎุชูุงู ุทุฑููุฉ ุงูุงุฏุงุฑุฉ ุจุทุฑููุฉ ุชุงูู 





"... ุทูุจุ ุฃูุง ูู engineer ุงุณุชูุงุฏ ุฅูู ุนููููุง ูู ูุฌุน ุงูุฏูุงุบ ุฏูุ ููู ุฃุนูู custom set ูุฃุณูุจ ุงูุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉ ุจุชุงุนุฉ AWSุ

ุงููุงูุฏุฉ ููุง ุถุฎูุฉุ ูุจุชุธูุฑ ูู ุงูุณููุงุฑูููุงุช ุงูุญููููุฉ ุจุชุงุนุช ุงูุดุฑูุงุชุ ูุฏู ุฃูููุง:

**1. ุฏูุฌ ุงูู VPC ูุน ุดุจูุฉ ุงูุดุฑูุฉ (Hybrid Cloud):****ุงููุถุน ุงูุทุจูุนู (ูุจู ุฃู ุญุงุฌุฉ):**
ุชุฎูู ุฅู ุดุฑูุชู ุนูุฏูุง Data Center ุนูู ุงูุฃุฑุถ (ุจูุณููู on-premises)ุ ูุนูุฏู ููุงู VPC ุนูู AWS. ุฏูููุชู ุนูุฏู ุดุจูุชูู ูููุตููู ุชูุงููุง:

1. **ุดุจูุฉ ุงูุดุฑูุฉ (On-premises):**
   - ูููุง ุณูุฑูุฑุงุช ูููุฉ ุฒู fileserver.corp.mycompany.com ู hr-app.corp.mycompany.com.
   - ููู DNS Server ุฏุงุฎูู (ุบุงูุจูุง ุจูููู ุฌุฒุก ูู Microsoft Active Directory) ูู ุงููุญูุฏ ุงููู ูุนุฑู ุฅู fileserver.corp.mycompany.com ุฏู ุงูู IP ุจุชุงุนู 192.168.1.10.
   - ุงูุฃุฌูุฒุฉ ุงููู ุฌูู ุงูุดุฑูุฉ ูุชุธุจุทุฉ ุฅููุง ุชุณุฃู ุงูู DNS Server ุฏู.
2. **ุดุจูุฉ AWS (VPC):**
   - ูููุง EC2 instances (ุฒู web-server ู analytics-server).
   - ุงูู EC2 instances ุฏู ูุชุธุจุทุฉ ุฅููุง ุชุณุฃู ุงูู Amazon-provided DNS server (ุงููู ูู ุงูู .2 address).
   - ุงูู DNS server ุจุชุงุน AWS ุฏู **ูุนูุฏููุด ุฃู ููุฑุฉ** ุนู ุงูุณูุฑูุฑุงุช ุงููู ูู ุดุฑูุชู. ูู EC2 instance ุณุฃูุชู ุนู fileserver.corp.mycompany.comุ ููุฑุฏ ุนูููุง ููููู "ูุนุฑูุด ุงูุงุณู ุฏู".

**ุงูุฎุทูุฉ ุงูุฃููู: ุฑุจุท ุงูุดุจูุชูู**

ุนุดุงู ุงูู instances ุงููู ูู ุงูู VPC ุชุนุฑู ุชููู ุงูุณูุฑูุฑุงุช ุงููู ูู ุงูุดุฑูุฉ (ูุงูุนูุณ)ุ ูุงุฒู ุงูุฃูู ูุนูู ุงุชุตุงู ุดุจูู ุจูููู. ุฏู ุจูุชู ุนู ุทุฑูู ุญุงุฌุฉ ูู ุงุชููู:

- **AWS Site-to-Site VPN**: ููู ูุดูุฑ ูุขูู ุจูุนุฏู ุนูู ุงูุฅูุชุฑูุช ูุณู ููููู ุนูู
- **AWS Direct Connect**: ุงุชุตุงู ูุงูุจุฑ ุฎุงุต ููุจุงุดุฑ ุจูู ุดุฑูุชู ู AWS ูุณู ููููู ุนูู

ุจุนุฏ ุงูุฎุทูุฉ ุฏูุ ุงูู EC2 instance ุชูุฏุฑ ุชุนูู ping ุนูู ุงูู IP ุจุชุงุน ุงูู fileserver (192.168.1.10) ููู ููุฑุฏ ุนูููุง. **ููู ุงููุดููุฉ ูุณู ููุฌูุฏุฉ: ุงูู instance ูุณู ูุด ุนุงุฑูุฉ ุชุนูู resolve ููุงุณู.**

**ุงูุฎุทูุฉ ุงูุชุงููุฉ ูุงูุฃุณุงุณูุฉ: ุชูุญูุฏ ุงูู DNS ุจุงุณุชุฎุฏุงู DHCP Option Set**

ูููุง ุจูุฌู ุฏูุฑ ุงูู DHCP Option Set ุนุดุงู ูุญู ุงููุดููุฉ ุฏู ูู ุฌุฐูุฑูุง:

1. **ุจูุนุฑู ุงูู IP ุจุชุงุน ุงูู DNS Server ุงููู ูู ุงูุดุฑูุฉ:** ููุชุฑุถ ุฅู ุงูู IP ุจุชุงุนู ูู 192.168.1.5.
2. **ุจูุฑูุญ ุนูู AWS ููุนูู Custom DHCP Option Set:**
   - ุจูุนูู set ุฌุฏูุฏ.
   - ูู ุฎุงูุฉ Domain name serversุ ุจุฏู ูุง ูุณูุจูุง AmazonProvidedDNSุ ุจููุชุจ ุงูู IP ุจุชุงุน ุงูู DNS Server ุจุชุงุน ุงูุดุฑูุฉ: **192.168.1.5**.
3. **ุจูุฑุจุท ุงูู Custom Set ุฏู ุจุงูู VPC ุจุชุงุนูุง:**
   ุจูุฌุฑุฏ ูุง ุชุนูู Associateุ ุจูุญุตู ุงูุขุชู ููุฑูุง:
   - ูู ุงูู EC2 instances ุงููู ูู ุงูู VPC (ุงูุฌุฏูุฏุฉุ ูุงููู ุดุบุงูุฉ ุญุงูููุง ุจุนุฏ reboot ุฃู DHCP lease renewal) ุจุชุงุฎุฏ configuration ุฌุฏูุฏุฉ ุจุชููููุง: "ูู ุนุงูุฒุฉ ุชุณุฃูู ุนู ุฃู ุงุณูุ ุฑูุญู ุงุณุฃูู ุงูุณูุฑูุฑ ุงููู ุนููุงูู 192.168.1.5".

ุฏูููุชู ููุง ุงูู web-server ุงููู ูู ุงูู VPC ูุญุชุงุฌ ููุตู ูููููุงุช ุงููู ุนูู fileserver.corp.mycompany.com:

1. ููุจุนุช DNS query ุจุงูุงุณู ุฏู.
2. ุงูู query ุฏู ูุด ููุฑูุญ ููู DNS ุจุชุงุน AWSุ ูุฃุ ููุฑูุญ ูุจุงุดุฑุฉ ููุณูุฑูุฑ ุงููู ูู ุงูุดุฑูุฉ (192.168.1.5) ุนู ุทุฑูู ููู ุงูู VPN ุฃู ุงูู Direct Connect.
3. ุงูู DNS Server ุจุชุงุน ุงูุดุฑูุฉ ููุฑุฏ ุนููู ูููููู "ุงูุงุณู ุฏู ุงูู IP ุจุชุงุนู ูู 192.168.1.10".
4. ุงูู web-server ุฏูููุชู ุจูู ูุนุงู ุงูู IPุ ูููุฏุฑ ูููู ุงูู fileserver ูุจุงุดุฑุฉ.

> [!IMPORTANT]
>
> 
>
> ููุง ุจุชุนูู `Custom DHCP Option Set` ูุชุฎูู ุงูู `EC2 instances` ุจุชุงุนุชู ุชุณุชุฎุฏู ุงูู `DNS server` ุจุชุงุน ุดุฑูุชู (`on-premises`) ุนุดุงู ุชุนุฑู ุชุนูู `resolve` ูููdns ุงูุฏุงุฎููุฉุ ุฃูุช ุจูุฏู ุจุชุญู ูุดููุฉ ูุจุชุฎูู ูุดููุฉ ุชุงููุฉ.
>
> **ุงููุดููุฉ:**
> ุงูู `DNS server` ุจุชุงุน ุดุฑูุชู ูุนูุฏููุด ุฃู ููุฑุฉ ุนู ุฃุณูุงุก ุฎุฏูุงุช `AWS` ุฒู ุงูู `RDS databases` ุฃู `S3 endpoints` (ุงููู ุจุชูุชูู ุจู `.amazonaws.com`). ุฏู ุจูุคุฏู ููุถุน ุงุณูู **`Split-Brain DNS`**: ุงูู `instances` ุจุชุนุฑู ุชูุตู ูุดุจูุฉ ุงูุดุฑูุฉุ ููููุง ุจุชููุฏ ุงููุฏุฑุฉ ุนูู ุงููุตูู ูุฎุฏูุงุช `AWS` ุจุงุณุชุฎุฏุงู ุฃุณูุงุฆูุง.
>
> **ุงูุญู:**
> ุนุดุงู ุชุญู ุงููุดููุฉ ุฏูุ ูุงุฒู ุชุนูู ูุธุงู `DNS` ูุฌูู ุจูุนุฑู ูููู ุงูุนุงูููู. ุฃุดูุฑ ุญููู ููููุถูุน ุฏู ููุง:
>
> 1.  **`Conditional Forwarding`:** ุจุชุฑูุญ ุนูู ุงูู `DNS server` ุจุชุงุนู ุงููู ูู ุงูุดุฑูุฉ ูุชุนูู ูุงุนุฏุฉ ุชูุฌูู ูุดุฑูุท ุจุชูููู: "ุฃู `query` ูุฌููู ูู `domain` ุจุชุงุน `.amazonaws.com`ุ ูุฑุฑู (`forward`) ุนูู ุทูู ููู `Amazon-provided DNS server` (ุงููู ูู ุงูู `.2` address) ููู ููุฑุฏ ุนููู".
>
> 2.  **`Route 53 Resolver` (ุงูุญู ุงูุฃูุถู):** ุจุชุณุชุฎุฏู ุฎุฏูุฉ `AWS` ุงููุฎุตุตุฉ ููููุถูุน ุฏู. ุจุชุฎูู ูู ุงูู `queries` ุชุฑูุญ ููู `Resolver` ุงูุฃููุ ููู ุงููู ุจููุฑุฑ ุจุฐูุงุก: ูู ุงูู `query` ูุงุณู ุฏุงุฎูู ูู ุดุฑูุชูุ ุจูุจุนุชู ููู `DNS` ุจุชุงุน ุงูุดุฑูุฉุ ููู ูุฎุฏูุฉ `AWS`ุ ุจูุนูููุง resolve ุชููู localy ุฌูู `AWS` ุนูู ุทูู.
>
> ุจุงุฎุชุตุงุฑุ ุชุนุฏูู ุงูู `DHCP Option Set` ููุญุฏู ูุด ูุงููุ ููุงุฒู ุชูููู ุจูุงุญุฏ ูู ุงูุญููู ุฏูู ุนุดุงู ุชุถูู ุฅู ุงูู `DNS` ูุดุชุบู ุตุญ ูู ุจูุฆุฉ ุงูู `Hybrid Cloud`.



------

**2. Centralized Time Sync ุงููุดููุฉ: ููู ุงูููุช ููู ุฃููุ**

ูู ุนุงูู ุงูููุจููุชุฑุ ุงูููุช ูุด ูุฌุฑุฏ ุฃุฑูุงู ุนูู ุงูุดุงุดุฉุ ุฏู ุฃุณุงุณ ูู ุญุงุฌุฉ ุชูุฑูุจูุง:

- **Logging & Troubleshooting:** ุชุฎูู ุนูุฏู ูุดููุฉ ุญุตูุช ุจูู ุณูุฑูุฑูู. ูู ุฑุญุช ุชุจุต ุนูู ุงูู logs ุจุชุงุนุฉ ูู ูุงุญุฏุ ููููุช ุฅู ุงูุณุงุนุฉ ูู ุงูุณูุฑูุฑ ุงูุฃูู ูุชูุฏูุฉ 5 ุซูุงูู ุนู ุงูุณูุฑูุฑ ุงูุชุงููุ ูุณุชุญูู ูุชุนุฑู ุชุฑุชุจ ุงูุฃุญุฏุงุซ ุตุญ ูุชุนุฑู ููู ุจุนุช ูููู ุงูุฃูู ูุฅูู ุงููู ุณุจุจ ุงููุดููุฉ.
- **Transactions ุงููุงููุฉ:** ูู ุฃู ูุธุงู ูุงููุ ุงูู timestamp (ุจุตูุฉ ุงูููุช) ุจุชุงุน ูู ุนูููุฉ ูู ุฏููู ูุงุทุน. ุฃู ุงุฎุชูุงู ููู ุจุฃุฌุฒุงุก ูู ุงูุซุงููุฉ ูููู ูุณุจุจ ููุงุฑุซ ูู ุงูุญุณุงุจุงุช.
- **Security & Authentication:** ุจุฑูุชููููุงุช ูุชูุฑ ุฒู Kerberos (ุงููู ุจูุณุชุฎุฏูู Active Directory) ุจุชุนุชูุฏ ุนูู ุฅู ูู ุงูุฃุทุฑุงู ูุชููุฉ ุนูู ููุณ ุงูููุช. ูู ููู ุงุฎุชูุงูุ ุนูููุฉ ุงูู authentication ุจุชูุดู.
- **ุงูู Distributed Systems:** ุงูุฃูุธูุฉ ุงูููุฒุนุฉ ุจุชุนุชูุฏ ุนูู timestamps ุนุดุงู ุชุนุฑู ุญุงูุฉ ุงูุจูุงูุงุช ูุชุนูู synchronization ุจูู ุงูู nodes.

**ุงููุถุน ุงูุงูุชุฑุงุถู ูู AWS:**
ุจุดูู ุงูุชุฑุงุถูุ ุงูู EC2 instances ุงููู ุจุชุณุชุฎุฏู Amazon Linux ุจุชููู ูุชุธุจุทุฉ ุฅููุง ุชุนูู sync ููููุช ุจุชุงุนูุง ูู ุฎุฏูุฉ Amazon Time Sync Service. ุฏู ุฎุฏูุฉ ููุชุงุฒุฉ ูุฏูููุฉ ุฌุฏูุง.

**ุทุจ ุฅูุชู ุจุญุชุงุฌ ุฃุบูุฑ ุงููุถุน ุงูุงูุชุฑุงุถูุ**

ููุง ุจุชูุฌู ุญุงูุงุช ุงูุงุณุชุฎุฏุงู ุงููู ุจุชุฎูู Custom DHCP Option Set ุถุฑูุฑู:

1. **ุงูู Compliance ููุชุทูุจุงุช ุงูุชุฏููู:**
   ุจุนุถ ุงูุตูุงุนุงุช (ุฒู ุงูุจููู ุฃู ุงูุฌูุงุช ุงูุญููููุฉ) ุจูููู ุนูุฏูุง ูุชุทูุจุงุช ุตุงุฑูุฉ ุจุชููู ุฅู ูู ุงูุณูุฑูุฑุงุช ูุงุฒู ุชุนูู sync ูู ูุตุฏุฑ ููุช ุฏุงุฎูู ูููุซู (authoritative time source) ููุฌูุฏ ุฌูู ุงูุดุฑูุฉ. ููููุนุด ุชุนุชูุฏ ุนูู ุฎุฏูุฉ ุฎุงุฑุฌูุฉ ุญุชู ูู ูุงูุช AWS.
2. **ุงูู Hybrid Cloud (ุชุงูู):**
   ูู ุนูุฏู ุณูุฑูุฑุงุช ุนูู AWS ูุณูุฑูุฑุงุช ูู ุงูู data center ุจุชุงุนู ุนูู ุงูุฃุฑุถุ ุฃูุช ูุญุชุงุฌ **ูู ุงูุณูุฑูุฑุงุช ุฏูุ ูู ุงูููุงููู**ุ ุชููู ูุชููุฉ ุนูู ููุณ ุงูููุช ุจุงูุธุจุท. ุงูุญู ุงููุญูุฏ ูู ุฅูู ุชุฎูููู ูููู ูุจุตูุง ุนูู ููุณ ุงูู NTP server ุงููุฑูุฒู.

**ุฅุฒุงู DHCP Option Set ุจูุญูู ุฏูุ**

ุงูุญู ุจูููู ุจููุณ ุงูุทุฑููุฉ ุงููู ุนูููุงูุง ูุน ุงูู DNS:

1. **ุจุชุญุฏุฏ ุงูู NTP Server ุจุชุงุนู:** ุจูููู ุนูุฏู NTP server ููุซููุ ุณูุงุก ูุงู ุฌูู ุงูู data center ุจุชุงุนู (ูุซูุงู 192.168.1.20) ุฃู ูููู ุชุนูู ูุงุญุฏ ุฌูู ุงูู VPC ููุณู.
2. **ุจุชุนูู Custom DHCP Option Set:**
   - ุจุชุฑูุญ ุชุนูู set ุฌุฏูุฏ.
   - ูู ุฎุงูุฉ **NTP servers**ุ ุจุชูุชุจ ุงูู IPs ุจุชุงุนุฉ ุงูู NTP servers ุงููู ุฃูุช ุนุงูุฒ ูู ุงูู instances ุชุณุชุฎุฏููุง. ูููู ุชุญุท ูุบุงูุฉ 4 servers ุนุดุงู ูู ูุงุญุฏ ููุนุ ุงูู instance ุชุฑูุญ ููู ุจุนุฏู.
3. **ุจุชุฑุจุท ุงูู Custom Set ุจุงูู VPC:**
   ุจูุฌุฑุฏ ูุง ุชุฑุจุทูุ ุฃู EC2 instance ุฌุฏูุฏุฉ ุฃู ูุฏููุฉ ุจุชุงุฎุฏ ุงูู configuration ุฏู ุนู ุทุฑูู ุงูู DHCPุ ููุธุงู ุงูุชุดุบูู ุจุชุงุนูุง ุจูููู ุฃูุชููุงุชูู ุฅูู ูุงุฒู ูุธุจุท ุณุงุนุชู ูู ุงูู NTP servers ุงููู ุฃูุช ุญุฏุฏุชูุง ุฏู.

ูู ุงูุณูุฑูุฑุงุช ุงููู ูู ุงูู VPC ุจุชุงุนูุ ููู ุงูุณูุฑูุฑุงุช ุงููู ูู ุงูู data center ุจุชุงุนูุ ูููู ุจูุธุจุทูุง ุณุงุนุชูู ูู ููุณ ุงููุตุฏุฑ. ุจูุฏูุ ููุง ุชุจุต ุนูู ุงูู logs ุจุชุงุนุช ุฃู systemุ ุจุชููู ูุชุฃูุฏ 100% ุฅู ุงูู timestamps ูุชุทุงุจูุฉ ููููุด ุฃู ูุฌุงู ููุฎุทุฃุ ูุฏู ุจูุฎูู ุญูุงุชู ูู ุงูู troubleshooting ูุงูู auditing ุฃุณูู ุจูุชูุฑ.

**3. ุชุญุณูู ุงูู DNS Performance ูุงูุฃูุงู:****ุงููุดููุฉ ูู ุงููุถุน ุงูุงูุชุฑุงุถู:**
ูู ุงููุถุน ุงูุนุงุฏูุ ูู `instance` ูู ุงูู `VPC` ุจุชุงุนู ููุง ุจุชุญุชุงุฌ ุชุนูู `resolve` ูู `DNS name` (ุฒู `api.github.com`)ุ ุจุชุจุนุช `query` ููู `Amazon-provided DNS server` (ุงููู ูู ุงูู `.2` address). ุงูุณูุฑูุฑ ุฏู ุจูุฑูุญ ูุณุฃู ุนูู ุงูุฅูุชุฑูุช ููุฑุฌุนูู ุจุงูุฅุฌุงุจุฉ. ุงูุนูููุฉ ุฏู ุณุฑูุนุฉุ ููู ูููุง ููุทุชูู ุถุนู:

1.  **`Latency`:** ูู ูุฑุฉ ุจุชุณุฃู ูููุงุ ููู ุฑุญูุฉ ุจุชุญุตู ุจูู ุงูู `VPC` ุจุชุงุนู ูุณูุฑูุฑุงุช `AWS` ุนุดุงู ุชุฌูุจูู ุงูุฅุฌุงุจุฉ. ูู ุจุชุนูู ุขูุงู ุงูู `queries` ูู ุงูุฏูููุฉุ ุงูู `latency` ุฏู ุจุชุชุฌูุน ููููู ุชุจุทุฃ ุงูุชุทุจูู ุจุชุงุนู.
2.  **ูููุด ุชุญูู:** ุฃูุช ูููุด ุฃู ุณูุทุฑุฉ ุนูู ุงููู ุจูุญุตู ูู ุงูู `DNS server` ุจุชุงุน `AWS`. ูุชูุฏุฑุด ุชุดูู ุงูู `logs` ุจุชุงุนุชูุ ูุชูุฏุฑุด ุชุนูู `filtering`ุ ููุชุฏุฑุด ุชุนูู `caching` ุจุงูุทุฑููุฉ ุงููู ุฃูุช ุนุงูุฒูุง.

**ุงูุญู ุจุงูู `Custom DNS Resolver`:**
ููุง ุฃูุช ุจุชูุฑุฑ ุชุจูู ุงูู `DNS resolver` ุจุชุงุนู ุจููุณู ุฌูู ุงูู `VPC`. ุจุชุนูู `EC2 instance` ูุจุชุณุทุจ ุนูููุง `software` ุฒู `unbound` ุฃู `bind` ุฃู ุญุชู `Pi-hole`. ุงูุณูุฑูุฑ ุฏู ุจูุนูู ุญุงุฌุชูู:

*   **`Caching` :** ููุง `instance A` ุจุชุณุฃู ุนู `api.github.com`ุ ุงูู `resolver` ุจุชุงุนู ุจูุทูุน ูุฌูุจ ุงูุฅุฌุงุจุฉ ููุฎุฒููุง ุนูุฏู (ูุนูููุง `cache`). ููุง `instance B` ุชูุฌู ุชุณุฃู ุนู ููุณ ุงูุงุณู ุจุนุฏูุง ุจุซูุงููุ ุงูู `resolver` ุจูุฑุฏ ุนูููุง ูู ุงูู `cache` ุจุชุงุนู ุนูู ุทูู ูู ุบูุฑ ูุง ูุทูุน ููุฅูุชุฑูุช ุชุงูู. **ุงููุชูุฌุฉ:** ุงุณุชุฌุงุจุฉ ุดุจู ููุฑูุฉ ููู `queries` ุงููุชูุฑุฑุฉุ ูุฃุฏุงุก ุฃุณุฑุน ููุชุทุจููุงุช ุงููู ุจุชุนุชูุฏ ุนูู `DNS`.
*   **`Filtering` & `Security` :** ุชูุฏุฑ ุชุนูู `configure` ููู `resolver` ุจุชุงุนู ุนุดุงู ูุนูู ุญุงุฌุงุช ูุชูุฑุ ุฒู:
    *   **ูุญุฌุจ ููุงูุน ูุนููุฉ:** ุชููุน ูู ุงูู `instances` ุฅููุง ุชูุตู ูู `domains` ูุนุฑูู ุฅููุง ุฎุจูุซุฉ (`malware domains`) .
    *   **ูุณุฌู ูู ุงูู `queries`:** ุจูุจูู ุนูุฏู `log` ูุงูู ุจูู `DNS query` ุญุตูุช ุฌูู ุงูู `VPC` ุจุชุงุนูุ ูุฏู ููุฒ ูู ุนูููุงุช ุงูู `troubleshooting` ูุงูุชุญูููุงุช ุงูุฃูููุฉ.

**ุฅุฒุงู `DHCP Option Set` ุจูุญูู ุฏูุ**
ุจุนุฏ ูุง ุจุชุจูู ุงูู `DNS resolver` ุจุชุงุนู ุฏู (ูุซูุงู ุนูู `IP` ุฏุงุฎูู ุฒู `10.0.1.10`)ุ ุจุชุฑูุญ ุชุนูู `custom DHCP option set` ูุชุญุท ุงูู `IP` ุฏู (`10.0.1.10`) ูู `DNS server`. ูุจูุฏูุ ูู ุงูู `instances` ูู ุงูู `VPC` ุจุชุชูุฌู ุฃูุชููุงุชูู ุฅููุง ุชุณุชุฎุฏู ุงูู `resolver` ุจุชุงุนู ุฏู ุจุฏู ุจุชุงุน `AWS`.

**4. ุชุญุฏูุฏ Domain Name ูุฎุตุต:**ุจุดูู ุงูุชุฑุงุถูุ ุฃู `instance` ุจุชุงุฎุฏ `private DNS hostname` ุจูููู ุขุฎุฑู `domain` ุนุงู ุฒู `.us-east-1.compute.internal`. ุงูุงุณู ุฏู ุทูููุ ูุด ุจูุนุจุฑ ุนู ุดุฑูุชูุ ูุตุนุจ ูุชุนูู ูู `integrate` ูุน ุฃูุธูุฉ ุงูุดุฑูุฉ ุงูุฏุงุฎููุฉ.

**ุงูุญู ุจุงูู `Custom Domain Name`:**
ููุง ุจุชุนูู `custom DHCP option set`ุ ุจุชูุฏุฑ ุชุญุฏุฏ `Domain Name` ุฎุงุต ุจูู ุฃูุชุ ุฒู ูุซูุงู `prod.my-company.net`.

**ุฅูู ุงููู ุจูุชุบูุฑ ุจุงูุธุจุทุ**
ููุง ุจุชุนูู ูุฏูุ ุงูู `hostname` ุจุชุงุน ุงูู `instances` ุจูุชุบูุฑ. ุจุฏู ูุง ูุจูู:
`ip-10-0-1-50.us-east-1.compute.internal`

ููุจูู:
`ip-10-0-1-50.prod.my-company.net`

**ุทุจ ุฅูู ุงููุงูุฏุฉ ุงูุนูููุฉ ูู ุงูุชุบููุฑ ุฏูุ**

1.  `Consistency` ูู ูู ุณูุฑูุฑุงุช ุดุฑูุชู ุงูุฏุงุฎููุฉ ุจุชูุชูู ุจู `.corp.my-company.com`ุ ุชูุฏุฑ ุชุฎูู ุณูุฑูุฑุงุช `AWS` ุชูุชูู ุจููุณ ุงูู `domain`. ุฏู ุจูุฎูู ุงูู `naming convention` (ุทุฑููุฉ ุงูุชุณููุฉ) ููุญุฏุฉ ูู ูู ููุงูุ ูุฏู ุจูุณูู ุงูุฅุฏุงุฑุฉ ูุงูู `automation` ุฌุฏูุง.
2.  **`Integration` ูุน ุงูู `Private DNS`:** ูู ุฃูุช ุจุชุณุชุฎุฏู ุฎุฏูุฉ ุฒู `Amazon Route 53 Private Hosted Zones` ุนุดุงู ุชุฏูุฑ ุงูู `DNS` ุงูุฏุงุฎูู ุจุชุงุนูุ ุชุญุฏูุฏ `custom domain name` ูู ุฎุทูุฉ ุฃุณุงุณูุฉ. ุจุชุนูู `private hosted zone` ุจููุณ ุงูุงุณู (`prod.my-company.net`)ุ ูุณุงุนุชูุง ุชูุฏุฑ ุชุนูู `DNS records` ุจุฃุณูุงุก ุณููุฉ ุฒู `database.prod.my-company.net` ูุชุดุงูุฑ ุจููุง ุนูู ุงูู `instance` ุจุชุงุนุชูุ ุจุฏู ูุง ุชุณุชุฎุฏู ุงูุงุณู ุงูุทููู ุงููู ููู `IP`.
3.  **ุณูููุฉ ุงูุฅุฏุงุฑุฉ ุจุงูู `Configuration Management Tools`:** ุฃุฏูุงุช ุฒู `Ansible` ุฃู `Puppet` ุฃู `Chef` ุจุชุจูู ุฃุณูู ูู ุฅุฏุงุฑุชูุง ููุง ูููู ุนูุฏู `domain` ุซุงุจุช ููุนุฑูู ุชูุฏุฑ ุชุชุนุงูู ูุนุงู ูุชุนูู `search` ููู `hosts` ุนูู ุฃุณุงุณู.



### **`VPC Flow Logs` **

![Information capture about IP traffic to and from network interfaces in VPC](https://symbols.getvecta.com/stencil_9/24_vpc-flowlogs.b977e67731.svg)

ุฏู ูุด `option` ุจุชุฎุชุงุฑู ููุช ุฅูุดุงุก ุงูู `VPC`ุ ููููุง ุฎุงุตูุฉ ุญูููุฉ **ุจุชูุนููุง** ุนูู ุงูู `VPC` ุจุชุงุนู ุจุนุฏ ูุง ูุชุนูู.

*   **ุจุชุนูู ุฅููุ** ุจุชุณุฌู ูุนูููุงุช ุนู **ูู `IP traffic` ุจูุนุฏู** ุนูู ุฃู `network interface` ุฌูู ุงูู `VPC` ุจุชุงุนู. ุงูุณุฌู ุฏู ุจูุจูู ููู ูุนูููุงุช ุฒู:
    *   ุงูู `IP` ุงููู ุจุนุช ุงูู `traffic` (Source IP).
    *   ุงูู `IP` ุงููู ุงุณุชูุจู ุงูู `traffic` (Destination IP).
    *   ุงูู `Ports` ุงููุณุชุฎุฏูุฉ.
    *   ุงูุจุฑูุชูููู (`TCP`, `UDP`, ุฅูุฎ).
    *   ูู ุงูู `traffic` ุฏู **`ACCEPTED`** (ุงุชุณูุญ ูู ูุนุฏู) ููุง **`REJECTED`** (ุงุชุฑูุถ) ุจูุงุณุทุฉ ุงูู `Security Group` ุฃู ุงูู `Network ACL`.

*   **ููู ุงูุฎุงุตูุฉ ุฏู ูููุฉ ุฌุฏูุงุ**
    *   **`Troubleshooting`:** ูู ููู `instance` ูุด ุนุงุฑูุฉ ุชูุตู ูู `instance` ุชุงููุฉุ ุฃูู ุญุงุฌุฉ ุจุชุจุต ุนูููุง ูู ุงูู `Flow Logs` ุนุดุงู ุชุดูู ูู ุงูู `traffic` ุจูุชุฑูุถ ูููู ุจุงูุธุจุท.
    *   **`Security Monitoring`:** ุจุชุณุงุนุฏู ุชูุชุดู ุฃู ูุญุงููุงุช ุงุชุตุงู ุบุฑูุจุฉ ุฃู ูุด ูุณููุญ ุจููุง ุนูู ุงูุดุจูุฉ ุจุชุงุนุชูุ ูุจุชููู ุฏููู ููู ุฌุฏูุง ูู ุฃู ุชุญููู ุฃููู.

ุจุชูุฏุฑ ุชุจุนุช ุงูู `logs` ุฏู ูู `Amazon S3` ุฃู `CloudWatch Logs` ุนุดุงู ุชุญูููุง ูุชุนูู ุนูููุง `dashboards` ู `alerts`.



> [!TIP]
>
> ุงุฎุชูุงุฑ ุงูู CIDR Block - ุฃูุจุฑ ุบูุทุฉ ุจููุน ูููุง ุงููุจุชุฏุฆูู
>
> ุงููุต ุจููููู "ููุฑ ูููุณ" ูุจู ูุง ุชุฎุชุงุฑุ ุจุณ ูุด ุจููููู ุฅุฒุงู.
>
> - **ุงูุบูุทุฉ:** ูุนุธู ุงููุงุณ ุจุชุฎุชุงุฑ ุฃูู ุญุงุฌุฉ ุจุชูุฌู ูู ุจุงููุง: 10.0.0.0/16 ุฃู 192.168.0.0/16.
> - **ุงููุงุฑุซุฉ ุจุชุญุตู ุงูุชูุ** ููุง ุชูุฌู ุชูุตู ุงูู VPC ุจุชุงุนู ุฏู ุจุงูุดุจูุฉ ุงูุฏุงุฎููุฉ ุจุชุงุนุช ุดุฑูุชู (On-premises) ุฃู ุจุดุฑูุฉ ุชุงููุฉ ุนู ุทุฑูู (VPC Peering ุฃู VPN). ุบุงูุจูุง ูุชูุงูู ุฅู ุดุจูุชูู **ูู ููุงู** ุจุชุณุชุฎุฏู ููุณ ุงูู IP range ุฏู. ูุงููุชูุฌุฉ ูู **IP Conflict** (ุชุถุงุฑุจ ูู ุงูุนูุงููู)ุ ูุฏู ูุดููุฉ ุถุฎูุฉ ูุตุนุจุฉ ุงูุญู ุฌุฏูุง.
> - **ุญู ุฌุฒุกู:**
>   - **ุงุจุนุฏ ุนู ุงููุดููุฑ:** ุจูุงุด ุชุณุชุฎุฏู 10.0.0.0/16 ุจุงูุธุจุท. ุงุฎุชุงุฑ ุญุชุฉ "ุบุฑูุจุฉ" ูู ุงูู range ุงููุจูุฑ ุจุชุงุน 10.0.0.0/8. ูุซูุงูุ ุงุณุชุฎุฏู 10.42.0.0/16 ุฃู 10.99.0.0/16. ุฏู ุจูููู ุงุญุชูุงููุฉ ุงูุชุถุงุฑุจ ูู ุงููุณุชูุจู ุจูุณุจุฉ 90%.
>   - **ุงุณุชุฎุฏู ุงูู 172.16.0.0/12:** ุฏู range ูุจูุฑ ูุงููุงุณ ุจุชูุณุงู ูุชูุฑุ ูุบุงูุจูุง ุจูููู ุงุฎุชูุงุฑ ุขูู.

> [!IMPORTANT]
>
> * **ุงููุดููุฉ: IP Address Overlap ูู ุงูุจูุฆุงุช ุงููุจูุฑุฉ**
>
>    ููุง ุจูููู ุนูุฏู VPC ุฃู ุงุชูููุ ุณูู ุฃูู ุชุฎุชุงุฑ ุงูู CIDR blocks ุจููุณูุ ุชููู ุฏู ููุงุฎุฏ 10.0.0.0/16 ูุงูุชุงูู 10.1.0.0/16 ูุงูุฏููุง ุจุชูุดู.
>
>   ุงููุดููุฉ ุงููุจูุฑุฉ ุจุชุจุฏุฃ ููุง ุงูุดุฑูุฉ ุจุชูุจุฑ ูุจูุญุตู ุงูุขุชู:
>
>   - ุจูุจูู ุนูุฏู ุนุดุฑุงุช ุฃู ูุฆุงุช ุงูู AWS accounts ุฌูู AWS Organization ูุงุญุฏุฉ.
>   - ูู ูุฑูู (Dev, Staging, Prod) ุจูุนูู VPCs ูููุณู.
>   - ูุจุชุญุชุงุฌ ุชุฑุจุท ุงูู VPCs ุฏู ุจุจุนุถูุง ุจู VPC Peering ุฃู Transit Gateway.
>   - ูุชุฑุจุทูู ูููู ุจุดุจูุฉ ุงูุดุฑูุฉ ุงููู ุนูู ุงูุฃุฑุถ (on-premises) ุนู ุทุฑูู VPN ุฃู Direct Connect.
>
>   ููุง ุจููุ ุจุชุญุตู ุงููุงุฑุซุฉ ุจุชุงุนุฉ ุงูู **IP address overlap**. ุฏู ููุง ูุฑูููู ุจุงูุตุฏูุฉ ูุฎุชุงุฑูุง ููุณ ุงูู CIDR block (ูุซูุงู ุงูุงุชููู ูุงุฎุฏูุง 10.0.0.0/16).
>
>   **ุงููุชูุฌุฉ:** ุงูู Routing ุจูุจูุธ ุชูุงููุง. ููุง ุณูุฑูุฑ ูุญุงูู ูููู IP ุฒู 10.0.1.50ุ ุงูู router ูุด ุจูุจูู ุนุงุฑู ููุฏูู ููู VPC ุงูุฃููุงูู ููุง ููุชุงููุ ูุงูุงุชุตุงู ุจููุดู.
>
>   ------
>
>   
>
>   **ุงูุญู: Amazon VPC IP Address Manager (IPAM)**
>
>   ุงูู IPAM ูู ุงูุฎุฏูุฉ ุงููู AWS ุนููุชูุง ูุฎุตูุต ุนุดุงู ุชุญู ุงูุญูุงุฑ ุฏู. ูู ุจุชุฎููู ุชุฏูุฑ ูู ุงูู IP address ranges ุจุชุงุนุชู ูู ููุงู ูุงุญุฏ ูุฑูุฒู.
>
>   **ุจุชุดุชุบู ุฅุฒุงู (ููููุงุชูุง ุงูุฃุณุงุณูุฉ):**
>
>   1. 
>   2. **IPAM:**
>      ุฏู ุงูู resource ุงูุฑุฆูุณู ุงููู ุจุชุนููู ูุฑุฉ ูุงุญุฏุฉ ุนูู ูุณุชูู ุงูู AWS Organization ูููุง.
>   3. **Scope:**
>      ุฌูู ุงูู IPAMุ ุจุชุนูู scopes. ุงูู scope ุฏู ุฒู ูุง ุชููู "ุฏุฑุฌ" ุจุชูุตู ููู ุฃููุงุน ุงูู IPs:
>      - **Private Scope**: ุนุดุงู ุชุฏูุฑ ุจูู ุงูู private IP ranges (RFC 1918).
>      - **Public Scope**: ุนุดุงู ุชุฏูุฑ ุจูู ุงูู public IP ranges ุงููู ุฃูุช ุดุงุฑููุง (ูู ุจุชุณุชุฎุฏู BYOIP).
>   4. **Pool (ุฏู ูู ุงูู IP pool ุงููู ุฃูุช ุจุชุณุฃู ุนูู):**
>      ุฌูู ุงูู scopeุ ุจุชุนูู pools. ุงูู pool ุฏู ูู ูุฌููุนุฉ ุงูู CIDR blocks ุงููู ุฃูุช ุจุชุนุฑููุง.
>      - **Top-level pool**: ุจุชุนูู pool ูุจูุฑ ุจุชุญุท ููู ุงูู supernet ุจุชุงุน ุดุฑูุชู ููู (ูุซูุงู 10.0.0.0/8).
>      - **Regional pools**: ุจุนุฏ ูุฏูุ ุจุชูุณู ุงูู pool ุงููุจูุฑ ุฏู ูู pools ุฃุตุบุฑ ููู AWS region ุจุชุดุชุบู ูููุง (ูุซูุงู 10.0.0.0/12 ูู eu-west-1ุ ู 10.16.0.0/12 ูู us-east-1).
>   5. **Allocation (ุงูุชุฎุตูุต):**
>      ุฏูููุชูุ ููุง ุฃู developer ุฃู script Terraform ูุฌู ูุนูู VPC ุฌุฏูุฏุ ูู **ูุด ุจูุฎุชุฑุน CIDR block ูู ุฏูุงุบู**. ูู ุจูุฑูุญ ููู IPAM ูููููู: "ูู ุณูุญุชุ ุฃูุง ุนุงูุฒ VPC ุฌุฏูุฏ ุญุฌูู /16 ูู region eu-west-1".
>      ุงูู IPAM ุจูุจุต ูู ุงูู pool ุจุชุงุนูุ ุจูุดูู ุฅูู ุงูู ranges ุงููู ูุณู ูุงุถูุฉุ ูุจูุฏููู CIDR block ุฌุฏูุฏ ููุถููู ุฅูู ูุด overlapping ูุน ุฃู ุญุงุฌุฉ ุชุงููุฉ.
>
>   **ูููุฒุงุช ุงูู IPAM:**
>
>   - 
>   - **ููุน ุงูู Overlap ุชูุงููุง:** ุจูุญู ุงููุดููุฉ ูู ุฌุฐูุฑูุง.
>   - ** Automation:** ุจูุชูุงูู ูุน Terraform ุนุดุงู ุนูููุฉ ุชุฎุตูุต ุงูู IPs ุชุจูู ุฃูุชููุงุชูู.
>   - **Monitoring & Auditing:** ุจูุฏููู dashboard ุชุดูู ูููุง ูู ุงูู IP ranges ุงููุณุชุฎุฏูุฉุ ูููู ุงููู ุจูุณุชุฎุฏููุงุ ููุณุจุฉ ุงูุงุณุชููุงูุ ุนุดุงู ุชุฎุทุท ูููุณุชูุจู.



> [!TIP]
>
> ูุฎ ุงูู Secondary CIDR Blocks
>
> **ุงููุฎ:** ูู ุงุฎุชุฑุช ุงูู Primary CIDR ุจุชุงุนู ูููู ูู ุนููุฉ 192.168.0.0/16ุ ูุด ูุชูุฏุฑ ุชุถูู ุฃู Secondary CIDR ูู ุงูุนุงุฆูุงุช ุงูุชุงููุฉ ุจุชุงุนุช RFC 1918 (ูุง ูู 10.0.0.0/8 ููุง ูู 172.16.0.0/12). **ุฅูุช ูุฏู ุญุจุณุช ููุณู ูู ุงูู range ุฏู ููุฃุจุฏ.**
>
> **ูุงุนุฏุฉ : ูุง ุชุณุชุฎุฏู 192.168.0.0/16 ุฃุจุฏูุง ูู ุฃู VPC ุญูููู ุฃู production.** ุงูู range ุฏู ูุนููู ููุดุจูุงุช ุงูููุฒููุฉ ุงูุตุบูุฑุฉ ูุงููุงุจุงุช ุงููุคูุชุฉุ ูุด ููุจููุฉ ุงูุชุญุชูุฉ ุงููู ุงูููุฑูุถ ุชูุจุฑ ูุชุชูุณุน. ุงุณุชุฎุฏุงูู ุจูููู ุนููู ุฃุจูุงุจ ูุชูุฑ ูู ุงููุณุชูุจู.





## **`Subnets`**

![AWS Cloud Resource | Subnet](https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSQ4_Ua3vdsUyyaIDA_2nQm1F6mtmRg6k56jA&s)

ุงูู `subnet` ุฏู ุนุงูู ุฒู  "ูุณู" ุฌูู ุงูู `VPC` ุจุชุงุนูุ ูุฏู ุงููู ุจุชุญุท ุฌูุงู ุงูู `VPC resources` ุจุชุงุนุชูุ ุฒู ุงูู `EC2 instances`. ุงูู `subnet` ุจูุฎููู ุชุนุฒู ุงูู `instances` ุนู ุจุนุถุ ูุชุชุญูู ูู ุงูู `traffic` ุงููู ุฑุงูุญ ูุฌุงู ููู `instances` ุจุชุงุนุชูุ ูููุงู ุชูุธููู ุนูู ุญุณุจ ูุธููุชูู. ุนูู ุณุจูู ุงููุซุงูุ ูููู ุชุนูู `subnet` ููู `public web servers` ุงููู ูุญุชุงุฌุฉ ุชููู ูุชุงุญุฉ ูู ุงูุฅูุชุฑูุชุ ูุชุนูู `subnet` ุชุงูู ููู `database servers` ุงููู ุงูู `web instances` ุจุณ ูู ุงููู ุจุชูุฏุฑ ุชูุตููุง. ูู ูุงุญูุฉ ุงููุจุฏุฃุ ุงูู `subnets` ุฏู ุดุจู ุงูู `virtual LANs (VLANs)` ูู ุงูุดุจูุงุช ุงูุชูููุฏูุฉ.

ุฃู `instance` ูุงุฒู ุชููู ููุฌูุฏุฉ ุฌูู `subnet`. ูุนุดุงู ูุฏู ุฏุงููุงู ูุชุณูุน ุฌููุฉ "ุงุนูู `launch` ูู `instance` ุฌูู `subnet`". ุจูุฌุฑุฏ ูุง ุชุนูู `instance` ุฌูู `subnet`ุ ุฃูุช **ูุชูุฏุฑุด ุชููู ุงูู `instance` ุฏู**. ูุฏู ุจุงูุชุจุนูุฉ ูุนูุงู ุฅูู ูุชูุฏุฑุด ุชููู `instance` ูู `VPC` ูู `VPC` ุชุงูู ุฃู ูู `availability zone` ููุชุงููุฉ. ูููุ ุงูุญู ุฅูู ุชุนูููุง `terminate` (ุชูุณุญูุง) ูุชุนูู `instance` ุชุงููุฉ ูู ุงูู `subnet` ุงููู ุฃูุช ุนุงูุฒู. ูุนุดุงู ุชุญุงูุธ ุนูู ุงูุฏุงุชุง ุงููู ุนูู ุงูู `EBS volume` ุจุชุงุน ุงูู `instance` ุฏูุ ูููู ุชุงุฎุฏ `snapshot` ูู ุงูู `volume`ุ ูุชุนูู ููู `AMI`ุ ูุจุนุฏูู ุชุณุชุฎุฏู ุงูู `AMI` ุฏู ุนุดุงู ุชุนูู `instance` ุฌุฏูุฏุฉ ูู ุงูู `subnet` ุงูุชุงูู.

### **`Subnet CIDR Blocks`**

ูู ุงูู `VPC CIDR block` ุงููุจูุฑุ ุฃูุช ุจุชูุทุน `CIDR block` ุฃุตุบุฑ ููู `subnet`. ูุซูุงูุ ูู ุงูู `VPC` ุจุชุงุนู ุงูู `CIDR` ุจุชุงุนู ูู `172.16.0.0/16`ุ ูููู ูุงุญุฏ ูู ุงูู `subnets` ุจุชุงุนุชู ูููู ุงูู `CIDR` ุจุชุงุนู `172.16.100.0/24`. ุงูู `range` ุฏู ุจูุดูู ูู ุงูู `IP addresses` ูู `172.16.100.0` ูู `172.16.100.255`ุ ูุฏู ุจูุฏููู 256 `address` ูู ุงูุฅุฌูุงูู.

`AWS` ุจุชุญุฌุฒ ุฃูู ุฃุฑุจุน `IP addresses` ูุขุฎุฑ `IP address` ูู ูู `subnet`. ูููููุนุด ุชุฏู ุงูู `addresses` ุฏู ูุฃู `instance`. ูู ุงูุชุฑุถูุง ุฅู ุงูู `subnet CIDR` ูู `172.16.100.0/24`ุ ูุจูู ุงูู `addresses` ุงููุญุฌูุฒุฉ ูู:

*   `172.16.100.0` ุฏุง subent id
*   `172.16.100.1` โ ุฏู ุจุชุงุน ุงูู `router` 
*   `172.16.100.2` โ ุฏู ุจุชุงุน ุงูู `Amazon-provided DNS server`
*   `172.16.100.3` โ ุฏู ูุญุฌูุฒ ููุงุณุชุฎุฏุงู ุงููุณุชูุจูู
*   `172.16.100.255` ุฏุง broadcast

ุงููููุฏ ุงููู ุนูู ุงูู `prefix lengths` ุจุชุงุนุฉ ุงูู `subnet CIDR` ูู ูู ููุณ ุงููููุฏ ุจุชุงุนุฉ ุงูู `VPC CIDRs`. ุงูู `Subnet CIDR blocks` ุงููู ูู ููุณ ุงูู `VPC` ููููุนุด ุชููู `overlap` (ูุชุฏุงุฎูุฉ) ูุน ุจุนุถ. ูููุงูุ ุจูุฌุฑุฏ ูุง ุชุฏู `IP prefix` ูู `subnet`ุ ูุชูุฏุฑุด ุชุบูุฑู ุชุงูู.

ูููู ุงูู `subnet` ูุงูู `VPC` ูุงุฎุฏูุง ููุณ ุงูู `CIDR`. ูุซูุงูุ ูููู ุชุฏู `CIDR` ูููุชู `192.168.0.0/16` ููู `VPC` ูููู `subnet` ุงููู ุฌูุงู ูู ููุณ ุงูููุช. ุจุณ ุฏู **ุญุงุฌุฉ ูุด ุดุงูุนุฉ ุฎุงูุต** ููุด ูุชุณูุจูู ุฃู ูุณุงุญุฉ ุนุดุงู ุชุนูู `subnets` ุฒูุงุฏุฉุ ูุฏู ูุนูุงู ุฅู ุงูู `VPC` ุจุชุงุนู ููุจูู ูุญุฏูุฏ ูุนูููุง ุจู `availability zone` ูุงุญุฏุฉ. (ููุดุฑุญ ุงูู `availability zones` ูู ุงูุฌุฒุก ุงูุฌุงู). ุงูุทุจูุนู ูุงูุฃูุชุฑ ุดููุนูุง ุฅู ุงูู `prefix length` ุจุชุงุน ูู `subnet` ูููู ุฃุทูู (ุงูุฑูู ุฃูุจุฑ) ูู ุงูู `VPC CIDR block` ุนุดุงู ุชุณูุญ ุจูุฌูุฏ ูุฐุง `subnet` ูู ููุณ ุงูู `VPC`. ูุซูุงูุ ูู ุงุฏูุช `CIDR` ูููุชู `192.168.0.0/16` ููู `VPC`ุ ูููู ุชุฏู `CIDR` ูููุชู `192.168.3.0/24` ูู `subnet` ุฌูู ุงูู `VPC` ุฏูุ ูุฏู ููุณูุจูู ูุณุงุญุฉ ุชุนูู `subnets` ุฒูุงุฏุฉ.

ุงูู `subnet` **ููููุนุด ูููู ููู ูุฐุง `CIDR`**. ุนูู ุนูุณ ุงูู `VPC` ุงููู ูููู ูููู ููู `secondary CIDRs`ุ ุงูู `subnet` ููู ูุงุญุฏ ุจุณ. ูููุ ูู ุงูู `VPC` ุจุชุงุนู ููู `primary CIDR` ู `secondary CIDR`ุ ุงูู `CIDR` ุจุชุงุน ุงูู `subnet` ุจุชุงุนู ูููู ูุชุงุฎุฏ ูู ุฃู ูุงุญุฏ ูููู. ูุซูุงูุ ูู ุงูู `VPC` ุจุชุงุนู ุงูู `primary CIDR` ุจุชุงุนู ูู `172.16.0.0/16` ูุงูู `secondary` ูู `172.17.0.0/16`ุ ูููู ุชุนูู `subnet` ุฌูู ุงูู `VPC` ุฏู ููููู ุงูู `CIDR` ุจุชุงุนู `172.17.12.0/24`ุ ูุฅูู ูุชุงุฎุฏ ูู ุงูู `secondary VPC CIDR`.

---



### **`Availability Zones`**

ุงูู `subnet` ุงููุงุญุฏ ููุฏุฑ ูููู ููุฌูุฏ ุฌูู **`availability zone` (ุฃู `AZ`)** ูุงุญุฏุฉ ุจุณุ ูุงูู `AZ` ุฏู ุชูุฑูุจูุง ุนุงููุฉ ุฒู ูููุน ุฌุบุฑุงูู ุตุบูุฑ ูุณุจููุง ุฒู ุงูู `datacenter`. ุนูู ุงูุฑุบู ูู ุฅู ุงูู `availability zones` ุงููู ูู ููุณ ุงูู `AWS region` ูุชุตูุฉ ุจุจุนุถุ ุฅูุง ุฅููุง ูุตููุฉ ุจุญูุซ ุฅู ุฃู ูุดู ุฃู ุนุทู ุจูุญุตู ูู `zone` ูุงุญุฏุฉุ ููุณุจุจุด ุนุทู ูู `zone` ุชุงููุฉ.

ุฃูุช ุจุชูุฏุฑ ุชุญูู `resiliency` ููุชุทุจููุงุช ุจุชุงุนุชู ุนู ุทุฑูู ุฅูู ุชุนูู ุงุชููู `subnets`ุ ูู ูุงุญุฏ ูููู ูู `availability zone` ูุฎุชููุฉุ ูุจุนุฏ ูุฏู ุชูุฒุน ุงูู `instances` ุจุชุงุนุชู ุนูู ุงูู `zones` ุฏู. ุฌุฏูู 4.1 ุจูุฏู ูุซุงู ูุงุชููู `subnets` ูู ุงุชููู `availability zones` ูุฎุชูููู.

**ุฌุฏูู 4.1: `Subnets` ูู `availability zones` ูุฎุชููุฉ**

| `Subnet`      | `Availability zone` | `Instance` |
| :------------ | :------------------ | :--------- |
| `web-subnet1` | `us-east-1a`        | `web1`     |
| `web-subnet2` | `us-east-1b`        | `web2`     |

ูู ุงููุซุงู ุฏูุ ูู ุงูู `us-east-1a` `zone` ููุนุชุ ุงูู `instance` ุงููู ุงุณููุง `web1` ูุชูุน ูุฃููุง ููุฌูุฏุฉ ูู ุงูู `zone` ุฏู. ููู `web2`ุ ุงููู ููุฌูุฏุฉ ูู ุงูู `us-east-1b` `zone`ุ ูุชูุถู ุดุบุงูุฉ ููุชุงุญุฉ.

ุฅูู ุชุญุท ุงูู `subnets` ูู `availability zones` ูุฎุชููุฉ ุฏู ูุด ุดุฑุท ุฅุฌุจุงุฑู. ุฃูุช ูููู ุชุญุท ูู ุงูู `subnets` ุจุชุงุนุชู ูู ููุณ ุงูู `zone`ุ ุจุณ ุฎูู ูู ุจุงูู ุฅูู ูู ุงูู `zone` ุฏู ููุนุชุ ูู ุงูู `instances` ุงููู ูู ุงูู `subnets` ุฏู ูุชูุน ูู ููุงู. ุจุต ุนูู ุดูู 4.1 ุนุดุงู ุชุดูู ูุซุงู ูุงุชููู `instances` ูู ุงุชููู `availability zones` ูุฎุชูููู.

![image-20250808035128872](assets/image-20250808035128872.png)

---

### **`IPv6 CIDR Blocks`**

ูู ููุช ุฎุตุตุช `IPv6 CIDR` ููู `VPC` ุจุชุงุนูุ ุจุชูุฏุฑ ุชุฏู `IPv6 CIDRs` ููู `subnets` ุงููู ุฌูู ุงูู `VPC` ุฏู. ุงูู `prefix length` ุจุชุงุน ุฃู `subnet` ุจูุณุชุฎุฏู `IPv6` ุจูููู ุซุงุจุช ุนูู **`/64`**. ููู ุงูู `IPv6 CIDR` ุจุชุงุน ุงูู `VPC` ุจุชุงุนู ูู `2600:1f18:2551:8900/56`ุ ุฃูุช ูููู ุชุฏู `subnet` ุฃู `CIDR` ูู ุฃูู `2600:1f18:2551:8900/64` ูุบุงูุฉ `2600:1f18:2551:89FF/64`.

ุฃูุช ูุงุฒู **ุฏุงููุงู** ุชุฏู `IPv4 CIDR block` ูุฃู `subnet`ุ ุญุชู ูู ููุช ูุงูู ุชุณุชุฎุฏู `IPv6` ุจุณ.

**ุทุจ ุฅุฒุงู ุงูุชูุฒูุน ุจูุชูุ**

`AWS` ุจุชุฏููู `VPC CIDR` ุญุฌูู `/56`. ุฏู `range` ุถุฎู ุฌุฏูุง ุชูุฏุฑ ุชูุณูู ูู 256 `range` ุฃุตุบุฑุ ูู ูุงุญุฏ ูููู ุญุฌูู `/64`. ูุธุฑููุงุ ุฃูุช ุงููู ุจุชุฎุชุงุฑ ูุจุชุฎุตุต (`assign`) ูุงุญุฏ ูู ุงูู 256 `range` ุฏูู ููู `subnet`.

*   **ูุซุงู:** ูู ุงูู `VPC CIDR` ุจุชุงุนู ูู `2600:1f18:2551:8900/56`ุ ุฏู ูุนูุงู ุฅู ุงููุณุงุญุฉ ุงููุชุงุญุฉ ููู ููู `subnets` ุจุชุจุฏุฃ ูู:
    *   `2600:1f18:2551:8900/64`
    *   `2600:1f18:2551:8901/64`
    *   ... ูููุฐุง ูุบุงูุฉ ...
    *   `2600:1f18:2551:89FF/64`

ุนููููุงุ ููุง ุจุชุนูู `subnet` ูู ุงูู `AWS Console`ุ `AWS` ุจุชุจุณุท ุนููู ุงูููุถูุน. ุจุฏู ูุง ุชูุชุจ ุงูู `CIDR` ุงูุทููู ุฏู ูููุ ูู ุจุชุทูุจ ููู ุชุฏุฎู ุงูุฌุฒุก ุงูุฃุฎูุฑ ุจุณ (ูู `00` ูู `ff`)ุ ููู ุจุชุจูู ุงูู `CIDR` ุงููุงูู ุฃูุชููุงุชูู ุจูุงุกู ุนูู ุงุฎุชูุงุฑู. ููู ูู ุจุชุณุชุฎุฏู `Infrastructure as Code` ุฒู `Terraform`ุ ุฃูุช ุงููู ุจุชูุชุจ ุงูู `CIDR` ูุงูู ุจููุณู.

```terraform

resource "aws_subnet" "my_ipv6_subnet" {
  vpc_id            = aws_vpc.main.id
  cidr_block        = "10.0.1.0/24"

  ipv6_cidr_block   = "2600:1f18:2551:8905::/64" 
}
```

> **ููุญูุธุฉ ูุงูุฉ:**
> `AWS` ุจุชูุฑุถ ุนููู ุฅูู **ูุงุฒู ุชุฏู `IPv4 CIDR block` ูุฃู `subnet`**ุ ุญุชู ูู ูุงูุช ูู ุฎุทุทู ูู ุฅูู ุชุณุชุฎุฏู `IPv6` ุจุณ. ุงูู `IPv4` ูุนุชุจุฑ ูุชุทูุจ ุฃุณุงุณู ูู ุชุตููู ุงูู `subnet` ุญุงูููุง.

### **ุฏู ุญุชุฉ ูููุฉ ูุดุฎ: ุจูู `IPv4` ู `IPv6` ููู ุงุฎุชูุงู ุฌุฐุฑู ูู ุฃุณููุจ ุชุนุงูู `AWS` ูุน ุงูุงุชููู**

ููุง ุจุชุชุนุงูู ูุน `IPs` ุฌูู `AWS`ุ ูุงุฒู ุชุจูู ุนุงุฑู ุฅู `IPv4` ู `IPv6` ูุด ูุฌุฑุฏ ูุณุฎุชูู ูู ููุณ ุงูุญุงุฌุฉ. ุฏูู ุนุงูููู ูุฎุชูููู ุชูุงููุงุ ู`AWS` ุจุชุชุนุงูู ูุน ูู ูุงุญุฏ ูููู ุจููุณูุฉ ูุชุตููู ูุฎุชูู ุฌุฐุฑููุง. ุงููุฑู ุฏู ูุด ูุฌุฑุฏ ุชูุตููุฉ ูููุฉุ ุฏู ุจูุฃุซุฑ ุนูู ูู ุญุงุฌุฉ ูู ุชุตููู ุดุจูุชู ูู ุฃูู ุชุฎุตูุต ุงูู `IPs` ูุญุฏ ุงูุฃูุงู.

---

#### **1. `IPv4`: ุนุงูู ูุจูู ุนูู ุงููุฏุฑุฉ ูุงูุนุฒู ูุงูู `NAT`**

`AWS` ุจูุช ุงูู `VPC` ูู ููุช ูุงู ุงูุนุงูู ููู ุนุงุฑู ุฅู `IPv4` ุจูุฎูุต. ุนุดุงู ูุฏูุ ูู ุชุตููููุง ุจูุชุนุงูู ูุนุงู ุนูู ุฅูู **"ุฏูุจ"**ุ ุญุงุฌุฉ ุบุงููุฉ ููุงุฒู ูุญุงูุธ ุนูููุง ููุนุฒููุง.

*   **ุชุฎุตูุต ุงูู `IP` (ูุด ุฅูุฌุงุฑุ ุฏู ุชุฎุตูุต ุซุงุจุช):**
    ุฃูุช ูุด ุจุชุชุนุงูู ูุน `DHCP` ุจุงููุนูู ุงูุชูููุฏู. ููุง ุจุชุนูู `EC2 instance`ุ "ุงููุฎ" ุจุชุงุน `AWS` (`AWS Control Plane`) ุจูุจุต ุนูู ุงูู `subnet` ุจุชุงุนูุ ููุฎุชุงุฑ `private IP` ูุงุถูุ ููุฑูุญ ููุฒูู ูู ุงูู `ENI` (ูุงุฑุช ุงูุดุจูุฉ) ุจุชุงุน ุงูู `instance` ุจุชุงุนุชู. ุงูู `IP` ุฏู ุจูุจูู ุจุชุงุน ุงูู `ENI` ุฏู **ูุญุฏ ูุง ูุชูุณุญ**. ูุด ุจูุชุบูุฑ ูู ุนููุช `Stop` ู `Start`. ุงูุซุจุงุช ุฏู ูู ุงููู ุจูุฎูู ูู ุญุงุฌุฉ ุฌูู ุงูู `VPC` ูุณุชูุฑุฉุ ูุฃู ุงูู `Private IP` ุฏู ูู ุงูุฑูู ุงููููู ุจุชุงุน ุงูู `instance` ุฌูู ุงูุดุจูุฉ.

*   ุชูุฏุฑ ุชูุณุญ Ec2 ูุชุญุงูุธ ุนูู ENI ุนููู ip ูุจูุฏู ุงูุช ุญุฌุฒู

*   **ููุณูุฉ ุงููุงุณุทุฉ (`NAT` ูู ุงูููู):**
    ุจูุง ุฅู ุงูู `Private IPs` ุฏู ุนูุงููู ุฏุงุฎููุฉ ููููุนุด ุชุทูุน ุนูู ุงูุฅูุชุฑูุชุ `AWS` ุจูุช ููุธููุฉ ูุงููุฉ ูู `NAT) ุนุดุงู ูุญููุง ุงููุดููุฉ.
    *   **`Internet Gateway (IGW)`:** ุฏู ุจูุดุชุบู nat `1-to-1`. ูู ุจูุจูู ูุนุงู ุฏูุชุฑ ุจูููู "ุงูู `Private IP` `10.0.1.50` ุฏู ููุง ูุญุจ ูุทูุน ูุชุ ููุทูุน ุจุงูู `Public IP` `54.1.2.3`".
    *   **`NAT Gateway`:** ุฏู nat ุชุงูู ุจุณ ุจูุดุชุบู `Many-to-1`. ูู ุจูุงุฎุฏ ุงูู `traffic` ูู ูุฆุงุช ุงูุณูุฑูุฑุงุช ุงูู `private`ุ ูุจูุทูุนูู ูููู ุจุงูู `Public IP` ุจุชุงุนู ูู.
        ูุงูุนุงูู ุงูุฏุงุฎูู (`Private`) ูุงูุดุงุฑุน (ุงูู `Public`) ูููุตููู ุชูุงููุงุ ูุงูู `NAT` ูู ุงููุงุณุทุฉ ุงูุฅุฌุจุงุฑูุฉ ุงููู ุจูููู.

*   **ุงูุฃูุงู (ููููู ูู ุงูุฃุตู):**
     ุฃู `instance` ุจุชุชููุฏ ุฌูุงู ุจุชููู `private` ููุนุฒููุฉ ุนู ุงูุดุงุฑุน ุจุดูู ุงูุชุฑุงุถู. ุฃูุช ุงููู ูุงุฒู ุชุงุฎุฏ ูุฑุงุฑ ุตุฑูุญ ูุฎุทูุงุช ูุงุถุญุฉ (ุฒู ุฅูู ุชุญุทูุง ูู `public subnet` ูุชุฏููุง `public IP`) ุนุดุงู ุชูุชุญ ููุง ุจุงุจ ุนูู ุงูุดุงุฑุน.

---

#### **2. `IPv6`: ุนุงูู ูุจูู ุนูู ุงูููุฑุฉ ูุงูุงุชุตุงู ุงููุจุงุดุฑ ูุงูุฃูุงู ุงูุตุฑูุญ**

`IPv6` ุฌู ุจููุณูุฉ ูุฎุชููุฉ ุชูุงููุง: ุงูู `IPs` ูุจูุชุด ูุงุฏุฑุฉุ ุจุงูุนูุณุ ุฏู ุจูุช ุฒู **"ุงูููุง"**. `AWS` ููุง ูุด ุจุชุญุงูู ุชุญุงูุธ ุนูู ุงูู `IPs`ุ ูู ุจุชุญุงูู ุชุชุจุน ุงูู `standards` ุงูุนุงูููุฉ ุจุชุงุนุฉ `IPv6`.

*   **ุชุฎุตูุต ุงูู `IP` (ููุง ุจูู ููู ุฅูุฌุงุฑ):**
    ููุง ุงูููุถูุน ุฃูุฑุจ ููู `DHCP` ุงูุนุงุฏู. `AWS` ุจุชุฏููู `range` ูุจูุฑ ุฌุฏูุง (`/56`)ุ ูุงูู `instances` ุจุชุงุฎุฏ `IPs` ููู ุจุดูู ุฏููุงูููู. ุนุดุงู ูุฏู ููู ููููู **"ุงูุฅูุฌุงุฑ" (`Lease`)**. ูุฏู ุงูุณุจุจ ุฅูู ุจุชูุงูู `option` ูู `DHCP Option Set` ุงุณูู `IPv6 preferred lease time` ุนุดุงู ุชุชุญูู ูู ูุฏุฉ ุงูุฅูุฌุงุฑ. ุงูุฎุงุตูุฉ ุฏู ูุด ููุฌูุฏุฉ ูู `IPv4` ูุฃู ุทุฑููุฉ ุงูุดุบู ูุฎุชููุฉ.

*   **ููุณูุฉ ุงูุงุชุตุงู ุงููุจุงุดุฑ (ุงูุณู ุงูู `NAT`!):**
    **ูุฏู ุฃูุจุฑ ูุฑู ุนูู ุงูุฅุทูุงู.** ูู `IPv6 address` `AWS` ุจุชุฏููููู ูู **ุนููุงู ุนุงููู ูุฑูุฏ ูููุน ุชูุตูู ูู ุฃู ุญุชุฉ ูู ุงูุนุงูู (`globally routable`)**.
    *   **ูููุด `NAT`:** ุงูู `NAT` ุงุชุนูู ุฃุตููุง ุนุดุงู ููุต `IPv4`. ูู `IPv6`ุ ุฅุญูุง ูุด ูุญุชุงุฌููู. ูู `instance` ูููุง ุนููุงููุง ุงูุนุงููู ุงููุจุงุดุฑ.
    *   **ุฏูุฑ ุงูู `Internet Gateway` ุจูุชุบูุฑ:** ุจุงููุณุจุฉ ููู `IPv6`ุ ุงูู `IGW` ูุด ุจูุนูู nat. ูู ูุฌุฑุฏ "ุจูุงุจุฉ" ุจุชุณูุญ ููู `traffic` ุฅูู ูุนุฏู ูุฎูุงุต.
    *   **`Egress-Only Internet Gateway`:** ุฏู ูู ุจุฏูู ุงูู `NAT Gateway`. ูู ุนูุฏู `instance` ุนุงูุฒูุง ุชุทูุน ูุช (ุนุดุงู ุชุนูู `updates`) ุจุณ ูุด ุนุงูุฒ ุงููุช ูููููุงุ ุจุชุฎูููุง ุชุทูุน ูู ุงูุจูุงุจุฉ ุฏู. ุฏู "ุจูุงุจุฉ ุฎุฑูุฌ ุจุณ"ุ ุจุชุณูุญ ููู `traffic` ูุทูุนุ ููู ุจุชููุน ุฃู ุญุฏ ูู ุจุฑู ูุจุฏุฃ ุงุชุตุงู.

*   **ุงูุฃูุงู (ุฃูุช ุงููู ูุงุฒู ุชููู ุงูุจุงุจ):**
    ุจูุง ุฅู ูู `instance` ุจูู ูููุง ุนููุงู `public`ุ ุงูุฃูุงู ููุง ุจูุนุชูุฏ **100%** ุนููู ุฃูุช. **ุงูู `Security Groups` ูุงูู `Network ACLs`** ุจูุจููุง ุฃูู ูู ุงูุฃูู ุจูุชูุฑุ ูุฃููู ููุง "firewall" ุงููุญูุฏูู ุงููู ูุงูููู ุนูู ุจุงุจ ุงูู `instance` ุจุชุงุนุชู.
    ุงูุนุฒู ููุง ูุจูุงุด ุงูุชุฑุงุถู ุฒู `IPv4`. ููุง ูู ุงูุฃุจูุงุจ ููุชูุญุฉ ุนูู ุงูุดุงุฑุนุ ูุฃูุช ุงููู ูุงุฒู ุชุฑูุญ ุชููู ูู ุจุงุจ ูุด ุนุงูุฒู ุจููุณู ุนู ุทุฑูู ููุงุนุฏ ุงูู `firewall`.


> [!IMPORTANT]
>
> **ุงูู Egress-Only Internet Gateway ูุฌุงูู ุชูุงููุง (Free of charge).**
>
> **ุงูู NAT Gateway ููู ุชูููุฉ.**
>
> **ุชูุงุตูู ุงูุชูููุฉ (ููู ุงููุฑู ุฏู ููุฌูุฏุ)**
>
> **1. Egress-Only Internet Gateway (Egress-Only IGW)**
>
> - **ุงูุชูููุฉ:** **ุตูุฑ.** AWS ูุด ุจุชุญุงุณุจู ุนูู ุฅูุดุงุก ุงูู Egress-Only IGW ููุณูุ ููุง ุนูู ุญุฌู ุงูุฏุงุชุง ุงููู ุจุชุนุฏู ูู ุฎูุงูู. ุฃูุช ุจุชุชุญุงุณุจ ุจุณ ุนูู Data Transfer Out ุงูุนุงุฏู ุจุชุงุน AWS (ุชูููุฉ ููู ุงูุฏุงุชุง ูู AWS ููุฅูุชุฑูุช)ุ ูุฏู ุชูููุฉ ูุชุฏูุนูุง ูู ูู ุงูุฃุญูุงู.
> - **ููู ูุฌุงููุ** ูุฃูู ุจูุนูู ูุธููุฉ ุจุณูุทุฉ ุฌุฏูุง ููุจุงุดุฑุฉ. ูู ูุฌุฑุฏ gateway ุจูุนูู stateful filteringุ ูุนูู ุจูุณูุญ ููู traffic ุฅูู ูุทูุนุ ูุจูุณูุญ ููุฑุฏูุฏ ุจุชุงุนุฉ ููุณ ุงูุงุชุตุงู ุฏู ุฅููุง ุชุฑุฌุน. ูู ูุด ุจูุนูู NAT ุฃู ุฃู ุนูููุงุช ูุนูุฏุฉ ุจุชุณุชููู resources.
>
> **2. NAT Gateway**
>
> NAT Gateway ููู ููุนูู ูู ุงูุชูููุฉุ ูุฏู ุงููู ุจูุฎููู ุบุงูู ูุณุจููุง:
>
> 1. **ุชูููุฉ ุงูุณุงุนุฉ (Hourly Charge):**
>    ุฃูุช ุจุชุฏูุน ูููุณ ุนูู **ูู ุณุงุนุฉ** ุงูู NAT Gateway ุจุชุงุนู ุดุบุงู ูููุงุ ุญุชู ูู ูุนุฏุงุด ุนููู ุฃู traffic. (ุงูุชูููุฉ ุญูุงูู 0.045$ ูู ุงูุณุงุนุฉ ูู ูุนุธู ุงูู regions).
>    - **ูุนูู ูู ุงูุดูุฑ:** 0.045
>
> ```
> 0.045 ร 24 hours ร 30 days โ $32.4
> ```
>
>  ูู ุงูุดูุฑ ููู NAT Gatewayุ ุฏู ูู ุบูุฑ ุฃู traffic.
>
> 1. **ุชูููุฉ ูุนุงูุฌุฉ ุงูุฏุงุชุง (Data Processing Charge):**
>    ุจุชุฏูุน ูููุณ ุนูู **ูู ุฌูุฌุงุจุงูุช** ูู ุงูุฏุงุชุง ุจุชุนุฏู ูู ุฎูุงู ุงูู NAT Gateway (ุณูุงุก ุทุงูุนุฉ ุฃู ุฑุงุฌุนุฉ). (ุงูุชูููุฉ ุญูุงูู 0.045$ ููู ุฌูุฌุงุจุงูุช).
>
> **ููู ููููุ**
> ูุฃู NAT Gateway ูู resource ููุฏุงุฑ ุจุงููุงููุ highly availableุ ู scalable. AWS ุจุชุจูููู ูู ูุฑุง ุงูููุงููุณ infrastructure ูููุฉ ุนุดุงู ุชุนูููุ ูุงูู infrastructure ุฏู ุจุชุณุชููู resources. ูู ุจูุนูู NAT (Port Address Translation)ุ ูุจูุญุชูุธ ุจู state ููู connectionุ ูุฏู ุนูููุงุช ุจุชุณุชููู CPU ู memory.
>
> ------

> [!IMPORTANT]
>
> **1. Internet Gateway (IGW)**
>
> - ุงูู Internet Gateway ููุณู **ูุฌุงูู ุชูุงููุง**.
> - AWS ูุด ุจุชุญุงุณุจู ุนูู ูุฌูุฏู ูู ุงูู VPC ุจุชุงุนูุ ููุง ุนูู ุญุฌู ุงูุฏุงุชุง ุงููู ุจุชุนุฏู ูู ุฎูุงูู.
> - **ุงูุชูููุฉ ุงููุญูุฏุฉ ุงููุฑุชุจุทุฉ ุจูู** ูู ุชูููุฉ **Data Transfer Out** (ุงูุฏุงุชุง ุงููู ุจุชุทูุน ูู AWS ููุฅูุชุฑูุช)ุ ูุฏู ุชูููุฉ ูุชุฏูุนูุง ูู ูู ุงูุฃุญูุงู ุณูุงุก ุงุณุชุฎุฏูุช IGW ุฃู ุฃู ุฎุฏูุฉ ุชุงููุฉ.
>
> ------
>
> 
>
> **2. Public IPv4 Addresses**
>
> ููุง ุจูู ุจุชูุฌู ุงูุชูููุฉ. AWS ุจุชุนุชุจุฑ ุงูู Public IPv4 addresses ููุฑุฏ ูุงุฏุฑ ููุญุฏูุฏุ ูุนุดุงู ูุฏู ุบูุฑุช ุณูุงุณุฉ ุงูุชุณุนูุฑ ุจุชุงุนุชู ูู ุฃูู ูุจุฑุงูุฑ 2024.
>
> - **ุงููุงุนุฏุฉ ุงูุฌุฏูุฏุฉ:** ุฃูุช ุจุชุชุญุงุณุจ ุนูู **ูู Public IPv4 address ููุฌูุฏ ูู ุญุณุงุจู**ุ ุณูุงุก ูุงู ูุชุฑูุจ ุนูู resource ุดุบุงู ุฃู ูุฃ.
> - **ุงูุชูููุฉ:** ุญูุงูู **$0.005 ููู IP ูู ุงูุณุงุนุฉ** (ูุนูู ุญูุงูู **$3.6 ูู ุงูุดูุฑ** ููู Public IP).
> - **ุฏู ุจูุดูู ุฅููุ**
>   - **Elastic IP addresses**: ุณูุงุก ูุชุฑูุจุฉ ุฃู ูุฃ.
>   - **Auto-assigned Public IPs**: ุงููู ุงูู EC2 instances ุจุชุงุฎุฏูุง ุฃูุชููุงุชูู.
> - **ุงูุงุณุชุซูุงุก:** AWS ุจุชุฏู ููู ุญุณุงุจ Free Tier ุจูุดูู **750 ุณุงุนุฉ** ูู ุงุณุชุฎุฏุงู Public IPv4 ุดูุฑููุง (ูุนูู ูุฃูู ูุดุบู IP ูุงุญุฏ ุทูู ุงูุดูุฑ ุจุจูุงุด). ุฃู IP ุฒูุงุฏุฉ ุนู ูุฏู ุจุชุชุญุงุณุจ ุนููู.
>
> ------
>
> 
>
> **3. IPv6 Addresses**
>
> ููุง ุงูููุถูุน ูุฎุชูู ุชูุงููุง.
>
> - **ุงููุงุนุฏุฉ:** **ุชุฎุตูุต ูุงุณุชุฎุฏุงู IPv6 addresses ูุฌุงูู ุชูุงููุง.**
> - AWS ูุด ุจุชุญุงุณุจู ุนูู ุชูุนูู IPv6 ูู ุงูู VPCุ ููุง ุนูู ุงูู CIDR /56 ุงููู ุจุชุงุฎุฏูุ ููุง ุนูู ุฃู IPv6 address ุงูู instance ุจุชุงุนุชู ุจุชุงุฎุฏู.
> - **ูููุ** ูุฃู IPv6 ูุชููุฑ ุจูุซุฑุฉุ ูAWS (ูุงูุนุงูู ููู) ุจุชุดุฌุน ุงููุงุณ ุฅููุง ุชุณุชุฎุฏูู.

> [!IMPORTANT]
>
> **3. Data Transfer (ููุง ุจุชูุฌู ุงูุชูููุฉ)**
>
> ุฏู ูู ุงูุญุชุฉ ุงููู ูููุง ุงูุชูุงุตูู. AWS ุจุชุญุงุณุจู ุนูู ุงูุฏุงุชุง ุงููู ุจุชุทูุน ูู ุงูู infrastructure ุจุชุงุนุชูุง ููุฅูุชุฑูุช ุงูุนุงู (Data Transfer Out to the Internet).
>
> - **ุงูุชุณุนูุฑ ุจูุนุชูุฏ ุนูู ุจุฑูุชูููู ุงูู IP ุงููุณุชุฎุฏู:**
>   - **ุชูููุฉ Data Transfer Out ุจุงุณุชุฎุฏุงู IPv4:** ุฏู ุงูุชูููุฉ ุงูุนุงุฏูุฉ ุงููู ูููุง ุนุงุฑููููุง (ุญูุงูู $0.09 ููู ุฌูุฌุงุจุงูุช ูุฃูู 10 ุชูุฑุงุจุงูุช ูู ุงูุดูุฑ).
>   - **ุชูููุฉ Data Transfer Out ุจุงุณุชุฎุฏุงู IPv6:** ููุง AWS ุนุงููุฉ ุชุณุนูุฑ **ุฃุฑุฎุต ุจูุชูุฑ**. ุงูุชูููุฉ ุจุชููู ุญูุงูู **$0.05** ููู ุฌูุฌุงุจุงูุช.
>
> **ุฅุฐูุงุ ุงูุชูููุฉ ุงููุญูุฏุฉ ุงููู ูููู ุชุฏูุนูุง ูููุง ุนูุงูุฉ ุจู IPv6 ูู ุชูููุฉ ุงูุฏุงุชุง ุงููู ุจุชุทูุน ูู ุณูุฑูุฑุงุชู ููุฅูุชุฑูุชุ ูุงูุชูููุฉ ุฏู ุจุชููู ุฃุฑุฎุต ุจูุณุจุฉ 40% ุชูุฑูุจูุง ูู ูู ููุช ุจุชุณุชุฎุฏู IPv4.**

> [!IMPORTANT]
>
> IPV6 ูุน ุงูุงูุชุฑูุช ูุงูุชุญูู ููู ูุด ูุฌุฑุฏ option ูุจูู ุนุจุท ูุนุจุท ูุจูุฑ ููู ุงูู ูุชุณุชุฎุฏููุด



---

## **`Elastic Network Interfaces (ENIs)`**

![Represents a virtual network card](https://symbols.getvecta.com/stencil_20/10_elastic-network-interface.33fca6770d.svg)

 ุนุดุงู ูููู ุฃู ุดุจูุฉ ูู `AWS` ุตุญุ ูุงุฒู ูุจุฏุฃ ูู ุญุฌุฑ ุงูุฃุณุงุณ ุจุชุงุนูุงุ ููู ุงูู **`elastic network interface` (`ENI`)**. ุงูู `ENI` ุฏู ูุด ูุฌุฑุฏ `virtual network interface`ุ ูู `resource` ูุงูู ููุณุชูู ููู ุฎุตุงุฆุต ูููุฉ ุฌุฏูุง. ุฃู `EC2 instance` ุจุชุนูููุง ูุงุฒู ูููู ูููุง `ENI` ุนุดุงู ุชูุฏุฑ ุชุจุนุช ุฃู ุชุณุชูุจู ุฃู `network traffic`ุ ุณูุงุก ูุงู ุฏู ุงุชุตุงู ุจุงูุฅูุชุฑูุชุ ุฃู ุงุชุตุงู ุจุฎุฏูุงุช `AWS` ุชุงููุฉุ ุฃู ุญุชู ุงุชุตุงูู ุฃูุช ุจููุง ุนุดุงู ุชุฏูุฑูุง ุนู ุทุฑูู `SSH` ุฃู `RDP`. ูู ุบูุฑ `ENI`ุ ุงูู `EC2 instance` ุจุชุงุนุชู ุจุชุจูู ูุฌุฑุฏ ุตูุฏูู ููููู ููุนุฒูู ุนู ุงูุนุงูู.

---

### **`Primary ENI` - ุงูู `Network Interface`**

ููุง ุจุชุนูู `launch` ูุฃู `EC2 instance` ุฌุฏูุฏุฉุ `AWS` ุจุดูู ุฃูุชููุงุชููู ุจุชุนูู ูุนุงูุง `ENI` ูุจุชุฑูุจู ูููุง. ุงูู `ENI` ุงูุฃููุงูู ูุงูุฃุณุงุณู ุฏู ุจูุณููู 
**`primary network interface` (`primary ENI`)**ุ ูููู ูุนุงููุฉ ุฎุงุตุฉ ุฌุฏูุง ูููุงุนุฏ ุตุงุฑูุฉ ููููุนุด ุชุชุบูุฑ:

1.  **ูุง ูููู ูุตูู:** ูุชูุฏุฑุด ุชูู ุงูู `primary ENI` ูู ุงูู `instance` ุจุชุงุนุชู ุทูู ูุง ูู ุนุงูุดุฉ. ูู ุฌุฒุก ูุง ูุชุฌุฒุฃ ูู identity ุงูุฎุงุตุฉ ุจู ุงูู `instance` .
2.  **ูุฑุชุจุท ุจู `subnet` ูุงุญุฏ ููุท:** ุงูู `primary ENI` ุจูุชุนูู ุฌูู `subnet` ูุงุญุฏ ููุญุฏุฏุ ููุชูุฏุฑุด ุชูููู ูู `subnet` ุชุงูู ุฃุจุฏูุง.

ูููุง ุจุชูุฌู ุฃูู ููุทุฉ ุนูููุฉ: ููุง `AWS` ุจุชุณุฃูู "ูุชุญุท ุงูู `instance` ุฏู ูู ุฃููู `subnet`ุ"ุ ุฃูุช ูู ุงูุญูููุฉ ูุด ุจุชุฎุชุงุฑ `subnet` ููู `instance` ููุณูุงุ ุฃูุช ุจุชุฎุชุงุฑ ุงูู `subnet` ุงููู ููุชุนูู ุฌูุงู ุงูู **`primary ENI`** ุจุชุงุนูุง.

> [!WARNING]
>
> ูู ุนุงูู AWSุ ููู ููุทุฉ ูููุฉ ุฌุฏูุง ูุงุฒู ูููููุงุ ููู ุฅู ุงูู primary ENI ุงููู AWS ุจุชูุดุฆู ุฃูุชููุงุชูู ูุน ุฃู EC2 instance ูู ุฌุฒุก ูุง ูุชุฌุฒุฃ ูู ุงูู instance ุฏูุ ูุฃูุช ูููุด ุชุญูู ููู ุฅุทูุงููุง. ููุฏุฑุด ุฃูููู ุญุงูุธ ุนูู ุงูู private IP ุจุชุงุนูุ ูููุฏุฑุด ุฃูููู ูุชุชูุณุญุด ููุง ุงูู instance ุชุชูุณุญุ ูููุฏุฑุด ุญุชู ุฃุฏููู IP ุซุงุจุช ุจุฅูุฏู ููุช ุงูุฅูุดุงุกุ ูู ูุนุชุจุฑ identity ูุคูุชุฉ ูุฑุชุจุทุฉ ุจุนูุฑ ุงูุณูุฑูุฑ ููุณู. ูููุง ุจุชุธูุฑ ูุดููุฉ ูุจูุฑุฉ ูู ุฅุฏุงุฑุฉ ุงูู infrastructure ุงูุญููููุฉุ ูุชุฎูู ุฅูู ุญุจูุช ุชุนูู ุฅููุงููุงุช ุงูู EC2 ุจุชุงุนุชู ูุชุบูุฑ ููุนูุง ูููุน ุฃุนูู. ูู ุงูุญุงูุฉ ุฏูุ ุจูุง ุฅูู ูุชุณุชุจุฏู ุงูู instanceุ ุงูู primary ENI ุจุชุงุนูุง ููุถูุน ููุชุงุฎุฏ private IP ุฌุฏูุฏ ุชูุงููุงุ ูุณุงุนุชูุง ูุชุถุทุฑ ุชุบูุฑ ุงูุฅุนุฏุงุฏุงุช ุฏู ุจุฅูุฏู ูู ูู ุงูู resources ุงูุชุงููุฉ ุงููู ูุงูุช ุจุชุณุชุฎุฏู ุงูู EC2 ุฏูุ ุฒู ุงูู DNS records ุฃู ุงูู Security Group rules ุฃู ุงูู application configurations. ููุง ุจูู ุจูุฌู ุงูุฏูุฑ ุงูุนุจูุฑู ููู **Secondary ENI**. ุงูู Secondary ENI ูู resource ูุณุชูู ุชูุงููุง ุฃูุช ุงููู ุจุชูุดุฆู ูุจุชุชุญูู ูููุ ุฃูุช ุจุชูุฏุฑ ุชุฏููู private IP ุซุงุจุช ูู ุงุฎุชูุงุฑูุ ูุงูุฃูู ูู ูุฏูุ ุจุชูุฏุฑ ุชูููู "ูู ูุณุญุช ุงูู EC2 ุงููู ุฃูุช ูุชุฑูุจ ุนูููุงุ ูุชุชูุณุญุด ูุนุงูุง". ุจุงูุทุฑููุฉ ุฏูุ ุงูู Secondary ENI ุจูุชุญูู ูู ูุฌุฑุฏ ูุงุฑุช ุดุจูุฉ ุฅุถุงููุ ูู persistent network identity**. ููุง ุชุญุจ ุชุนูู ุฅููุงููุงุช ุงูู EC2ุ ุงูู workflow ุจูุจูู ุณูุณ ุฌุฏูุง: ุจุชุนูู terminate ููู instance ุงููุฏููุฉุ ูุงูู primary ENI ุจุชุงุนูุง ุจูุชูุณุญุ ููู ุงูู Secondary ENI ุจุชุงุนู ุจููุถู ููุฌูุฏ. ุจุนุฏ ูุฏูุ ุจุชุนูู launch ููู instance ุงูุฌุฏูุฏุฉ ุจุงูุฅููุงููุงุช ุงูุฃุนููุ ูุจุชุฑูุญ ูุฑูุจ ุนูููุง ููุณ ุงูู Secondary ENI ุงููุฏูู. ุงููุชูุฌุฉ ุฅูู ูุฏู ูุฎุณุฑุชุด ุฃู ุญุงุฌุฉุ ุงูู Private IP ุงูุซุงุจุช ุงููู ูู ุงูู services ุงูุชุงููุฉ ุจุชูููู ุนููู ูุถู ุฒู ูุง ูู. ุจุทุจูุนุฉ ุงูุญุงูุ ุฃูุช ูุชููู ุนุงูู ููุณ ุงูููุทู ูุน ุงูุฏุงุชุง ุจุชุงุนุชู ุนู ุทุฑูู EBS volume ุจุชููู ูุชุฑูุจู ูู ุงูู instance ุงูุฌุฏูุฏุฉุ ูุจุงูุชุงูู ุฃูุช ุจุชููู ุบูุฑุช ุงูู Compute ููุทุ ูุณุจุช ูู ุญุงุฉ ุชุงููุฉ ุฒู ูุง ูู: **ุงูู Storage ูุงูู Networking **. ูุฏู ูู ุงูููุฉ ุงูุญููููุฉ ููู Cloud: ุงููุฏุฑุฉ ุนูู ูุตู ุทุจูุงุช ุงูู infrastructure ุนู ุจุนุถูุงุ ูุชุบููุฑ ุฃู ุทุจูุฉ ูู ุบูุฑ ูุง ุชุฃุซุฑ ุนูู ุงูุทุจูุงุช ุงูุชุงููุฉ. ุงูู Secondary ENI ูู ุงูุฃุฏุงุฉ ุงููู ุจุชุฏููู ุงูููุฉ ุฏู ูู ุทุจูุฉ ุงูุดุจูุงุช.

ุฏุง ูุซู ุญุงุฌุฉ ุดุจู 

```terraform
resource "aws_network_interface" "persistent_app_eni" {
  subnet_id       = aws_subnet.private.id
  #private_ips     = ["10.0.1.100"] 
  security_groups = [aws_security_group.internal_access.id]

  tags = {
    Name = "My-Application-ENI"
  }
}
```

ููู ููุท ูููุฉ ููููุฉ ุฌุฏูุง ูุงุฒู ุชุจูู ูุงุถุญุฉ ูุฅุญูุง ุจูุชุนุงูู ูุน ุงูู ENIs. ุฃูู ุญุงุฌุฉุ ููุง ุจูุนูู ENI ูุณุชููุ ุฅุญูุง ูููุง ูุทูู ุงูุญุฑูุฉ ูู ุงูุชุญูู ูู ุงูู IP ุจุชุงุนูุ ูููู ูุฏููู private IP ุซุงุจุช ุจุฅูุฏููุงุ ููููู ูุณูุจู ูุงุฎุฏ IP ุฏููุงูููู ูู ุงูู subnet ุนุงุฏู ุฌุฏูุง.

ุชุงูู ุญุงุฌุฉุ ููุง ุจูุฑูุจ ุงูู ENI ุฏู ูู Secondary ENI ุนูู EC2 instanceุ ูุงุฒู ูููุณุงุด ุฅู ุงูู Security Group ุงููู ุจูุญุฏุฏู ูู ุงูู aws_instance resource ุจูุฑูุญ ููู Primary ENI ุจุณ. ุฃูุง ุงูู Secondary ENI ูุจูููู ููู ุงูู Security Group ุงูุฎุงุต ุจูู ุงููู ุจูุญุฏุฏู ูุฅุญูุง ุจูุนูู ุงูู ENI ููุณู. ุฏู ููุทุฉ ูููุฉ ุฌุฏูุง ูุฃููุง ุจุชุฎูู ุงูู instance ูุฃููุง ูุญููุฉ ุจุงุชููู firewalls ูุฎุชููููุ ูู ูุงุญุฏ ุจููุงุนุฏู ุงูุฎุงุตุฉ.

ูุจูุง ุฅู ูู ENI ููู ุฎุตุงุฆุตูุ ูุฏู ูุนูุงู ุฅูู ุฃูุฏุฑ ุฃุนูู design ูุนูุฏุ ุฒู ุฅูู ุฃุญุท ุงูู Primary ENI ูู public subnet ูุฃุฏููู public IP (ุทุจุนูุง ูู ููู Internet Gateway)ุ ููู ููุณ ุงูููุช ุฃุฑูุจ Secondary ENI ุชุงูู ุนูู ููุณ ุงูู instance ูุฃุญุทู ูู private subnetุ ูุณุงุนุชูุง ุงูู ENI ุงูุชุงูู ุฏู ูุณุชุญูู ูุงุฎุฏ public IP. ุจุงูุทุฑููุฉ ุฏูุ ุจูุจูู ุนูุฏู instance ูุงุญุฏุฉ ูููุง "ุฑุฌู" ุนูู ุงูุฅูุชุฑูุชุ ู"ุฑุฌู" ุชุงููุฉ ูู ุงูุดุจูุฉ ุงูุฏุงุฎููุฉ ุงููุนุฒููุฉ ุชูุงููุง ุณุคุงู ููู ุงุนูู ูุฏู ูุด ุนุงุฑู ุงูุณูุงุฑูููุงุช ูููุงุด ุญุฏูุฏ ุญุฑููุง ูููู 



```
resource "aws_vpc" "main" {
  cidr_block = "10.0.0.0/16"
  tags = {
    Name = "ENI-Demo-VPC"
  }
}
data "aws_availability_zones" "AZs" {
  all_availability_zones = true
  state = "available"

}
resource "aws_subnet" "private" {
  vpc_id            = aws_vpc.main.id
  cidr_block        = "10.0.1.0/24"
  availability_zone = data.aws_availability_zones.AZs.names[0]
  tags = {
    Name = "Private-Subnet"
  }
}
data "aws_ami" "amazon_linux" {
  most_recent = true
  owners      = ["amazon"]
  filter {
    name   = "name"
    values = ["amzn2-ami-hvm-*-x86_64-gp2"]
  }
}

resource "aws_security_group" "internal_access" {
  name   = "internal-access-sg"
  vpc_id = aws_vpc.main.id

}

resource "aws_network_interface" "persistent_app_eni" {
  subnet_id       = aws_subnet.private.id
  #private_ips     = ["10.0.1.100"] 
  security_groups = [aws_security_group.internal_access.id]

  tags = {
    Name = "My-Application-ENI"
  }
}

resource "aws_instance" "app_server_v1" {
  ami           = data.aws_ami.amazon_linux.id
  instance_type = "t2.micro"
  subnet_id     = aws_subnet.private.id
  security_groups = [aws_security_group.internal_access.id]

  tags = {
    Name = "App-Server-V1 (t2.micro)"
  }
}


resource "aws_network_interface_attachment" "eni_attachment" {
  instance_id = aws_instance.app_server_v1.id
  network_interface_id = aws_network_interface.persistent_app_eni.id
  device_index         = 1 
  
}

```



  device_index         = 1  ูู ุงูุนุงุฏู ุจูุจุฏุงุก ูู zero ูู ุจุณ ZERO ูุญุฌูุฒ ูููPRIMARY ููู ูุงุญุฏ ุชุญุทู ูู EC2 ูุฒู ุชุฒูุฏ ูุงุญุฏ ุนูู device_index

ุงูุง ูุบูุฑ ููุน Ec2 ูุดูู ููู ุงููู ููุชุบูุฑ

![image-20250816034556264](assets/image-20250816034556264.png)



![image-20250816035200398](assets/image-20250816035200398.png)

ููุง ุชุจุงู ุงูููุฉ ุงูุญูููุฉ ููููุฉ cloud ุงูู ุนุงุฏู ุชูุฏุฑ ุชููู ip ูู ec2 ููec2 ุจุฑุญุชู ูุด ุดุฑุท ุฒู ููุง ุบูุฑุช ููุน ุชูุฏุฑ ุชุนูู attach ููec2 ุซุงููุฉ ุนุงุฏู ุฌุฏุง 

> [!NOTE]
>
>
> ููุญูุธุฉ: ุฑุจุท EC2 Instance ุจุฃูุซุฑ ูู Subnet ูู ููุณ ุงูู Availability Zone**
>
> ูููู ุชุจุงู ุบุฑูุจุฉุ ููู EC2 instance ูุงุญุฏุฉ ุชูุฏุฑ ุชููู ููุฌูุฏุฉ ูู **ุงุชููู subnets ูุฎุชูููู ูู ููุณ ุงูููุช**ุ ุจุดุฑุท ุฃุณุงุณู ูููู: ุฅู ุงูุงุชููู subnets ุฏูู ูููููุง ูู **ููุณ ุงูู Availability Zone (AZ)**.
>
> ุฏู ูุด ูุนูุงู ุฅู ุงูู instance ููุณูุง ุจุชุชูุฏุฏ ุจูู ุงูุดุจูุชููุ ููู ุฏู ุจูุญุตู ุนู ุทุฑูู ุฅููุง ุจูุฑูุจ ุนูููุง ุฃูุชุฑ ูู Elastic Network Interface (ENI)ุ ูู ูุงุญุฏ ูููู ุจูุญุทู ูู subnet ูุฎุชูู.
>
> **ูุซุงู ุนููู:**
> ุชุฎูู ุนูุฏู ุชุตููู ุดุจูุฉ ุจุงูููุธุฑ ุฏู ุฌูู ููุณ ุงูู AZ (ูุซูุงู eu-west-1a):
>
> 1. **Public Subnet (10.0.1.0/24):** ุฏู ุงููู ุจูุณุชูุจู ุงูู traffic ูู ุงูุฅูุชุฑูุช.
> 2. **Private Subnet (10.0.2.0/24):** ุฏู ุงููู ููู ุงูู database ุจุชุงุนุชู.
>
> ุฃูุช ูููู ุชุนูู EC2 instance (ุฒู web server) ูุชุฎูููุง "ุฌุณุฑ" ุจูู ุงูุดุจูุชูู ุฏูู. ุจุชุนูู ุงูุขุชู:
>
> - ุจุชุนูู launch ููู instance ูุงูู **Primary ENI** ุจุชุงุนูุง ุจููุฒู ูู ุงูู Public Subnet. ุงูู ENI ุฏู ุจูุงุฎุฏ Public IP ูุจูุณุชูุจู ุงูู requests ูู ุงููุณุชุฎุฏููู.
> - ุจุนุฏ ูุฏูุ ุจุชุนูู Secondary ENI ุฌุฏูุฏ ูุจุชุญุทู ูู ุงูู **Private Subnet**ุ ูุจุชุฑูุจู ุนูู ููุณ ุงูู EC2 instance.
>   ุจูู ุนูุฏู EC2 instance ูุงุญุฏุฉ ูููุง ุนููุงููู IP ูุฎุชูููู ุนูู ุดุจูุชูู ูููุตูุชูู:
>
> - **IP ุนุงู** ุนูู ENI-1 ูู ุงูู Public Subnet.
> - **IP ุฎุงุต** ุนูู ENI-2 ูู ุงูู Private Subnet.
>
> ุจุงูุทุฑููุฉ ุฏูุ ุงูู instance ุจุชูุฏุฑ ุชุณุชูุจู ุงูู traffic ูู ุงูุฅูุชุฑูุชุ ููู ููุณ ุงูููุช ุชููู ุงูู database ุจุชุงุนุชูุง ุจุดูู ุขูู ููุจุงุดุฑ ุนูู ุงูุดุจูุฉ ุงูุฏุงุฎููุฉุ ููู ุฏู ูู ููุณ ุงูุณูุฑูุฑ. ุฏู ุชุตููู ููู ุฌุฏูุง ุจูุณุชุฎุฏูู ูู ุงูู Network Appliances ุฒู ุงูู Firewalls ุฃู ุงูู Proxies ุงููู ุจุชุญุชุงุฌ ุชูุตู ุจูู ุฃููุงุน ูุฎุชููุฉ ูู ุงูู traffic.
>
> ```terraform
> 
> resource "aws_vpc" "main" {
>   cidr_block = "10.0.0.0/16"
>   tags = {
>     Name = "Multi-Subnet-EC2-VPC"
>   }
> }
> 
> locals {
>   availability_zone = "eu-west-1a"
> }
> 
> resource "aws_internet_gateway" "igw" {
>   vpc_id = aws_vpc.main.id
> }
> 
> resource "aws_subnet" "public" {
>   vpc_id                  = aws_vpc.main.id
>   cidr_block              = "10.0.1.0/24"
>   availability_zone       = local.availability_zone
>   map_public_ip_on_launch = true
> 
>   tags = {
>     Name = "Public-Subnet-Multi-ENI"
>   }
> }
> 
> resource "aws_subnet" "private" {
>   vpc_id            = aws_vpc.main.id
>   cidr_block        = "10.0.2.0/24"
>   availability_zone = local.availability_zone
> 
>   tags = {
>     Name = "Private-Subnet-Multi-ENI"
>   }
> }
> 
> resource "aws_route_table" "public_rt" {
>   vpc_id = aws_vpc.main.id
>   route {
>     cidr_block = "0.0.0.0/0"
>     gateway_id = aws_internet_gateway.igw.id
>   }
> }
> 
> resource "aws_route_table_association" "public_assoc" {
>   subnet_id      = aws_subnet.public.id
>   route_table_id = aws_route_table.public_rt.id
> }
> 
> resource "aws_security_group" "public_eni_sg" {
>   name   = "public-eni-sg"
>   vpc_id = aws_vpc.main.id
> 
>   ingress {
>     from_port   = 80
>     to_port     = 80
>     protocol    = "tcp"
>     cidr_blocks = ["0.0.0.0/0"]
>   }
> 
>   ingress {
>     from_port   = 22
>     to_port     = 22
>     protocol    = "tcp"
>     cidr_blocks = ["0.0.0.0/0"]
>   }
> 
>   egress {
>     from_port   = 0
>     to_port     = 0
>     protocol    = "-1"
>     cidr_blocks = ["0.0.0.0/0"]
>   }
> }
> 
> resource "aws_security_group" "private_eni_sg" {
>   name   = "private-eni-sg"
>   vpc_id = aws_vpc.main.id
> 
>   ingress {
>     from_port   = -1
>     to_port     = -1
>     protocol    = "-1"
>     cidr_blocks = [aws_vpc.main.cidr_block]
>   }
> 
>   egress {
>     from_port   = 0
>     to_port     = 0
>     protocol    = "-1"
>     cidr_blocks = ["0.0.0.0/0"]
>   }
> }
> 
> data "aws_ami" "amazon_linux" {
>   most_recent = true
>   owners      = ["amazon"]
>   filter {
>     name   = "name"
>     values = ["amzn2-ami-hvm-*-x86_64-gp2"]
>   }
> }
> 
> resource "tls_private_key" "ssh_key" {
>   algorithm = "ED25519"
> }
> 
> resource "local_file" "ssh_key" {
>   content         = tls_private_key.ssh_key.private_key_pem
>   filename        = "${path.root}/my_ssh_key_of_ec2.pem"
>   file_permission = "0400"
> }
> 
> resource "aws_key_pair" "my_key" {
>   key_name   = "multi-eni-key"
>   public_key =tls_private_key.ssh_key.public_key_openssh
> }
> 
> resource "aws_instance" "multi_homed_server" {
>   ami           = data.aws_ami.amazon_linux.id
>   instance_type = "t2.micro"
>   key_name      = aws_key_pair.my_key.key_name
>   subnet_id     = aws_subnet.public.id
>   vpc_security_group_ids = [aws_security_group.public_eni_sg.id]
> 
>   tags = {
>     Name = "Multi-Homed Web Server"
>   }
> }
> 
> resource "aws_network_interface" "private_eni" {
>   subnet_id       = aws_subnet.private.id
>   security_groups = [aws_security_group.private_eni_sg.id]
>   private_ips     = ["10.0.2.100"]
> 
>   tags = {
>     Name = "Private-Side-ENI"
>   }
> }
> 
> resource "aws_network_interface_attachment" "eni_attachment" {
>   instance_id          = aws_instance.multi_homed_server.id
>   network_interface_id = aws_network_interface.private_eni.id
>   device_index         = 1
> }
> 
> output "server_public_ip" {
>   value = aws_instance.multi_homed_server.public_ip
> }
> 
> output "server_private_ip_on_public_subnet" {
>   value = aws_instance.multi_homed_server.private_ip
> }
> 
> output "server_private_ip_on_private_subnet" {
>   value = aws_network_interface.private_eni.private_ip
> }
> 
> output "ssh_command" {
>   value = "ssh -i your-key.pem ec2-user@${aws_instance.multi_homed_server.public_ip}"
> }
> ```
>
> ![image-20250816053845034](assets/image-20250816053845034.png)
>
> ูุงุญุธ ip ูู subnet ูip ูู subnet ุซุงูู 
>
> ![image-20250816054348065](assets/image-20250816054348065.png)
>
> ![image-20250816054432038](assets/image-20250816054432038.png)



### **`IP Addresses` - ูู digital identity ููู `ENI`**

ุงูู `ENI` ูู ุงูุญุงูู ุฃู ุงูู `carrier` ูุนูุงููู ุงูู `IP`. ุฃู `IP` ูุงุฒู ูููู ูุฑุชุจุท ุจู `ENI`.
*   **`Primary Private IP Address`:** ูู `ENI` ูุงุฒู ูููู ููู
     `primary private IP address` ูุงุญุฏ ุนูู ุงูุฃูู. ุงูู `IP` ุฏู ุจูุชุงุฎุฏ ูู ุงูู `CIDR range` ุจุชุงุน ุงูู `subnet` ุงููู ุงูู `ENI` ููุฌูุฏ ููู. ุฃูู ููุฒุฉ ููู ุฅูู ุซุงุจุช ููุณุชูุฑุ ููุชูุฏุฑุด ุชุบูุฑู ุฃู ุชูุณุญู ูู ุงูู `ENI` ุทุงููุง ุงูู `ENI` ููุฌูุฏ.
*   **`Secondary Private IP Addresses`:** ูู ุงุญุชุฌุชุ ุจุชูุฏุฑ ุชุถูู ุนูุงููู `IP` ุชุงููุฉ ูููุณ ุงูู `ENI`ุ ูุฏู ุจูุณูููุง `secondary private IP addresses`. ุฏู ุจูููุฏู ุฌุฏูุง ูู ุนูุฏู `application` ุนูู ุงูุณูุฑูุฑ ูุญุชุงุฌ ูุดุชุบู ุนูู ุฃูุชุฑ ูู `IP` ูู ููุณ ุงูููุชุ ุฒู ูุซูุงู ูู ุจุชุนูู `host` ูููุงูุน `SSL` ูุฎุชููุฉ. ุงูุดุฑุท ุงููุญูุฏ ุฅู ูู ุงูู `secondary addresses` ุฏู ูุงุฒู ุชููู ูุชุงุฎุฏุฉ ูู ููุณ ุงูู `range` ุจุชุงุน ููุณ ุงูู `subnet`.

---

### **ุชุนุฏุฏ ุงูู `ENIs` - ุชูุตูู ุงูู `Instance` ุนูู ุฃูุชุฑ ูู ุดุจูุฉ**

ูููุง ุงูููุถูุน ุจูุจุฏุฃ ูุจูู ูุชูุฏู ูููุชุน. ุฃูุช ูุด ูุญุจูุณ ูู `ENI` ูุงุญุฏ ููู `instance`.ูุงูู `AWS` ุจุชุณูุญูู ุชุฑูุจ ุฃูุชุฑ ูู `ENI` ุนูู ููุณ ุงูู `EC2 instance`. ุงูุณููุงุฑูู ุฏู ุจูุฎูู ุงูู `instance` ูุฃููุง ูุชูุตูุฉ ุนูู ุดุจูุชูู ูุฎุชููุชูู ูู ููุณ ุงูููุชุ ูู ุดุจูุฉ ูููุง `IP range` ู `Security Group` ูุฎุชูู.
*   **ุฃุดูุฑ ุงุณุชุฎุฏุงู:** ูููู ุชุนูู `primary ENI` ูู `public subnet` ุนุดุงู ูุณุชูุจู ุงูู `traffic` ุงููู ุฌุงู ูู ุงููุณุชุฎุฏููู ุนูู ุงูุฅูุชุฑูุชุ ููู ููุณ ุงูููุช ุชุฑูุจ `secondary ENI` ูู `private subnet` ุชุงูู ุฎุงูุต ุนุดุงู ุงูู `instance` ุชููู ุงูู `database` ูู ุฎูุงูู ุจุดูู ุขูู ูููุนุฒู ุชูุงููุง ุนู ุงูุฅูุชุฑูุช.
*   **ุงูุดุฑุท ุงููุญูุฏ:** ูู ุงูู `ENIs` ุงููู ูุชุฑูุจูุง ุนูู `instance` ูุงุญุฏุฉ ูุงุฒู ูููููุง ููุฌูุฏูู ูู ููุณ ุงูู `availability zone`.

---

### **ูุฑููุฉ ุงูู `ENI` - ูุนูู ูููุฉ "Elastic" ุงูุญูููู**

ุฃูู ููุทุฉ ุจุชููุฒ ุงูู `ENI` ูุจุชุฏููุง ุงุณููุง ูู ุฅููุง **`resource` ูุณุชูู ุจุฐุงุชู**ุ ูุด ูุฌุฑุฏ ุชุงุจุน ููู `instance`. ุฃูุช ูููู ุชุนูู `ENI` ูุชุณูุจู ููุฌูุฏ ูู ุญุณุงุจู ูู ุบูุฑ ูุง ูููู ูุชุฑูุจ ูู ุฃู `instance`ุ ูุชูุฏุฑ ุชุชุญูู ูู ุฏูุฑุฉ ุญูุงุชู ุจุดูู ูุงูู ุนู ุทุฑูู ุฎุงุตูุฉ
 **`Delete On Termination`**. ูู ุนุทูุช ุงูุฎุงุตูุฉ ุฏู ุนูู `secondary ENI`ุ ุงูู `ENI` ูููุถู ููุฌูุฏ ุจูู ุฅุนุฏุงุฏุงุชู ุญุชู ูู ูุณุญุช ุงูู `instance` ุงููู ูุงู ูุชุฑูุจ ูููุง.

ุงูููุฉ ุงูุญููููุฉ ูุงููุฑููุฉ (`Elasticity`) ุจุชุธูุฑ ููุง: ุจูุง ุฅู ุงูู `ENI` ูุณุชููุ ุจุชูุฏุฑ ุชููู (`detach`) ูู `instance` ูุชุฑูุจู (`attach`) ูู `instance` ุชุงููุฉ ูู ุซูุงูู.
*   **ุฃููู ุงุณุชุฎุฏุงู ูู ูู ุงูู `Failover`:** ูู ุนูุฏู `instance` ุฑุฆูุณูุฉ ุญุตู ูููุง ูุดููุฉ ูููุนุชุ ุจุชูุฏุฑ ูู ุซูุงูู ุชูู ุงูู `ENI` ุจุชุงุนูุง (ุงููู ุจูุญูู ุงูู `IP` ูุงูู `Security Group` ููู ุงูุฅุนุฏุงุฏุงุช) ูุชุฑูุจู ูู `instance` ุชุงููุฉ ุจุฏููุฉ (`standby`). ุจุงูุทุฑููุฉ ุฏูุ ุฃูุช ุจุชุนูุฏ ุชูุฌูู ูู ุงูู `traffic` ุงููู ูุงู ุฑุงูุญ ููู `instance` ุงููุฏููุฉ ููุฌุฏูุฏุฉ ูู ุบูุฑ ูุง ุชุญุชุงุฌ ุชุบูุฑ ุฃู `IP address` ุฃู `DNS record`ุ ูุฏู ุจูููู ุงูู `downtime` ุฌุฏูุง ูุจูุถูู ุงุณุชูุฑุงุฑูุฉ ุงูุฎุฏูุฉ.



### **`Enhanced Networking` - ููู `EC2`**

 ุงูู `ENI` ุงูุนุงุฏู ุงููู ุงุชููููุง ุนูู ูู ุงูุทุฑููุฉ ุงูุฃุณุงุณูุฉ ููุงุชุตุงูุ ููู ูู ุงูุชุทุจููุงุช ุงููู ูุญุชุงุฌุฉ   ุฌุฏูุง ุงูู `High-Performance Computing`ุ ุฃู `video streaming`ุ ุฃู `databases` ุถุฎูุฉ)ุ ุงูู `ENI` ุงูุนุงุฏู ุฏู ุจูููู ุนูู ุฒุฌุงุฌุฉ (`bottleneck`). ูููุง ุจูุฌู ุฏูุฑ ุฎุงุตูุฉ ุงูู **`Enhanced Networking`**. ุฏู ูุด ูุฌุฑุฏ `ENI` ุฌุฏูุฏุ ุฏู ุทุฑููุฉ ูุฎุชููุฉ ุชูุงููุง ุงูู `EC2 instance` ุจุชุชููู ุจููุง ูุน ุดุจูุฉ `AWS`.

#### **ุงููุดููุฉ ูู ุงูุทุฑููุฉ ุงูุนุงุฏูุฉ (ูู ุบูุฑ `Enhanced Networking`)**

ุนุดุงู ุชููู ููู `Enhanced Networking` ูููุฉุ ูุงุฒู ุชุนุฑู ุงูุทุฑููุฉ ุงูุนุงุฏูุฉ ุดุบุงูุฉ ุฅุฒุงู. ุฃู `EC2 instance` ูู ุนุจุงุฑุฉ ุนู `virtual machine` ุดุบุงูุฉ ุนูู `physical server` ูุจูุฑ. ุงููู ุจูุฏูุฑ ูู ุงูู `virtual machines` ุฏู ูู ุจุฑูุงูุฌ ุงุณูู **`hypervisor`**.
ูู ุงููุถุน ุงูุนุงุฏูุ ููุง ุงูู `instance` ุจุชุงุนุชู ุจุชุจุนุช `network traffic`ุ ูู ูุด ุจุชููู ูุงุฑุช ุงูุดุจูุฉ ุงูููุฒูุงุฆู ูุจุงุดุฑุฉ. ูุฃุ ูู ุจุชููู ุงูู `hypervisor`ุ ูุงูู `hypervisor` ูู ุงููู ุจูุงุฎุฏ ุงูู `traffic` ุฏู ููุนุงูุฌู ูุจุนุฏูู ูุจุนุชู ููุงุฑุช ุงูุดุจูุฉ ุงูููุฒูุงุฆู. ุงูุนูููุฉ ุฏู ุจุชุฎูู ุทุจูุฉ ูุณูุทุฉ ุจุชุณุจุจ ุญุงุฌุชูู:
1.  **`Latency` :** ููู ููุช ุจูุถูุน ูู ุงููุต ูุงูู `hypervisor` ุจูุนุงูุฌ ุงูู `traffic`.
2.  **`CPU Utilization`:** ุงูู `hypervisor` ุจูุณุชููู ุฌุฒุก ูู ููุฉ ุงูู `CPU` ุจุชุงุนุฉ ุงูุณูุฑูุฑ ุงูููุฒูุงุฆู ุนุดุงู ูุนูู ุงูุดุบู ุฏูุ ูุฏู ุจูููู ูู ููุฉ ุงูู `CPU` ุงููุชุงุญุฉ ููู `instance` ุจุชุงุนุชู.

#### **ุงูุญู: `Enhanced Networking` ุจุชุนูู ุฅูู ุจุงูุธุจุทุ**

ุงูู `Enhanced Networking` ุจุชุณุชุฎุฏู ุชูููููุฌูุง ุงุณููุง
 **`single-root input/output virtualization (SR-IOV)`**. ุงูุชูููููุฌูุง ุฏู ุจุชุนูู ุญุงุฌุฉ ุนุจูุฑูุฉ: ุจุชุณูุญ ููุงุฑุช ุงูุดุจูุฉ ุงูููุฒูุงุฆู ุฅูู ููุฏู ููุณู ูุฃูู ูุฑูุช ุดุจูุฉ ุงูุชุฑุงุถูุฉ ูุชูุฑ ูููุตูุฉ.
`AWS` ุจุชุณุชุฎุฏู ุงูู `SR-IOV` ุนุดุงู ุชุฏู ููู `EC2 instance` ุจุชุงุนุชู **ูุตูู ูุจุงุดุฑ (`direct access`)** ูุฌุฒุก ูุฎุตุต ูููุง ูู ูุงุฑุช ุงูุดุจูุฉ ุงูููุฒูุงุฆู.

![Single Root I/O Virtualization (SR-IOV) ไป็ดน](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiiyo5byBiQXKB4DhThHgQ9Nt4BWcuzzdMOg2sSK7zjU6CKx03A7HaJNu-xEO-6RNVw58PSm5D7wz8bBNPmlqwQ2REzbdrMe-izez0-awrP72HHqMXW-DQKLkp6ZWfgi1VnM-IcmaCRCJ6F/s719/sr-iov_pfvf.PNG)

![What is SR-IOV (Single Root I/O Virtualization) ? - Fir3net](https://www.fir3net.com/wp-content/uploads/2016/05/images_articles_sr-iov.png)

**ุงููุชูุฌุฉ:** ุงูู `instance` ุจุชุงุนุชู ุจุชุจุฏุฃ ุชููู ูุงุฑุช ุงูุดุจูุฉ ูุจุงุดุฑุฉุ ูุจุชุนูู **`bypass` ููู `hypervisor`** ุชูุงููุง ูู ููุถูุน ุงูู `network traffic`. ุงูู `hypervisor` ุจูุจุทู ูููู ูู ุงููุณูุท.

#### **ุงูููุงุฆุฏ ุงููุจุงุดุฑุฉ ูู ุงูู `Bypass` ุฏู:**

1.  **ุฃุฏุงุก ุดุจูู ุฃุนูู (`Higher network throughput`):** ุจูุง ุฅู ูููุด ูุณูุทุ ุจุชูุฏุฑ ุชุจุนุช ูุชุณุชูุจู ูููุฉ ุฏุงุชุง ุฃูุจุฑ ุจูุชูุฑ ูู ุงูุซุงููุฉ ุงููุงุญุฏุฉ.
2.  **ุชุฃุฎูุฑ ุฃูู (`Lower latency`):** ุฒูู ุงูุงุณุชุฌุงุจุฉ ุจูููู ุฃูู ุจูุชูุฑ ูุฃู ุงูู `traffic` ุจููุตู ูุจุงุดุฑุฉ ูู ุงูู `instance` ูููุงุฑุช ุงูููุฒูุงุฆู.
3.  **ุงุณุชููุงู `CPU` ุฃูู (`Lower CPU utilization`):** ุงูู `hypervisor` ูุจูุงุด ุจูุณุชููู `CPU` ุนุดุงู ูุนุงูุฌ ุงูู `traffic`ุ ูุฏู ุจูุณูุจ ููุฉ `CPU` ุฃูุจุฑ ููู `application` ุจุชุงุนู ุนุดุงู ูุดุชุบู.

#### **ุฅุฒุงู ุชุณุชููุฏ ูู ุงูู `Enhanced Networking`ุ **

`AWS` ุจุชููุฑูู ุทุฑููุชูู ุนุดุงู ุชุณุชุฎุฏู ุงูุฎุงุตูุฉ ุฏูุ ูุฏู ุจูุนุชูุฏ ุนูู ููุน ุงูู `instance` ุงููู ุจุชุฎุชุงุฑู:

1.  **`Elastic Network Adapter (ENA)`:**
    *   ุฏู ุงูููุน ุงูุฃุญุฏุซ ูุงูุฃููู ูุงูุฃูุซุฑ ุดููุนูุง.
    *   ุจููุฏุฑ ููุตู ูุณุฑุนุงุช `throughput` ููููุฉ ุจุชูุตู ูู **100 `Gbps`**.
    *   ูุนุธู ุฃููุงุน ุงูู `instances` ุงูุฌุฏูุฏุฉ ุจุชุฏุนูู ุจุดูู ุฃุณุงุณู. ุฏู ูู ุงูุงุฎุชูุงุฑ ุงููู ุงูููุฑูุถ ุชุณุชุฎุฏูู ุฏุงูููุง ูู ูุชุงุญ.

```
resource "aws_instance" "ena_instance" {
  instance_type = "c5.large"
  ena_support = true
  sriov_net_support = "simple"
}
```

ูููู ุจุฑุถู ุชุญุท ุนูู secondry ูุด ุดุฑุท primary

1.  **`Intel 82599 Virtual Function (VF) interface`:**
    *   ุฏู ุงูููุน ุงูุฃูุฏู.
    *   ุณุฑุนุชู ูุญุฏูุฏุฉ ุฃูุชุฑ ูุจุชูุตู ูู **10 `Gbps`** ุจุณ.
    *   ูุชุงุญ ุจุณ ุนูู ุฃููุงุน ููููุฉ ููุฏููุฉ ูู ุงูู `instances` ุงููู ูุด ุจุชุฏุนู ุงูู `ENA`. ุจุชุนุชุจุฑู `AWS` ูุฎูุงุฑ `legacy`.

```hcl
resource "aws_instance" "vf_instance" {
  instance_type = "c3.large"  
  sriov_net_support = "simple"
  # ุจุฏูู ena_support
}
```

#### **ุงููุชุทูุจุงุช ุนุดุงู ุชุดุชุบู**

ุนุดุงู ุงูู `Enhanced Networking` ุชุดุชุบู ุตุญุ ูุธุงู ุงูุชุดุบูู ุงููู ุฌูู ุงูู `instance` ุจุชุงุนุชู ูุงุฒู ูููู ููู ุงูู `drivers` ุงูููุงุณุจุฉ ุงููู ุจุชุฎููู ูุนุฑู ูุชููู ูุน ุงูู `ENA` ุฃู ุงูู `Intel VF`.
ุงูุฎุจุฑ ุงููููุณ ุฅู `AWS` ูุณููุฉ ุงูููุถูุน ุฏู ุฌุฏูุง. ุฃู `AMI` ุญุฏูุซุฉ ูู `Amazon Linux` ุฃู `Ubuntu` ูู ุงูููุน `HVM`ุ ุจุชููู ุงูู `drivers` ุฏู ูุชุณุทุจุฉ ููุชูุนูุฉ ูููุง ุจุดูู ุงูุชุฑุงุถู. ููู ุงููู ุนููู ูู ุฅูู ุชุฎุชุงุฑ `instance type` ุจูุฏุนู ุงูุฎุงุตูุฉ ุฏูุ ููู ูุชุดุชุบู ูุนุงู ุนูู ุทูู.

> [!TIP]
>
> 
>
> **ููุญูุธุฉ ูุงูุฉ: ุฅูู ุฏูุฑ `Enhanced Networking` ุทุงููุง ูู `EC2 Instance` ูููุง `Bandwidth` ูุญุฏุฏุ**
>
> ูู `instance type` ุจูุฌู ูููุชูุจ ุฌูุจู `Network Performance` ุจุชุงุนุชู (ูุซูุงู `Up to 5 Gbps` ุฃู `10 Gbps`). ุฏู ุงูู `bandwidth` ุงูุฃูุตู ุงููู ุงูู `instance` ุฏู ูููู ุชูุตู ูู ูุธุฑููุง.
>
> **ุทุจ ุฅูู ุฏูุฑ ุงูู `Enhanced Networking` ููุงุ**
>
> ุงูู `Enhanced Networking` ูุด ุจุชุฏููู `bandwidth` **ุฃูุชุฑ** ูู ุงููู ุงูู `instance type` ุจุชุงุนู ุจูุณูุญ ุจููุ ููููุง ูู **ุงูุฃุฏุงุฉ ุงููู ุจุชุฎููู ุชูุฏุฑ ุชูุตู ููู `bandwidth` ุฏู ูุนููุง ูุจุดูู ูุณุชูุฑ**
> ุงูู `Enhanced Networking` ูู "ุงูุทุฑูู ุงูุณุฑูุน" ุงููู ุจูุดูู ุงูุนูุงุฆู ุงููู ุจูุณุจุจูุง ุงูู `hypervisor`. ูู ุบูุฑูุงุ ุงูู `instance` ุจุชุงุนุชู ูููู ูุชูุตูุด ููู `bandwidth` ุงูุฃูุตู ุจุชุงุนูุงุ ููุชุณุชููู `CPU` ุฃุนูู ููู ุจุชุญุงููุ ููุชุนุงูู ูู `latency` ุฃุนูู. ูุน `Enhanced Networking`ุ ุฃูุช ุจุชุถูู ุฅูู ุจุชุณุชููุฏ ูู ูู ูููู ุฏูุนุชู ูู ุงูู `Network Performance` ุจุชุงุน ุงูู `instance` ุจุชุงุนุชู.



---

## **`Internet Gateway (IGW)`  ูู `IPv4`**

ุนุดุงู ูููู ุฅุฒุงู ุงูู `EC2 instance` ุจุชูุฏุฑ ุชููู ุงูุฅูุชุฑูุชุ ูุงุฒู ูููู ุงูููุธููุฉ ุงููุงููุฉ ุงููู `AWS` ุจุชุจูููุงุ ูุงููู ุจุชุชููู ูู ุฃูุชุฑ ูู ูุฌุฑุฏ `gateway`. ุงูููุถูุน ุนุจุงุฑุฉ ุนู ุฎุทูุงุช ูุชูุงููุฉุ ูู ุฎุทูุฉ ูููุง ุจุทู ูุฎุชูู ููุฏู ูุฎุชูู.

#### **1. `Internet Gateway (IGW)` - ุจูุงุจุฉ ุงูู `VPC` ุนูู ุงูุนุงูู**

ุจุต ูุงุจุงุดุงุ ุงูู **`Internet Gateway (IGW)`** ุฏู ุนุจุงุฑุฉ ุนู `resource` `AWS` ูู ุงููู ุจุชุฏูุฑู ุจุงููุงููุ ูุธููุชู ุญุงุฌุฉ ูุงุญุฏุฉ: ููุชุญ ูุตูุฉ ูุช ูู ุงุชุฌุงููู (ุฑุงูุญ ุฌุงู) ุจูู ุงูุณูุฑูุฑุงุช ุงููู ุฌูู ุงูู `VPC` ุจุชุงุนู ูุจูู ุงูุฅูุชุฑูุช.

ููุง ุจุชุฑูุจ `IGW` ุนูู ุงูู `VPC` ุจุชุงุนูุ ุฃูุช ุจุชูุชุญ ุงูุจุงุจ ูุญุงุฌุชูู ุฃุณุงุณูุชูู:
1.  **ุจูุจูู ุนูุฏู "ูุฏู" ููู `traffic`:** ุงูู `IGW` ุจูุธูุฑ ูุงุฎุชูุงุฑ ูู ุงูู `Route Tables` ุนุดุงู ุชูุฌู ุนููู ุฃู `traffic` ุนุงูุฒ ุชุทูุนู ุจุฑู.
2.  **ุจูุนูู `Network Address Translation (NAT)`:** ูู ุงููู ุจูุนูู ุนูููุฉ "nat" ุจุชุงุนุฉ ุงูู `IPs`ุ ูุฏู ุฃูู ูุธููุฉ ููู.

`AWS` ุจุชุฑูุญู ูู ุงูุฃููุ ุงูู `Default VPC` ุงููู ุจููุฒู ูุน ุฃู ุญุณุงุจ ุฌุฏูุฏุ ุจูููู ูุชุฑูุจูู `IGW` ุฌุงูุฒ. ููู ูู ุฃูุช ุงููู ุนููุช `Custom VPC`ุ ูู ุจููุฒู ููููู ูููุนุฒูุ ูุฃูุช ูุงุฒู ุชุนูู `IGW` ูุชุฑูุจู ุนููู ุจููุณู.

> [!TIP]
> `AWS` ุตููุช ุงูุนูุงูุฉ ุจูู ุงูู `VPC` ูุงูู `IGW` ุชููู `one-to-one` (ูุงุญุฏ ููุงุญุฏ) ุนุดุงู ุชุจุณุท ุชุตููู ุงูุดุจูุฉ. ุจูุง ุฅู ุงูู `Internet Gateway` ููุณู `highly available` (ูุด ุจููุน) ู `horizontally scalable` (ุจูุชูุณุน ุฃูุชููุงุชูู)ุ ููููุด ุฃู ูุงูุฏุฉ ูููุฉ ูู ุฅูู ุชุฑูุจ ุฃูุชุฑ ูู ูุงุญุฏ. ูุฌูุฏ `IGW` ูุงุญุฏ ุจุณ ุจูุฎูู ุนูุฏู "ุจูุงุจุฉ ุฑุฆูุณูุฉ" ูุงุญุฏุฉ ููุฅูุชุฑูุชุ ูุฏู ุจูุณูู ุฅุฏุงุฑุฉ ุงูู `Route Tables` ูุงูุฃูุงู.

---

#### **2. `Route Table` - ูุชุญ ุงูุทุฑูู ููู `Subnet` ููู**

ูุฌุฑุฏ ูุฌูุฏ ุงูู `IGW` ูุด ููุงูุฉ. ูุงุฒู ูููู ููู `VPC Router` ุฅุฒุงู ูุณุชุฎุฏูู. ููุง ุจูุฌู ุฏูุฑ ุงูู `Route Table`. ูุธููุชู ููุฏูู ูู ุฅูู ูุญุฏุฏ ุฅุฐุง ูุงู ุงูู `Subnet` ููุชูุฉ ูุงุญุฏุฉ ููู ุทุฑูู ููุชูุญ ููุฅูุชุฑูุช ููุง ูุฃ.

**ุจูุดุชุบู ุฅุฒุงูุ**
ุจูุญุท ูุงุนุฏุฉ (`route`) ุฌูู ุงูู `Route Table` ุจุชููู:
`Destination: 0.0.0.0/0  -->  Target: igw-xxxxxxxx`

```mermaid
graph LR
 A[Private Subnet / VPC] -- Route: 0.0.0.0/0 --> B[Internet Gateway<br>igw-xxxxxxxx]
 B --> C[Internet]
```

ุงูุณุทุฑ ุฏู ูุนูุงู: "ูุง `VPC Router`ุ ุฃู `traffic` ุฑุงูุญ ูุฃู ุญุชุฉ ูู ุงูุฅูุชุฑูุชุ ูุฏููู ููู `Internet Gateway`".

ููุง ุจุชุฑุจุท ุงูู `Route Table` ุฏู ุจู `subnet` ูุนููุ ุฃูุช ูุฏู ุญููุช ุนูู ุงูู `subnet` ุฏู ุจุฅูู ุจูู **`public subnet`**. ูุนูู ุจูู ุนูุฏู "ูุณุงุฑ" ููุฏุฑ ููุตู ููู ููุฅูุชุฑูุช ููุณุชูุจู ููู.

**ุจุตุฑูุญ ุงูุนุจุงุฑุฉ:** ุงูู `Route Table` ูู ุงููู **ุจูููุฑ ุงููุณุงุฑ**ุ ูุด ูู ุงููู ุจูุฎูู ุงูู `instance` `public`.

---

#### **3. `Public IP` ูุงูู `ENI` - ุฅุนุทุงุก ุนููุงู ููู `Instance` ุนูู ุงูุทุฑูู**

ุฏูููุชู ุงูุทุฑูู ุจูู ููุชูุญ ููู `subnet` ูููุ ุจุณ ุงูู `traffic` ุงููู ุฌุงู ูู ุจุฑู ูุญุชุงุฌ ูุนุฑู ููุฑูุญ ูุฃููู `instance` ุจุงูุธุจุท. ูููุง ุจูุฌู ุฏูุฑ **ุงูู `Public IP`** ุงููู ุจูุชู assign ููู **`ENI`** ุจุชุงุน ุงูู `instance`.

**ูุธููุชู:** ูุดุชุบู ูู "ุนููุงู" ููู `ENI` ุจุชุงุนู ุนูู ุงูุฅูุชุฑูุช. ูู ุงููู ุจูุฎูู `ENI` ูุนูู ูุงุจู ูููุตูู ูู ุงูุนุงูู ุงูุฎุงุฑุฌู.

**ุจูุดุชุบู ุฅุฒุงูุ**
ุงูู `Public IP` ุฏู ูุด `IP` ุญูููู ุฑุงูุจ ุนูู ุงูู `ENI` ุจุชุงุนูุ ูู ูุฌุฑุฏ **`1-to-1 NAT`** ุจูุญุตู ุฌูู ุงูู `Internet Gateway` ูู ุฏุฎูุช ุนูู ec2 ูุชูุงููู ูุด ุดุงููุงู ุชูุงู ูู ุดุงููุฉ ุจุณ private

*   ุฃูุง ูู `NAT Gateway`ุ ุจูุญุตู ูุง ูุณูู `many-to-one nating`ุ ูุฏู ูุตุฉ ุชุงููุฉุ ุจุณ ุฎููู ูุงูุฑ ุฅู ุงูู `EC2` ูุชุนุฑูุด ุฃู ุญุงุฌุฉ ุชูุงููุง ุนู ุงูู `Public IP` ุจุชุงุนูุง. ุงูู `traffic` ุจููุตููุง ุจุงูู `Private IP` ุจุชุงุนูุงุ ููู ูุด ุจุชุดูู ุงูู `IP` ุงููุนูู ุจุชุงุน ุงููุณุชุฎุฏู ุงููู ุทูุจูุง.

![Static NAT - Part 1](https://www.firewall.cx/images/stories/nat-static-part1-1.gif)

ููุง ุจุชุฏู `public IP` ูู `ENI`ุ ุฃูุช ุจุชุฏู ุฃูุฑ ููู `Internet Gateway` ูุนูู `mapping` ุจูู ุงูู `Public IP` ุฏู ูุงูู `Private IP` ุจุชุงุน ุงูู `ENI`. ุฃู `traffic` ูุฌููู ุนูู ุงูู `Public IP`ุ ูู ุจูุชุฑุฌูู ููุจุนุชู ููู `Private IP`ุ ูุงูุนูุณ.

**ููู ุงููู ุจูุนูู `assign` ููุญุงูุฉ ุงูู `Public`ุ**
ุฃูุช ุงููู ุจุชุนูู ูุฏู ููุง ุจุชุฎุชุงุฑ **`Enable Auto-assign public IP`**. ุจุงุฎุชูุงุฑู ุฏูุ ุฃูุช ุจุชุทูุจ ูู `AWS` ุฅููุง ุชุนูู ุงูู `NAT mapping` ุฏู ููู `ENI` ุจุชุงุน ุงูู `instance` ุจุชุงุนุชู. **ุฅุฐูุงุ ุชุฎุตูุต ุงูู `Public IP` ููู `ENI` ูู ุงููุนู ุงููู ุจูุญูู ุงูู `instance` ูู `private` ูู `public`**.

**ุงูุฏููู ุงููุงุทุน:**
ูู ุนููุช `SSH` ุฌูู ุงูู `instance` ูุดุบูุช ุฃูุฑ ุฒู `ip address show`ุ **ูุณุชุญูู ูุชูุงูู ุงูู `Public IP` ูุนุฑูุถ**. ูุธุงู ุงูุชุดุบูู ููุณู ูุด ุดุงููู ููุด ุนุงุฑู ุนูู ุฃู ุญุงุฌุฉ. ูู ูุด ุจูุดูู ุบูุฑ ุงูู `Private IP` ุงููู ุนูู ุงูู `ENI` ุจุชุงุนู. ุงููู ุจูุนุฑู ุงูู `Public IP` ูู ุงูู `Internet Gateway` ุจุณ.

> [!IMPORTANT]
>
> 
>
> **ููุญูุธุฉ ูููุฉ: `map_public_ip_on_launch` ูู ูุฌุฑุฏ ุฅุนุฏุงุฏ ุงูุชุฑุงุถู ููู `Subnet`**
>
> ูุด ุดุฑุท ูุงูุช ุจุชุจูู `public subnet` ูุชุฎูู `map_public_ip_on_launch = true` ุฅู ูู `EC2 instance` ูุชุชุนูู ุฌูุงู **ุฅุฌุจุงุฑู** ูููู ุนูุฏูุง `public IP`. ุงูุณุทุฑ ุฏู ุบูุท ููููู ุนูู ุฅูู ูุงุนุฏุฉ ุตุงุฑูุฉุ ูู ูุฌุฑุฏ **"ุฅุนุฏุงุฏ ุงูุชุฑุงุถู" (`default setting`)** ููู `subnet` ุฏู.
>
> > ```terraform
> > resource "aws_subnet" "public_subnet_a" {
> > # ...
> > map_public_ip_on_launch = true 
> > # ...
> > }
> > 
> > 
> > ```
> >
>
>
> ูุนูู ุงูุณุทุฑ ุฏู ูู: "ูุง `subnet`ุ ุฃู `EC2 instance` ุชุชุนูู ุฌูุงู **ูู ุบูุฑ ูุง ุชุญุฏุฏููุง ุตุฑุงุญุฉ** ุชุงุฎุฏ `public IP` ููุง ูุฃุ ุงุฏููุง ูุงุญุฏ ุจุดูู ุชููุงุฆู".
>
> **ููููุ ุฃูุช ูู `engineer` ููู ุงููููุฉ ุงูุฃุฎูุฑุฉ** ูุฃูุช ุจุชุนูู ุงูู `EC2 instance` ููุณูุง. ุจุชูุฏุฑ ุชุนูู `override` ููุฅุนุฏุงุฏ ุงูุงูุชุฑุงุถู ุฏู ุจุณูููุฉ ุฌุฏูุง ูู ุงูู `resource` ุจุชุงุน `aws_instance`.
>
> > ```terraform
> > resource "aws_instance" "my_secret_server" {
> > ami           = "ami-xxxxxxxx"
> > instance_type = "t2.micro"
> > 
> > subnet_id     = aws_subnet.public_subnet_a.id 
> > associate_public_ip_address = false 
> > }
> > ```
>
> ุจุงูุฑุบู ูู ุฅู ุงูู `instance` ุฏู (`my_secret_server`) ูุงุนุฏุฉ ุฌูู `public subnet` ุงูู `default` ุจุชุงุนู ุฅูู ูุฏู `public IPs`ุ ุฅูุง ุฅููุง ูุชุชููุฏ ููู **`private` ุชูุงููุง** ููุนูุฏูุงุด ุฃู `public IP` ููุด ูุชุนุฑู ุชุทูุน ุนู ุทุฑูู internet gateway
>
> **ูู ุงุฎุฑ**
> ุฎุงุตูุฉ `map_public_ip_on_launch` ูู ุงูู `subnet` ุจุชุชุญูู ูู "ุงูุณููู ุงูุชููุงุฆู"ุ ููู ุฎุงุตูุฉ `associate_public_ip_address` ูู ุงูู `instance` ูู ุงููู ูููุง **ุงููุฑุงุฑ ุงูููุงุฆู**. ุฏู ุจูุฏููู ูุฑููุฉ ุนุงููุฉ ุฌุฏูุง ูู ุฅูู ุชุญุท ุฃููุงุน ูุฎุชููุฉ ูู ุงูุณูุฑูุฑุงุช ( `public` ู `private`) ุฌูู ููุณ ุงูู `public subnet` ูู ุงูู `design` ุจุชุงุนู ุงุญุชุงุฌ ูุฏู.
>
> ูููู ุชุธู ุฅู ููุฑุฉ ุฅูู ุชุญุท instance   ุชููู private ุฌูู subnet ุชููู public ุฏู ุณููุงุฑูู ูุณุชุญูู ูุญุตู ุฃู ูุงููุด ูุงุฒูุฉุ ููู ูู ุงุดุชุบูุช ุนูู ุณูุฑูุฑุงุช ุฃูุนุงุจ ูุจู ูุฏู ูุชุนุฑู ุฅู ุงูู latency ุจูููู ูุงุชู. ูู ุงูุญุงูุงุช ุฏูุ ุจูุณุชุฎุฏู ุฎุงุตูุฉ ูู AWS ุงุณููุง **Placement Group** ูุจูุฏูููุง ูููุฉ ุงุณููุง **cluster**. ุงูุฎุงุตูุฉ ุฏู ุจุชุฌุจุฑ AWS ุฅููุง ุชุญุท ูู ุงูู EC2 instances ูู ููุณ ุงูู rack ุนุดุงู ูุจููุง ูุฑูุจูู ุฌุฏูุง ูู ุจุนุถ ูุงูุงุชุตุงู ุจูููู ูุจูู ูุงุฆู ุงูุณุฑุนุฉ. ููู ุงูููุฏ ุจุชุงุนูุง ุฅู ูู ุงูู instances ุฏู ูุงุฒู ุชููู ูู ููุณ ุงูู subnet.
>
> ูููุง ุจุชุธูุฑ ุงููุดููุฉ: ุฃูุง ุนุงูุฒ ุงูู database ุจุชุงุนุชู ุชููู private ุนุดุงู ุงูุฃูุงูุ ูุจุงูู ุณูุฑูุฑุงุช ุงููุนุจุฉ ุชููู public ุนุดุงู ุงููุงุนุจูู ููุตููููุงุ ููู ููุณ ุงูููุช ุนุงูุฒูู ูููู ูู ููุณ ุงูู subnet ุนุดุงู ุงูุฃุฏุงุก.
>
> ูููุง ุจูู ุจูุจุงู ุงูุฏูุฑ ุงูุญูููู ูููุงุนุฏุฉ ุงููู ุจุชููู "ุงูู Subnet ุจูุจูู public ุจุณุจุจ ุงูู Route Tableุ ููู ุงูู Instance ุจุชุจูู public ุจุณุจุจ ุงู- Public IP". ุงูุญู ูู ุฅููุง ุจูุจูู public subnet ูุงุญุฏ ุจุณุ ูุจูุญุท ุฌูุงู ูู ุงูุณูุฑูุฑุงุช ุจุชุงุนุชูุง ูู ููุณ ุงูู placement group. ุณูุฑูุฑุงุช ุงููุนุจุฉ ุจูุฏูููุง public IP (associate_public_ip_address = true) ุนุดุงู ุชุจูู ูุชุงุญุฉ ููุงุนุจูู. ุฃูุง ุณูุฑูุฑ ุงูู Databaseุ ูุจูุญุทู ูู ููุณ ุงูู subnet ูููุณ ุงูู placement groupุ ููู ุจูุฌุจุฑู ุฅูู **ููุฎุฏุด public IP** (associate_public_ip_address = false).
>
> ุจุงูุทุฑููุฉ ุฏูุ ุจูููู ุญูููุง ุงููุฏููู ุงููู ูุงููุง ุนูุณ ุจุนุถ: ูู ุงูุณูุฑูุฑุงุช ูุงุนุฏุฉ ุฌูุจ ุจุนุถ ูุงูู latency ุจูููู ุดุจู ูุนุฏููุ ููู ููุณ ุงูููุช ุณูุฑูุฑ ุงูู Database ุจูู private ููุณุชุญูู ุญุฏ ููุตูู ูู ุงูุฅูุชุฑูุชุ ุจุงูุฑุบู ูู ุฅูู ูุงุนุฏ ูู subnet ุทุฑููู ููุชูุญ ููุนุงูู ุงูุฎุงุฑุฌู.





> [!CAUTION]
>
> ูู ุฎุจุฑ ุณุงุฑ ููู>>>> ูููุด internet Gateway ูู ipv6 
> ูุด ุนุงุฑู ููู aws ูุณูู ุดููุฉ ูู ูุซุฑ ุงูุชุณูููุงุช ุงููู ุนูููุง ูููุณุชุฎุฏููู ุนุดุงู ูููููุง ipv6 ููููุด ูุงูุฏุฉ ูู ูุงุณู ipv4
>
> ![ุตูุฑุฉ 8 ูู ูููู ุฅุณูุงุนูู ูุณ ูู ุงูุฃุณุทูู - ุงูุฏูููุฒ - ูุงุนุฏุฉ ุจูุงูุงุช ุงููู ุงูุนุฑุจู  ูุงูููุงููู](https://media.dhliz.com/ismail_yassine_fel_ostool/00_19_53_00_17.jpg)





---

## **`Route Tables` **

ุนุดุงู ุชุชุญูู ูู ุฅุฒุงู ุงูู `traffic` ุจูุฏุฎู (`ingresses`) ูุจูุฎุฑุฌ (`egresses`) ูุจูุชุญุฑู ุฌูู ุงูู `VPC` ุจุชุงุนูุ ุฃูุช ูุญุชุงุฌ ุชุณุชุฎุฏู `routes` ูุชุฎุฒูุฉ ูู ุญุงุฌุฉ ุงุณููุง **`route tables`**. ุจุฏู ูุง ุชุณุชุฎุฏู `routers` ููุฒูุงุฆูุฉ ุฃู ุงูุชุฑุงุถูุฉ ุฃูุช ุงููู ุจุชุนูููุง `configure`ุ ุงูู `architecture` ุจุชุงุนุฉ ุงูู `VPC` ุจุชุทุจู ุงูู `IP routing` (ุชูุฌูู ุงูู `IP`) ูู `software function` `AWS` ุจุชุณูููุง **`implied router`** ูุณุงุนุงุช ุจูุณููู `implicit router`.

ุฏู ูุนูุงู ุฅูู **ูููุด `virtual router` ุญูููู** ุชูุฏุฑ ุชุฎุด ุนููู ูุชุนูู `configure` ููู `interface IP addresses` ุจุชุงุนุชู ุฃู ุชุดุบู ุนููู `dynamic routing protocols` ุฒู ุงูู `BGP`. ุจุฏู ูู ุฏูุ ูู ุงููู ุนููู ุชุนููู ูู ุฅูู ุชุฏูุฑ ุงูู `route table` ุงููู ุงูู `implied router` ุฏู ุจูุณุชุฎุฏูู ุนุดุงู ูุงุฎุฏ ูุฑุงุฑุงุชู.

ูู `route table` ุจูุชููู ูู `route` ูุงุญุฏ ุฃู ุฃูุชุฑุ ููุงุฒู ูููู ูุฑุจูุท ุนูู ุงูุฃูู ุจู `subnet` ูุงุญุฏ (`subnet association`). ููุฑ ูู ุงูู `route table` ุนูู ุฅูู ูุชูุตู ุจูุฐุง `subnet` ุจููุณ ุงูุทุฑููุฉ ุงููู ุงูุฑุงูุชุฑ ุงูุชูููุฏู ุจูุจูู ูุชูุตู ุจููุง.

ููุง ุจุชุนูู `VPC`ุ `AWS` ุจุดูู ุฃูุชููุงุชููู ุจุชุนูู `default route table` (ุฌุฏูู ุชูุฌูู ุงูุชุฑุงุถู) ูุจุชุณููู **`main route table`** ูุจุชุฑุจุทู ุจูู `subnet` ูู ุงูู `VPC` ุฏู. ุฃูุช ูููู ุชุณุชุฎุฏู ุงูู `main route table` ุฏูุ ุฃู ุชุนูู `custom` `route table` (ุฌุฏูู ูุฎุตุต) ุฃูุช ุงููู ุจุชุฑุจุทู ุจููุณู ูุจุดูู ูุฏูู ุจู `subnet` ูุงุญุฏ ุฃู ุฃูุชุฑ.

**ุงูู `subnet` ููููุนุด ูููู ููุฌูุฏ ูู ุบูุฑ ูุง ูููู ูุฑุจูุท ุจู `route table` (`route table association`)**. ูู ุฃูุช ูุนููุชุด ุฑุจุท ุตุฑูุญ (`explicitly associate`) ูู `subnet` ูุนูู ุจู `custom route table` ุฃูุช ุนุงูููุ `AWS` ูุชุฑุจุทู ุจุดูู ุถููู (`implicitly associate`) ุจุงูู `main route table`.



---

### **`Routes`**

ุงูู `Routes` ูู ุงููู ุจุชุญุฏุฏ ุฅุฒุงู ููุฌู ุงูู `traffic` ุงููู ุฑุงูุญ ุฃู ุฌุงู ูู ุงูู `resources` ุงููู ุฌูู ุงูู `subnets` ุงููุฑุชุจุทุฉ ุจุงูู `route table`. ุงูู `IP routing` ุจูุนุชูุฏ ุนูู ุงููุฌูุฉ (`destination-based`)ุ ูุฏู ูุนูุงู ุฅู ูุฑุงุฑุงุช ุงูุชูุฌูู ุจุชุชุงุฎุฏ ุจูุงุกู ุนูู ุงูู `destination IP prefix` (ุนููุงู ุงููุฌูุฉ) ุจุณุ ููุด ุจุชุจุต ุฎุงูุต ุนูู ุงูู `source IP address` (ุนููุงู ุงููุตุฏุฑ).

ููุง ุจุชูุฌู ุชุนูู `route` ุฌุฏูุฏุ ูุงุฒู ุชุญุฏุฏ ุงูุนูุตุฑูู ุฏูู:
*   **`Destination IP prefix`**: ูุฌูุฉ ุงูู `IP`.
*   **`Target resource`**: ุงูู `resource` ุงููุฏู.

ุงูู `Destination` ูุงุฒู ูููู `IPv4` ุฃู `IPv6 prefix` ููุชูุจ ุจุตูุบุฉ `CIDR`. ุฃูุง ุงูู `Target` ููุงุฒู ูููู `AWS network resource` ุฒู `Internet gateway` ุฃู `ENI`. ููููุนุด ูููู `IP prefix`.

ูู `route table` ุจูููู ุฌูุงู `local route`ุจุชุณูุญ ููู `instances` ุงููู ูู `subnets` ูุฎุชููุฉ ุฅููุง ุชููู ุจุนุถ. ุฌุฏูู 4.2 ุจููุฑูู ุดูู ุงูู `route` ุฏู ูู `VPC` ุงูู `CIDR` ุจุชุงุนู `172.31.0.0/16`.

**ุฌุฏูู 4.2: ุงูู `local route`**
| `Destination`   | `Target` |
| :-------------- | :------- |
| `172.31.0.0/16` | `Local`  |

ุงูู `local route` ุฏู ูู ุงูู `route` ุงูุฅุฌุจุงุฑู ุงููุญูุฏ ุงููู ููุฌูุฏ ูู ูู `route table`. ููู ุฏู ุงููู ุจูุณูุญ ุจุงูุงุชุตุงู ุจูู ุงูู `instances` ูู ููุณ ุงูู `VPC`. ูุจูุง ุฅูู ูููุด `routes` ูุฃู `IP prefixes` ุชุงููุฉุ ูุฃู `traffic` ุฑุงูุญ ูุฃู ุนููุงู ุจุฑู ุงูู `VPC CIDR range` ููุชู ุฅุณูุงุทู (`dropped`).

#### **ุงูู `Default Route` (ูุงุนุฏุฉ ุงูุชูุฌูู ุงูุงูุชุฑุงุถูุฉ)**

ุนุดุงู ุชููู ุงููุตูู ููุฅูุชุฑูุช ููู `instances` ุจุชุงุนุชูุ ูุงุฒู ุชุนูู `default route` ุจูุดุงูุฑ ุนูู ุงูู `Internet gateway`. ุงูู `default route` ูู ุงููู ุจูุณูุญ ููู `traffic` ุจุชุงุน ุงูุฅูุชุฑูุช ุฅูู ูุฏุฎู ููุฎุฑุฌ ูู ุงูู `subnet`. ุจุนุฏ ูุง ุชุถูู `default route`ุ ูููุชูู ุจูู ุงูุญุงู ุจุงูุฌุฏูู ุงููู ูู ุดูู 4.3.

**ุฌุฏูู 4.3: `Route table` ููู `default route`**
| `Destination` (ุงููุฌูุฉ) | `Target` (ุงููุฏู)        |
| :--------------------- | :---------------------- |
| `172.31.0.0/16`        | `Local`                 |
| `0.0.0.0/0`            | `igw-0e538022a0fddc318` |

ุงูู `prefix` ุงููู ูู `0.0.0.0/0` ุจูุดูู ูู ุนูุงููู ุงูู `IP` ุงูููููุฉุ ุจูุง ูููู ุงูุนูุงููู ุงููู ุนูู ุงูุฅูุชุฑูุช. ูุนุดุงู ูุฏู ุฏุงูููุง ุจููุงููู ูู ุงูู `destination` ูู ุฃู `default route`. ุฃู `subnet` ุจูููู ูุฑุจูุท ุจู `route table` ุฌูุงู `route` ุจูุดุงูุฑ ุนูู `Internet gateway`ุ ุจูุณููู **`public subnet`**. ูุฏู ุนูุณ ุงูู **`private subnet`**ุ ุงููู ูุนูุฏููุด `route` ุงููุฏู ุจุชุงุนู ูู `Internet gateway`.

ูุงุญุธ ุฅู ุงูู `prefixes` `0.0.0.0/0` ู `172.31.0.0/16` ูุชุฏุงุฎููู (`overlap`). ููุง ุงูู `implied router` ุจูุฌู ููุฑุฑ ูููุฌู ุงูู `traffic` ูููุ ูู ุจููุฌู ุจูุงุกู ุนูู **ุงูุชุทุงุจู ุงูุฃุฏู (`closest match`)**. ุจูุนูู ุขุฎุฑุ ุชุฑุชูุจ ุงูู `routes` ูู ุงูุฌุฏูู ูุด ููู.

ุงูุชุฑุถ ุฅู `instance` ุจุนุชุช `packet` ูุนููุงู ุนูู ุงูุฅูุชุฑูุช ุฒู `198.51.100.50`. ุจูุง ุฅู `198.51.100.50` ูุด ุจูุทุงุจู ุงูู `prefix` `172.31.0.0/16` ูููู ุจูุทุงุจู ุงูู `prefix` `0.0.0.0/0`ุ ุงูู `implied router` ููุณุชุฎุฏู ุงูู `default route` ูููุจุนุช ุงูู `packet` ููู `Internet gateway`.

ุงูู `documentation` ุจุชุงุนุฉ `AWS` ุจุชุชููู ุนู ูุฌูุฏ `implied router` ูุงุญุฏ ููู `VPC`. ููู ุชููู ุฅู ุงูู `implied router` ุฏู ูุด ููุฌูุฏ ูุนููุง ูู `resource` ูููุตู. ูู ูุฌุฑุฏ `abstraction` ููุธููุฉ ุงูู `IP routing`. ููุน ุฐููุ ูููู ูููู ูููุฏ ููู ุฅูู ุชููุฑ ูู ูู `route table` ุนูู ุฅูู `virtual router` ูููุตู ููุชูุตู ุจู `subnet` ูุงุญุฏ ุฃู ุฃูุชุฑ. ุงุชุจุน ุงูุฎุทูุงุช ุงููู ูู `Exercise 4.4` ุนุดุงู ุชุนูู `Internet gateway` ู `default route`.

> [!IMPORTANT]
>
>
> ููุญูุธุฉ ูุงูุฉ: ูุงุนุฏุฉ ุงูู `Longest Prefix Match` - ุฅุฒุงู ุงูู `Router` ุจูููุฑ**
>
> ุงูู `VPC Router` ุจูุญุฏุฏ ูุณุงุฑ ุงูู `traffic` ุจูุงุกู ุนูู ุงูู `Route Table`ุ ููู ุฅูู ุงููู ุจูุญุตู ูู ุงูู `traffic` ุฏู ุจูุทุงุจู ุฃูุชุฑ ูู `route` ูู ููุณ ุงูุฌุฏููุ
>
> **ุงููุดููุฉ:**
> ุชุฎูู `Route Table` ุจุงูููุธุฑ ุฏู:
>
> > ```
> > Destination        Target
> > ------------------------------------
> > 10.0.0.0/16        local
> > 0.0.0.0/0          igw-xxxxxxxx
> > ```
>
> ูู `instance` ุจุนุชุช `packet` ูู `IP` ุฒู `10.0.1.50`ุ ุงูู `IP` ุฏู ุจููุน ุฌูู ุงูู `range` ุจุชุงุน `10.0.0.0/16` ููู ููุณ ุงูููุช ุจููุน ุฌูู `0.0.0.0/0`. ุทุจ ุงูู `Router` ููุฎุชุงุฑ ุฃููู ุทุฑููุ
>
> **ุงูุญู: ูุงุนุฏุฉ ุงูู `Longest Prefix Match` (ุงูุชุทุงุจู ูุน ุงูู `Prefix` ุงูุฃุทูู)**
>
> ุงููุงุนุฏุฉ ุฏู ูู ุฃุณุงุณ ุดุบู ูู ุงูู `routers` ูู ุงูุนุงููุ ูุจุชููู:
>
> **"ููุง ูููู ููู ุฃูุชุฑ ูู `route` ุจูุทุงุจู ููุณ ุงููุฌูุฉุ ุงูู `Router` ุฏุงููุงู ุจูุฎุชุงุฑ ุงูู `route` ุตุงุญุจ ุงูู `prefix` ุงูุฃุทูู (ูุนูู ุงูุฑูู ุงููู ุจุนุฏ ุงูู `/` ูููู ุฃูุจุฑ)ุ ูุฃูู ุจูููู ูู ุงููุณุงุฑ ุงูุฃุฏู ูุงูุฃูุซุฑ ุชุญุฏูุฏูุง."**
>
> **ุชุทุจูู ุงููุงุนุฏุฉ:**
>
> *   **ูู ุงูู `Packet` ุฑุงูุญ ูู `10.0.1.50`:**
>     *   ุจูุทุงุจู `10.0.0.0/16` (ุทูู ุงูู `prefix` ูู **16**).
>     *   ุจูุทุงุจู `0.0.0.0/0` (ุทูู ุงูู `prefix` ูู **0**).
>     *   **ุงููุฑุงุฑ:** ุจูุง ุฅู 16 > 0ุ ุงูู `Router` ููุฎุชุงุฑ ุงููุณุงุฑ ุงูุฃุฏู ููููุฌู ุงูู `traffic` ูู `local`.
>
> *   **ูู ุงูู `Packet` ุฑุงูุญ ูู `8.8.8.8` (ุฌูุฌู):**
>     *   ุจูุทุงุจู `0.0.0.0/0` ุจุณ.
>     *   **ุงููุฑุงุฑ:** ุงูู `Router` ููุฎุชุงุฑ ุงููุณุงุฑ ุฏู ููููุฌู ุงูู `traffic` ููู `Internet Gateway`.
>
> **ูุซุงู ูุชูุฏู ููุถุญ ููุฉ ุงููุงุนุฏุฉ:**
>
> ูู ุถููุง `route` ุชุงูุช ููุฌุฏูู ุจุชุงุนูุง ุนุดุงู ูููู `VPC` ุชุงูู ุนู ุทุฑูู `VPC Peering`:
>
> ```
> Destination                  Target
> ----------------------------------------------------
> 10.0.1.0/24                  pcx-yyyyyyyy  (VPC Peering)
> 10.0.0.0/16                  local
> 0.0.0.0/0                    igw-xxxxxxxx
> ```
>
> ุฏูููุชู ูู ุงูู `packet` ุฑุงูุญ ูููุณ ุงูู `IP` `10.0.1.50`:
>
> *   ุงูู `prefixes` ุงููุชุงุญุฉ ูู: `/24`ุ `/16`ุ `/0`.
> *   **ุงููุฑุงุฑ:** ุงูู `Router` ููุฎุชุงุฑ ุฃุทูู ูุงุญุฏ ููููุ ููู `/24`. ุฅุฐูุ ุงูู `traffic` ุงููุฑุฉ ุฏู ููุฑูุญ ููู `VPC Peering connection`ุ ูุฃูู ูู ุงููุณุงุฑ ุงูุฃูุซุฑ ุชุญุฏูุฏูุง.
>
>
> ุงูู `VPC Router` ูุด ุจูุฎุชุงุฑ ุฃูู `route` ููุงุจููุ ูู ุจูุฏูุฑ ุนูู **ุฃุฏู `route` ูุทุงุจู**. ุงููุงุนุฏุฉ ุฏู ูู ุงููู ุจุชุฏูู ุงูููุฉ ุฅูู ุชุนูู `routing` ูุนูุฏุ ูุชุนูู "ุงุณุชุซูุงุกุงุช" (`overrides`) ูููุงุนุฏ ุนุงูุฉ ุนู ุทุฑูู ุฅูู ุชุญุท ููุงุนุฏ ุชุงููุฉ ุฃูุซุฑ ุชุญุฏูุฏูุง.

ุชุนุงููุง ูุง ูุงุฎุฏ ุงูุงูุซูุฉ ููุฌุฑุจูุง ูุจู ูุง ูุฎุด ุนูู ุงูุฌุฒุก ุงููู ุจุนุฏู 

![0ddf30c6-c200-453f-a555-00cd500e02c1](assets/0ddf30c6-c200-453f-a555-00cd500e02c1.png)

ุฏูููุชู ุนุงูุฒ ุงุนูู vpc ุจูู ุจุณุงุทุฉ 

```terraform
resource "aws_vpc" "vpc_a" {
  cidr_block           = "10.15.0.0/16"
  enable_dns_support   = true
  enable_dns_hostnames = true

  tags = {
    Name = "VPC-A"
  }
}
```

ุฏูููุชู ููุนูู subnet

```terraform
resource "aws_subnet" "public_subnet" {
  vpc_id                  = aws_vpc.vpc_a.id
  cidr_block              = "10.0.1.0/24"
  availability_zone       = "eu-west-1a" 
  map_public_ip_on_launch = true 
  tags = {
    Name = "Public-Subnet-A"
  }
}
resource "aws_subnet" "private_subnet_a" {
  vpc_id            = aws_vpc.vpc_a.id
  cidr_block        = "10.0.2.0/24"
  availability_zone = "eu-west-1a" 

  tags = {
    Name = "Private-Subnet-A"
  }
}

```

ุฎูู ุจุงูู ูุด ุฏู ุงูุทุฑููุฉ ุงููู ูู ุงูุนุงุฏู ุจููุฏู ุจูู ุนูู availability_zone 

ูุซูุง ุงุดูุฑ ุดูู ูุซูุง 

``` 
data "aws_availability_zones" "AZs" {
  all_availability_zones = true
  state = "available"

}
output "just" {
  value = data.aws_availability_zones.AZs.names[0]
}
```

ููุง ุจุฏู ูุง ุงูุช ุชุนูุฒ ุชุบูุฑ region ูู ุดููุฉ ุชูุฌุน ุฏูุงุบู ุจุชุบููุฑ az ๏ปป ูุฏู ููุญุตู ุจุดูู ุชูุงูุงุฆู ูุงูุถู

```terraform
resource "aws_subnet" "public_subnet" {
  vpc_id                  = aws_vpc.vpc_a.id
  cidr_block              = "10.15.1.0/24"
  availability_zone = data.aws_availability_zones.AZs.names[0]
  map_public_ip_on_launch = true 
  tags = {
    Name = "Public-Subnet-A"
  }
}
resource "aws_subnet" "private_subnet_a" {
  vpc_id            = aws_vpc.vpc_a.id
  cidr_block        = "10.15.2.0/24"
  availability_zone =data.aws_availability_zones.AZs.names[0]

  tags = {
    Name = "Private-Subnet-A"
  }
}

```

ููู ุจุฑุถู ุทุฑููุฉ ุงูุถู ุจูุชูุฑ ูุชุนุงูู ูุน IP ุจุฏู ุดุบู ุงูุงูุฑุงุญ ุงููู ุงุญูุง ุจููุชุจู ูู ุญุจูุช ุชุบูุฑ ip ุงู ูุชุทุถุฑ ุชูู ุนูู ูู subnet ูุฏุง ูุฑุงุบ ูููุด ูุงุฒูุฉ 

ุจุชุณุชุฎุฏู cidrsubnet

```
cidrsubnet(base_cidr, newbits, netnum)

```

**`base_cidr`**

- ูู ุงูู CIDR ุงูุฃุณุงุณู ุงููู ูุชุจุฏุฃ ููู (ูุซูุงู `aws_vpc.vpc_a.cidr_block` ุงููู ูู `"10.15.0.0/16"`).

**`newbits`**

- ุนุฏุฏ ุงูู bits ุงูุฅุถุงููุฉ ุงููู ูุชุฒูุฏูุง ุนูู ุงูู prefix ุนูุดุงู ุชูุณูู ุงูุดุจูุฉ.
- ูุซุงู:
  - VPC `/16` ูุนูู ุฃูู 16 bit ุซุงุจุชุฉุ ูุงูุจุงูู ูุชุงุญ ููุชูุณูู.
  - ูู ุฃุถูุช **8 bits** (`newbits = 8`) โ ููุจูู `/24` (ูุฃู 16 + 8 = 24).
  - ุฏู ูุนูุงู ุฅู ูู subnet ูููุง 256 IP addresses (ูููู usable ุญูุงูู 254).

**`netnum`**

- ุฑูู ุงูุดุจูุฉ ุงููุฑุนูุฉ ุงููู ุนุงูุฒูุง.
- ุจุชุฑููู ูุจุฏุฃ ูู **0**ุ ูู ุฑูู ุจููููุฏ subnet ูุฎุชููุฉ.
- ูุซุงู ูุน `"10.15.0.0/16"` ู `newbits = 8`:
  - `netnum = 0` โ `10.15.0.0/24`
  - `netnum = 1` โ `10.15.1.0/24`
  - `netnum = 2` โ `10.15.2.0/24`
  - ูููุฐุง.

ูุซุงู

```
VPC 10.15.0.0/16 ุฅูู /24 subnets
cidrsubnet("10.15.0.0/16", 8, 0) โ 10.15.0.0/24
cidrsubnet("10.15.0.0/16", 8, 1) โ 10.15.1.0/24
cidrsubnet("10.15.0.0/16", 8, 2) โ 10.15.2.0/24
```





```terraform
resource "aws_subnet" "public_subnet_a" {
  vpc_id                  = aws_vpc.vpc_a.id
  cidr_block              = cidrsubnet(aws_vpc.vpc_a.cidr_block, 8, 0)
  availability_zone       = data.aws_availability_zones.AZs.names[0]
  map_public_ip_on_launch = true 
  tags = {
    Name = "Public-Subnet-A"
  }
}

resource "aws_subnet" "private_subnet_a" {
  vpc_id            = aws_vpc.vpc_a.id
  cidr_block        = cidrsubnet(aws_vpc.vpc_a.cidr_block, 8, 1)
  availability_zone = data.aws_availability_zones.AZs.names[0]
  tags = {
    Name = "Private-Subnet-A"
  }
}

```

ูุฑูุญ ุงูุดุงุก internet getway

```terraform
resource "aws_internet_gateway" "igw" {
  vpc_id = aws_vpc.vpc_a.id

  tags = {
    Name = "VPC-A-IGW"
  }
}
```



ุนุดุงู ูุณูุญ ููู `EC2 instances` ุงููู ูู ุงูู `public subnet` ุฅููุง ุชูุตู ููุฅูุชุฑูุชุ ุงูุนูููุฉ ุจุชุชู ุนูู ุฎุทูุชูู: ุงูุฃูู ุจูุจูู "ุงูุฎุฑูุทุฉ" (`Route Table`)ุ ูุจุนุฏูู ุจูููู ูุฃููู `subnet` ูุณุชุฎุฏู ุงูุฎุฑูุทุฉ ุฏู.

**`aws_route_table`**

ุจูุนูู `Route Table` ุฌุฏูุฏ ุจุงุณุชุฎุฏุงู ุงูู `resource` ุฏูุ ูุจูุญุท ุฌูุงู ุงููุงุนุฏุฉ ุงููู ุจุชูุชุญ ุงูุทุฑูู ููุฅูุชุฑูุช.

```terraform
resource "aws_route_table" "public_rt" {
  vpc_id = aws_vpc.vpc_a.id


  route {

    destination_cidr_block = "0.0.0.0/0"
    

    gateway_id             = aws_internet_gateway.igw.id
  }

  tags = {
    Name = "Public-Route-Table"
  }
}
```

ุงูููุฏ ุฏู ุจูุนูู `Route Table` ุฌุฏูุฏ ูุฌุงูุฒุ ููู ูุญุฏ ุฏูููุชู ูู ูุฌุฑุฏ "ุฎุฑูุทุฉ" ููุฌูุฏุฉ ูู ุงูุฏุฑุฌุ ููููุด ุฃู `subnet` ุจูุจุต ุนูููุง ุฃู ุจูุณุชุฎุฏููุง.

> **ููุญูุธุฉ ูุงูุฉ: ุงูู `Local Route` ุงูุถููู**
> ุฃูุช ููุงุญุธ ุฅููุง ููุชุจูุงุด ุฃู `route` ุนุดุงู ูุฎูู ุงูู `subnets` ุชููู ุจุนุถูุง ุฌูู ุงูู `VPC`ุ ุฏู ูุฃู ุงูู `route` ุฏู (`local route`) ุจูุชุนูู ุจุดูู ุฃูุชููุงุชููู ูุฅุฌุจุงุฑู ูู `AWS` ุฃูู ูุง ุจุชุนูู ุฃู `Route Table`ุ ููู ุงููู ุจูุถูู ุฅู ุงูู `traffic` ุฌูู ุงูู `VPC` ููุถู `local`.
>
> ุฏู ุตูุฑุฉ ุจุชูุฑูู ูุจู ูุง ุงูุดุงุก internet gateway ููุจู ูุง ุงุนูู ุงู ุญุงุฌุฉ ููุท 2 subnets ู vpc 
>
> ![image-20250815164236805](assets/image-20250815164236805.png)

---

**ุงูุฎุทูุฉ ุงูุซุงููุฉ (ุงูุฃูู): ุชุทุจูู routing table ุนูู ุงูู**

`Subnet` (`aws_route_table_association`)

ูููุง ุจูุฌู ุงูุฌุฒุก ุงููู ุฃูุช ุถูุชูุ ููู ุฏู ุงููู ุจูุฎูู ูู ุญุงุฌุฉ ุชุดุชุบู. ุจุนุฏ ูุง ุนูููุง ุงูู `Route Table`ุ ูุงุฒู `associate` ุจุงูู `subnet` ุงููู ุฅุญูุง ุนุงูุฒููู ูุจูู `public`.

```terraform
resource "aws_route_table_association" "public_assoc" {
  subnet_id      = aws_subnet.public_subnet.id
  route_table_id = aws_route_table.public_rt.id
}
```

ุงูู `resource` ุฏู ูู "ุงููุตูุฉ" ุฃู "ุงูุฑุงุจุท". ูู ุงููู ุจูููู ููู `VPC Router`:
**"ูู ุณูุญุชุ ุฃู `traffic` ุทุงูุน ูู ุงูู `public_subnet` ุฏู ุจุงูุฐุงุชุ ุฎููู ููุดู ุนูู ุงูููุงุนุฏ ุงููู ูู ุงูู `public_rt` ุฏู."**

ูู ุบูุฑ ุงูู `association` ุฏูุ ุงูู `public_subnet` ูููุถู ูุฑุชุจุท ุจุงูู `Main Route Table` ุงูุงูุชุฑุงุถู ุจุชุงุน ุงูู `VPC`ุ ุงููู ูู ุจุทุจูุนุชู ูุนูุฏูุด ุทุฑูู ููุฅูุชุฑูุชุ ูุจุงูุชุงูู ุงูู `subnet` ูููุถู `private` ููุด ููุนุฑู ูุทูุน ูุช. **ุฅุฐูุงุ ุงูู `association` ูู ุงููุนู ุงููู ุจูุญูู ุงูู `subnet` ูู `private`  ูู `public` ูุนูููุง.**

---

### **ุดูู ุงูู `Route Table` ุงูููุงุฆู ูู `AWS Console`**

ุจุนุฏ ูุง `Terraform` ุจูููุฐ ุงูููุฏูู ุฏูู ูุน ุจุนุถุ ูู ุฑูุญุช ูุชุญุช ุงูู `public_rt` ูู ุงูู `AWS Console`ุ ูุชูุงูู ุดููู ุจุงูุธุจุท ุนุงูู ูุฏู:

| `Destination`     | `Target`       |
| :---------------- | :------------- |
| **`10.0.0.0/16`** | **`local`**    |
| `0.0.0.0/0`       | `igw-xxxxxxxx` |

*   **ุงูุณุทุฑ ุงูุฃูู (`local route`):** ุฏู ุงููู `AWS` ุถุงูุชู ููุญุฏูุง.
*   **ุงูุณุทุฑ ุงูุชุงูู (`default route`):** ุฏู ุงููู ุฃูุช ุถูุชู ุจููุณู ูู `aws_route_table`.

ููู ุฑุญุช ุนูู ุชุงุจ ุงูู `Subnet Associations` ุจุชุงุน ููุณ ุงูู `Route Table`ุ ูุชูุงูู ุงูู `public_subnet` ุจุชุงุนู ูุฑุจูุท ุจูู.

![image-20250815171025177](assets/image-20250815171025177.png)

![image-20250815171114717](assets/image-20250815171114717.png)

---

> [!TIP]
>
> ููุญูุธุฉ: ููู  ุงูู`Routes`
>
> ุจุฌุงูุจ `Destination` ู `Target` ุงููู ุฃูุช ุจุชุชุญูู ููููุ ุงูู `Route Table` ุจูุนุฑุถ ุฃุนูุฏุฉ ุชุงููุฉ ูููุฉ ุจุชุฏููู ูุนูููุงุช ุนู ุญุงูุฉ ููุตุฏุฑ ูู `route`. ุงูุฃุนูุฏุฉ ุฏู ูููุฑุงุกุฉ ููุท (`read-only`) ูุฃูุช ูุด ุจุชุนุฏููุง ูุจุงุดุฑุฉุ ููููุง ุจุชุณุงุนุฏู ุชููู ุดุจูุชู ุดุบุงูุฉ ุฅุฒุงู:
>
> *   **`Status` (ุงูุญุงูุฉ):**
>     ุฏู ูุคุดุฑ ุตุญุฉ ุงูู `route`.
>     *   **`Active`:** ุจุชุฏู ุนูู ุฅู ุงูู `route` ุฏู ุณููู ูุงูู `target` ุจุชุงุนู (ุฒู ุงูู `IGW`) ููุฌูุฏ ูุดุบุงู ุญุงูููุง.
>     *   **`Blackhole`:** ุจุชุฏู ุนูู ุฅู ุงูู `route` ุฏู ุจุงูุธ. ุฏู ุจูุญุตู ููุง ุงูู `target` ุงููู ูุงู ุจูุดุงูุฑ ุนููู ูุชูุณุญ. ุฃู `traffic` ุจูุทุงุจู ุงูู `route` ุฏู ููุชู ุฅุณูุงุทู (`dropped`).
>
> *   **`Propagated`:**
>     ุฏู ุจููุถุญ ุฅุฐุง ูุงู ุงูู `route` ุฏู `static` ููุง `dynamic`.
>     *   **`No`:** ุจุชุฏู ุนูู ุฅู ุฏู `static route` ุฃูุช ุงููู ูุชุจุชู ุจููุณู ูุฏูููุง (ุณูุงุก ูู ุงูู `Console` ุฃู `Terraform`).
>     *   **`Yes`:** ุจุชุฏู ุนูู ุฅู ุฏู `dynamic route` ุงูู `VPC` ุจุชุงุนู ุงุชุนููู ุฃูุชููุงุชูู ูู ุดุจูุฉ ุชุงููุฉ (ุฒู ุดุจูุฉ ุดุฑูุชู) ุนู ุทุฑูู `VPN` ุฃู `Direct Connect` ุจุงุณุชุฎุฏุงู ุจุฑูุชูููู `BGP` ูุญุธ ุงู local
>
> *   **`Route Origin` (ุฃุตู ุงูู `Route`):**
>     ุฏู ุจููููู ุจุงูุธุจุท ุงูู `route` ุฏู ุงุชุนูู ุฅุฒุงู.
>     *   **`Create Route`:** ุจุชุฏู ุนูู ุฅูู ุฃูุช ุงููู ุนููุช ุงูู `route` ุฏู.
>     *   **`Create Route Table`:** ุจุชุฏู ุนูู ุฅู ุฏู ุงูู `local route` ุงููู `AWS` ุจุชุนููู ุฃูุชููุงุชูู ูุน ุฃู `Route Table` ุฌุฏูุฏ.
>     *   **`Enable VGW route propagation`:** ุจุชุฏู ุนูู ุฅู ุงูู `route` ุฏู ุฌุงู ูู ุงูู `BGP` ุนู ุทุฑูู ุงูู `Virtual Private Gateway`.
>
> ููู ุงูุฃุนูุฏุฉ ุฏู ุจูุณุงุนุฏู ุฌุฏูุง ูู ุงูู `troubleshooting` ุนุดุงู ุชุนุฑู ุจุณุฑุนุฉ ูู ุงูู `route` ุจุชุงุนู ุดุบุงูุ ููู ูู `static` ููุง ุฌุงู ูู ุดุจูุฉ ุชุงููุฉ.

> [!TIP]
>
> 
>
>
> ููุญูุธุฉ: ุฅุฒุงู ุงูู `VPC` "ุจูุชุนูู" `Routes` ุฃูุชููุงุชููุ (ููุฑุฉ ุงูู `Dynamic Routing`)**
>
> ููุฑุฉ ุฅู ุงูู `Route Table` "ูุชุนูู" `route` ุฌุฏูุฏ ููุญุฏู ุจุชูุฌู ูู ุนุงูู ุงูู `Dynamic Routing Protocols`ุ ูุฃุดูุฑูู ูู **`BGP (Border Gateway Protocol)`**. ุฏู ุงูุจุฑูุชูููู ุงููู ุงูุฅูุชุฑูุช ููู ูุงูู ุนูููุ ููู ุงููู ุจูุฎูู ุงูู `routers` ุชููู ุจุนุถูุง ูุชููู ูุจุนุถ "ุฃูุง ุฃุนุฑู ุฃูุตู ููุดุจูุงุช ุฏู".
>
> **ุฅูุชู ูุฃุฒุงู ุจุชุญุตู ูู `AWS`ุ**
>
> ุงูุญูุงูุฉ ุฏู ุจุชุญุตู ููุง ุจุชุฑุจุท ุงูู `VPC` ุจุชุงุนู ุจุดุจูุฉ ุชุงููุฉ ูุจูุฑุฉ (ุฒู ุดุจูุฉ ุดุฑูุชู `on-premises`) ุจุงุณุชุฎุฏุงู **`AWS Direct Connect`** ุฃู **`Site-to-Site VPN`** (ุงูููุน ุงูู `dynamic`).
>
> **ุงูุณููุงุฑูู ูุงูุชุงูู:**
>
> 1.  **ุจุชูุตู ุงูุดุจูุชูู:** ุจูููู ุนูุฏู `router` ูู ุดุฑูุชูุ ู `Virtual Private Gateway (VGW)` ุฃู `Transit Gateway (TGW)` ูู `AWS`.
> 2.  **ุจุชุดุบู `BGP`:** ุงูู `engineers` ุจุชูุน ุงูุดุจูุงุช ุจูุนูููุง `configure` ููู `BGP` ุจูู ุงูุฑุงูุชุฑ ุจุชุงุน ุงูุดุฑูุฉ ูุงูู `Gateway` ุจุชุงุน `AWS`.
> 3.  **ุงูุฑุงูุชุฑ ุจุชุงุน ุดุฑูุชู "ุจูุนูู" ุนู ุดุจูุงุชู (`Advertising Routes`):** ุงูุฑุงูุชุฑ ุจุชุงุนู ุจูุจุฏุฃ ูุจุนุช ุฑุณุงุฆู `BGP` ููู `Gateway` ุจุชุงุน `AWS` ูููููู:
>       "ุฃูุง ุงูุฑุงูุชุฑ ุจุชุงุน ุดุฑูุฉ Xุ ูุฏู ุงูุดุจูุงุช ุงููู ุชุญุช ุฅุฏุงุฑุชู ูุฃุนุฑู ุฃูุตููุง: `192.168.1.0/24`, `192.168.2.0/24`, ...ุฅูุฎ".
> 4.  **ุงูู `Gateway` ุจุชุงุน `AWS` "ุจูุชุนูู" ุงูู `Routes`:** ุงูู `Gateway` ุจูุณุชูุจู ุงูุฅุนูุงูุงุช ุฏู ู"ุจูุตุฏููุง"ุ ูุจูููู ุฅู ุนุดุงู ููุตู ููุดุจูุงุช ุฏูุ ูุงุฒู ูุฑูู ุงูู `traffic` ููุฑุงูุชุฑ ุจุชุงุน ุดุฑูุชู.
> 5.  **ุงูู `Gateway` "ุจููุดุฑ" ุงููู ุงุชุนููู (`Route Propagation`):**
>       ุฃูุช ุจุชุฑูุญ ุนูู ุงูู `Route Table` ุจุชุงุน ุงูู `subnet` ุงููู ุนุงูุฒ ุชููููุ ูุจุชูุนู ุฎุงุตูุฉ ุงุณููุง **`Route Propagation`** ูุจุชุฑุจุทูุง ุจุงูู `Gateway` ุฏู.
>       ุจูุฌุฑุฏ ูุง ุชุนูู ูุฏูุ ุงูู `Gateway` ุจูุฑูุญ **ูุฒุฑุน ุฃูุชููุงุชูู** ูู ุงูู `routes` ุงููู ูู ูุณู ูุชุนูููุง ุฏู ุฌูู ุงูู `Route Table` ุจุชุงุนู.
>
> ุจุชูุงูู ุงูู `Route Table` ุจุชุงุนู ุงุชููุง `routes` ุฌุฏูุฏุฉ ุฃูุช ููุชุจุชูุงุด ุจุฅูุฏูุ ูุฌูุจูุง ููุชูุจ **`Propagated: Yes`**. ุฏู ูู ุงูู `routes` ุงููู ุงูู `VPC` ุจุชุงุนู "ุงุชุนูููุง" ูู ุดุจูุฉ ุงูุดุฑูุฉ. ุงูุนูููุฉ ุฏู ุฏููุงููููุฉุ ูุนูู ูู ุงูู `network engineer` ูู ุดุฑูุชู ุถุงู ุดุจูุฉ ุฌุฏูุฏุฉุ ูู ูุชุธูุฑ ุฃูุชููุงุชูู ูู ุงูู `Route Table` ุจุชุงุนู ูู ุบูุฑ ุฃู ุชุฏุฎู ููู.
>
> ูุณู ููููู AWS Direct Connect ู ููููู Transit Gateway (TGW)



ูููู ูุญุท ec2 ูุญุท security group ูุฎูุงุต ูุจูุฏู ุชุจูู ุชูุงู 

```terraform
data "aws_ami" "amazon_linux_2" {
  most_recent = true
  owners      = ["amazon"]

  filter {
    name   = "name"
    values = ["amzn2-ami-hvm-*-x86_64-gp2"]
  }
}

resource "tls_private_key" "ssh_key" {
  algorithm = "ED25519"
}

resource "aws_key_pair" "ssh_key" {
  key_name   = "my_ssh_key_of_ec2"
  public_key = tls_private_key.ssh_key.public_key_openssh
}

resource "local_file" "ssh_key" {
  content         = tls_private_key.ssh_key.private_key_pem
  filename        = "${path.root}/my_ssh_key_of_ec2.pem"
  file_permission = "0400"
}


resource "aws_security_group" "sg_ssh" {
  vpc_id      = aws_vpc.vpc_a.id
  name        = "ssh_security_group"
  description = "Allow SSH access"

  ingress {
    from_port   = 22
    to_port     = 22
    protocol    = "tcp"
    cidr_blocks = ["0.0.0.0/0"]
  }

  egress {
    from_port   = 0
    to_port     = 0
    protocol    = "-1"
    cidr_blocks = ["0.0.0.0/0"]
  }
}

resource "aws_instance" "bastion_hosting" {
  ami                    = data.aws_ami.amazon_linux_2.id
  instance_type          = "t2.micro"
  key_name               = aws_key_pair.ssh_key.key_name
  subnet_id              = aws_subnet.public_subnet_a.id
  vpc_security_group_ids = [aws_security_group.sg_ssh.id]

  tags = {
    Name = "bastion hosting"
  }
}


resource "aws_instance" "private_instance" {
  ami                    = data.aws_ami.amazon_linux_2.id
  instance_type          = "t2.micro"
  key_name               = aws_key_pair.ssh_key.key_name
  subnet_id              = aws_subnet.private_subnet_a.id
  vpc_security_group_ids = [aws_security_group.sg_ssh.id]

  tags = {
    Name = "private instance"
  }
}

```

ุทูุจุ ุฏูููุชู ุนุดุงู ูุนูู access ููู EC2 instance ุงููู ูู privateุ ุงูุทุฑููุฉ ุงููู ูููู ุชูุฌู ูู ุฏูุงุบ ุฃู ุญุฏ ูู ุฅูู ูุนูู SSH ุนูู ุฎุทูุชูู: ูุฑุฉ ูู ุฌูุงุฒู ููู bastion_host ุ ูุจุนุฏ ูุง ูุฎุด ุฌูุงูุ ูุฑูุญ ุนุงูู SSH ูุฑุฉ ุชุงููุฉ ููู ููู private_instance .

ุงูุทุฑููุฉ ุฏู ุจุชุดุชุบูุ ููููุง ูุด ุนูููุฉ ุฎุงูุต (clunky) ูุจุชุญุชุงุฌ ุชููู ุงูู private key ุจุชุงุนู ูุชุญุทู ุนูู ุงูู bastion_hostุ ูุฏู ุชุนุชุจุฑ bad security practice.

**ุงูุญู ุงูุฃูุถู ูุงูุฃูุซุฑ ุณูุงุณุฉ ูู ุฅููุง ูุณุชุฎุฏู SSH Tunnel.**

![How to Use SSH Tunneling to Access Restricted Servers](https://cdn.shortpixel.ai/spai/q_lossy+ret_img+to_auto/linuxiac.com/wp-content/uploads/2020/06/ssh_tunnel1.jpg)

ุงูุตูุฑุฉ ุฏู ุจุชูุถุญ ููุฑุฉ ุงูู SSH Tunnel ุจุดูู ููุชุงุฒุ ูุนุดุงู ูููููุง ุตุญุ ุฎูููุง ูุทุจููุง ุนูู ุงูู use case ุจุชุงุนูุง ูู AWS. ุชุฎูู ุฅู ุงูู **Blue Server** ูู ุฌูุงุฒู ุ ูุงูู **Red Server** ูู ุงูู Bastion Host ุงููู ููุฌูุฏ ูู ุงูู Public Subnetุ ูุงูู **Green Server** ูู ุงูู Private Instance ุงููู ุนุงูุฒูู ููุตููุง ูู ุงูู Private Subnet.

ุงูุนูููุฉ ูููุง ุจุชุจุฏุฃ ููุง ุจุชุดุบู ุฃูุฑ SSH ูู ุฌูุงุฒู ุงููุญูู ุนุดุงู ุชูุชุญ tunnel ุขูู ููุดูุฑ ูุน ุงูู Bastion Host ุนูู port 22. ููู ุงูุฃูุฑ ุฏู ูุด ูุฌุฑุฏ SSH ุนุงุฏูุ ุฅุญูุง ุจูุถูู ุฌูุงู ุฎุงุตูุฉ Local Port Forwardingุ ูุฏู ุจุชุนูู ุญุงุฌุชูู: ุจุชูุชุญ port  ุนูู ุฌูุงุฒู ุฃูุช (ูู ุงูุตูุฑุฉ port 8080)ุ ูุจุชุฑุจุท ุงูู port ุฏู ุจู target ุจู port 80 ุจูGreen server ุฌูู ุดุจูุฉ AWS ุจุญูุซ ููุง ุทูุจ ูุทูุน ุนูู port 80 ูู ุฌูุงุฒู ุงููู ูู blue ูุชุญุฑู ุนูู ssh tunnel  ูุจุนุฏู ssh service ุนูู red server ูุชูุฌู ูููGreen Server ูุฃู port 8080  ูู ุจุฒุจุท port 80 ุนูู red server

ุจุนุฏ ูุง ุงูู tunnel ุฏู ูุชูุชุญุ ุฃู application ุนูู ุฌูุงุฒูุ ุฒู kubectl ุฃู ูุชุตูุญ ุงูููุจุ ููุง ูุจุนุช traffic ููุนููุงู localhost:8080ุ ูุธุงู ุงูุชุดุบูู ุจุชุงุนู ูุด ุจูุทูุนู ุนูู ุงูุฅูุชุฑูุชุ ููู ุจูุฑููู ูุจุงุดุฑุฉ ุฌูู ุงูู SSH Tunnel ุงููุดูุฑ. ุงูู tunnel ุฏู ุจูููู ุงูู traffic ุจุฃูุงู ูุบุงูุฉ ูุง ููุตู ููู Bastion Host.

ุฃูู ูุง ุงูู traffic ุจููุตู ููู Bastion Hostุ ุงูู SSH service ุงููู ุนููู ุจุชููู ุฅู ุงูู traffic ุฏู ุฌุฒุก ูู ุงูู tunnelุ ูุฅููุง ูุงุฒู ุชูุฌูู ููู target ุงููู ุฅุญูุง ุญุฏุฏูุงู ูุฅุญูุง ุจููุชุญ ุงูู tunnel. ูู ูุซุงู ุงูุตูุฑุฉุ ุงูู target ูู ุงูู Green Server ุนูู port 80. ูุงูู Bastion Host ุจูุงุฎุฏ ุงูู traffic ุฏู ูููุตูู ููู Private Instance ุจุงุณุชุฎุฏุงู ุงูู private IP ุจุชุงุนูุง.

ุจุงุฎุชุตุงุฑุ ุงูู SSH Tunnel ุจูุนูู ููุจุฑู ุขูู ูู ุฌูุงุฒูุ ุจูุนุฏู ูู ุฎูุงู ุงูู Bastion Hostุ ูุจููุตู ูุจุงุดุฑุฉ ูุฃู ุณูุฑูุฑ ูู ุงูู Private Subnetุ ูุฃูู ุจุชูููู ูู ุฌูู ุดุจูุฉ AWS ุจุงูุธุจุท.

ูู ูุซูุงูุง ุจูู 

![A Visual Guide to SSH Tunnels: Local and Remote Port Forwarding](https://iximiuz.com/ssh-tunnels/local-port-forwarding-bastion-2000-opt.png)

![Securing Network Traffic With SSH Tunnels | Information Security Office](https://security.berkeley.edu/sites/default/files/styles/panopoly_image_original/public/sshtunnel1.png?itok=y6Yw7XaY&timestamp=1438209756)

```
ssh -i ./my_ssh_key_of_ec2.pem -N -L 2222:10.15.1.124:22 ec2-user@54.247.235.182
```

![image-20250815203403149](assets/image-20250815203403149.png)

ููุง ุงูุง ุฎููุช ููุชุญ ุนูู ุฌูุงุฒู port 2222 ุจุญูุซ ุงู ุญุงุฌุฉ ุชุทูุน ููู ุชุทูุน ุนู ุทุฑูู tunnel ูููbastion_hosting ูููู ุจููุชุญ port 22 ููู bastion_hosting 

ุฏูููุชู Port 2222 ุนูู ุฌูุงุฒ ุจูู port 22 ุนูู bastion_hosting ุงู ุญุงุฌุฉ ุฑุงูุญ ุงู ุฌูู ูุชุชููู ูุจุงุดุฑุฉ ุทุงููุง ุฌู ูู ip ุงููู ูุญุฏุฏู ููุชุฑูุญ ูุจุงุดุฑ ูููip 10.15.1.124

ุฏูููุชู ุนุดุงู ุงุนูู access ุจูssh ุนูู ุฌูุงุฒู ูู private 

![image-20250815203939690](assets/image-20250815203939690.png)

ููู localhost ุฎูุงุต port 22 ูู ุฌูุงุฒ bastion_hosting ุจูู ูู port 2222 ูู ุฌูุงุฒู ุทุจ ููุนุฑู ุงุฒุงู ุงูู ุงูุฌูุงุฒ ุฏู ุงูุง ูุญุฏุฏุฏ ููู ูู ssh tunnel 

> [!NOTE]
>
>  **Bastion Host ุฏุง ูุตุทูุญ ุชููู ูุด ุฌู ูู ุฏูุงุบู**ุ ุฃู ุฒู ูุง ุจูุชุณูู ุณุงุนุงุช **Jump Box** ุฃู **Jump Server**ุ ูู ุจุจุณุงุทุฉ EC2 instance ุนุงุฏู ุจูุญุทู ูู ุดุจูุฉ ูููุง ูุตูู ูุจุงุดุฑ ููุฅูุชุฑูุช (ูุนูู ูู Public Subnet).
>
> ุงููุฏู ุงูุฃุณุงุณู ููู ุฅูู ูููู ูู ุงูููุทุฉ ุงููุญูุฏุฉ ุงููู ูู ุฎูุงููุง ุจููุฏุฑ ูุนูู SSH ุฃู RDP ุนูู ุงูู instances ุงูุชุงููุฉ ุงููู ููุฌูุฏุฉ ูู ุดุจูุฉ ุฏุงุฎููุฉ ูุนุฒููุฉ (ูุนูู ูู Private Subnet). ุงูู instances ุฏู ูุด ุงูููุฑูุถ ุญุฏ ููุตููุง ูู ุงูุฅูุชุฑูุช ูุจุงุดุฑุฉ ุนุดุงู ุงูุฃูุงู.
>
> ูุจุฏู ูุง ููุชุญ ุจูุฑุชุงุช (ports) ุนูู ูู ุงูู instances ุจุชุงุนุชูุง ููุนุฑุถูุง ููุฎุทุฑุ ุจููุชุญ ุงูุจูุฑุช ุฏู ุนูู ุงูู Bastion Host ุจุณ. ูููู ุจููุฏุฑ jump ุนูู ุฃู instance ุชุงูู ุฌูู ุงูุดุจูุฉ ุงูุฎุงุตุฉ. ุฏู ุจูุฎูู ุงูุชุญูู ูู ุงูุฃูุงู ูุงููุฑุงูุจุฉ ุฃุณูู ุจูุชูุฑ ูุฃููุง ุจูุฑูุฒ ุนูู ุชุฃููู ููุทุฉ ุฏุฎูู ูุงุญุฏุฉ ุจุณ.



### **AWS Systems Manager Session Manager**

ุฏู ูุนุชุจุฑ ุงูุญู ุงูุฃุญุฏุซ ูุงูุฃูุถู ุงููู AWS ุจุชูุตุญ ุจูู ุจุดุฏุฉ.

**ุงูููุฑุฉ:** ุฃูุช **ูุด ูุญุชุงุฌ ุชูุชุญ port 22 (SSH) ุฃุตููุง** ูู ุฃู Security Group. ุฃูุช ูุด ูุญุชุงุฌ SSH keysุ ููุด ูุญุชุงุฌ Bastion Host.

**ุจูุดุชุบู ุฅุฒุงูุ**

1. **ุจุชุณุทุจ SSM Agent:** ุงูู agent ุฏู ุจูููู ูุชุณุทุจ ุจุดูู ุงูุชุฑุงุถู ุนูู ูุนุธู ุงูู AMIs ุงูุญุฏูุซุฉ ุจุชุงุนุฉ Amazon Linux ู Ubuntu ู Windows.

2. **ุจุชุนูู IAM Role:** ุจุชุนูู IAM role ุจุชุฏู ููู EC2 instance ุจุชุงุนุชู ุตูุงุญูุฉ ุฅููุง ุชููู ุฎุฏูุฉ Systems Manager (SSM).

3. **ุจุชูุตู ุนู ุทุฑูู SSM:** ุฏูููุชูุ ุจุฏู ูุง ุชุนูู SSHุ ุฃูุช ุจุชุณุชุฎุฏู AWS CLI (ุฃู ุงูู AWS Console) ุนุดุงู ุชุทูุจ ูู SSM ููุชุญูู session ุนูู ุงูู instance ุฏู.

   - **ุงูุฃูุฑ ูู ุงูู CLI:**

     codeBash

     ```
     aws ssm start-session --target <instance-id>
     ```



**ุฅูู ุงููู ุจูุญุตู ูุฑุง ุงูููุงููุณุ**

- ุงูู SSM Agent ุงููู ุนูู ุงูู instance ุจูุนูู ุงุชุตุงู **outbound** (ูู ุฌูู ูุจุฑู) ุนูู port 443 (HTTPS) ูุจููุถู ูุงุชุญ ููุงุฉ ุงุชุตุงู ุขููุฉ ูุน ุฎุฏูุฉ SSM ุจุชุงุนุฉ AWS.
- ุงููู ูู Systems Manager ![Systems Manager icon](https://icon.icepanel.io/AWS/svg/Management-Governance/Systems-Manager.svg)
- ููุง ุฃูุช ุจุชุดุบู ุฃูุฑ start-sessionุ AWS ุจุชุณุชุฎุฏู channel ุฏู ุนุดุงู ุชุฏุฎูู ุนูู ุงูู shell ุจุชุงุน ุงูู instance.

**ููู ุงูุญู ุฏู ูู ุงูุฃูุถูุ**

- **ุงูุฃูุงู ุงููุทูู:** ุฃูุช **ูุด ูุงุชุญ ุฃู inbound ports** ุนูู ุงูู instances ุจุชุงุนุชู. ูููุด port 22 ููุชูุญ ููุนุงููุ ููููุด ุฃู ูุฑุตุฉ ููุฌูุงุช ุงูู brute-force ุนูู ุงูู SSH.
- **ุฅุฏุงุฑุฉ ูุฑูุฒูุฉ (Centralized Management):** ูู ุญุงุฌุฉ ุจุชุชู ูู ุฎูุงู IAM. ุจุชูุฏุฑ ุชุญุฏุฏ ููู ุจุงูุธุจุท ููุฏุฑ ูุฎุด ุนูู ุฃููู instance.
- **ุชุฏููู ูุงูู (Auditing):** ูู session ููู ุฃูุฑ ุจูุชูุชุจ ุฌูุงูุง ูููู ูุชุณุฌู ููุชุฎุฒู ูู CloudWatch Logs ุฃู S3. ุจูุจูู ุนูุฏู ุณุฌู ูุงูู ุจูู ุญุงุฌุฉ ุญุตูุช.
- **ุณูููุฉ ุงูุงุณุชุฎุฏุงู:** ูุด ูุญุชุงุฌ ุชุฏูุฑ SSH keys ุฃู Bastion Hosts.





ุงูู SSM Agent ุงููู ุดุบุงู ุฌูู ุงูู EC2 instance ุจุชุงุนุชู ูู ูุฌุฑุฏ software ุนุงุฏู. ูู ูุด ุจูุนุฑู  ุฅูู ุชุจุน ุญุณุงุจู ุนูู AWS. ุนุดุงู ูุดุชุบู ุตุญุ ูู ูุญุชุงุฌ ูููู ุฎุฏูุฉ ssm ููุนุฑููุง ุจููุณู ููููููุง "ุฃูุง ุงูู agent ุงููู ุนูู ุงูู instance ุงูููุงููุฉุ ูุนุงูุฒ ุฃุนูู ูุฐุง ููุฐุง".

- ุฃูู ุญุงุฌุฉ ุจูุนูููุง ูู ุงูู **IAM Role** ููุณู. ุงูู Role ุฏู  ุงููู ููุฏููุง ููู instance. ุฃูู ุฌุฒุก ูู ุงูู Role ูู ุงูู **assume_role_policy** (ูุณุงุนุงุช ุจูุณูููุง Trust Policy).



ุงูู Trust Policy ุฏู ุจุชุฌุงูุจ ุนูู ุณุคุงู ูุงุญุฏ ุจุณ: **"ููู ุงููู ูุณููุญ ูู ููุจุณ ูุณุชุฎุฏุงู role ุฏู ุ"** 

```terraform
resource "aws_iam_role" "ec2_ssm_role" {
  name = "ec2-ssm-role"

  assume_role_policy = jsonencode({
    Version = "2012-10-17",
    Statement = [
      {
        Action = "sts:AssumeRole",
        Effect = "Allow",
        Principal = {

          Service = "ec2.amazonaws.com"
        }
      }
    ]
  })
}

```

**ุงูุฎุทูุฉ ุงูุซุงููุฉ:(aws_iam_role_policy_attachment)**

ุฏูููุชู ุจุนุฏ ูุง ุนูููุง "ROLE"ุ ูุงุฒู ููุฒู ุนูููุง "POLICES" ุงููู ุจุชููู  ุฏู ูุณููุญ ูู ูุนูู ุฅูู. ููุง ุจูุฌู ุฏูุฑ ุงูู **Permissions Policy**.

AWS ูุฑูุญุงูุง ูุนุงููุฉ policy ุฌุงูุฒุฉ ุงุณููุง **AmazonSSMManagedInstanceCore**. ุงูู policy ุฏู ูู ุงููู ูููุง ูู ุงูุชุตุงุฑูุญ ุงููู ุงูู SSM Agent ูุญุชุงุฌูุง ุนุดุงู ูุดุชุบู. ูู ุจุชุณูุญูู ูุนูู ุญุงุฌุงุช ูุญุฏุฏุฉ ุฌุฏูุง ุฒู:

- ssm:UpdateInstanceInformation: ุนุดุงู ุงูู agent ูุจูุบ ุฎุฏูุฉ SSM ุฅูู online ูุญุงูุชู ุฅูู.
- ssmmessages:CreateControlChannel: ุนุดุงู ููุชุญ ููุงุฉ ุงูุงุชุตุงู ุงูุขููุฉ ุงููู ุงูู session ูุชูุดู ูููุง.
- ec2messages:AcknowledgeMessage: ุนุดุงู ูุชูุงุตู ูุน ุฎุฏูุงุช EC2 ุงูุฏุงุฎููุฉ.
- ูุบูุฑูุง ูู ุงูุตูุงุญูุงุช ุงููุงุฒูุฉ ุนุดุงู ูุณุฌู ููุณู ููุชููู ุงูุฃูุงูุฑ.

ุฅุญูุง ุจูุฑุจุท ุงูู policy ุงูุฌุงูุฒุฉ ุฏู ุจุงูู Role ุจุชุงุนูุง ุจุงุณุชุฎุฏุงู resource ุงุณูู aws_iam_role_policy_attachment:



```terraform
resource "aws_iam_role_policy_attachment" "ssm_policy_attachment" {
  role       = aws_iam_role.ec2_ssm_role.name
  policy_arn = "arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore"
}
```



**ุงูุฎุทูุฉ ุงูุซุงูุซุฉ: (aws_iam_instance_profile)**

EC2 ูุด ุจุชุชุนุงูู ูุน ุงูู Roles ูุจุงุดุฑุฉุ ูู ุจุชุชุนุงูู ูุน ุญุงุฌุฉ ุงุณููุง **Instance Profile**.

```TERRAFORM
resource "aws_iam_instance_profile" "ec2_ssm_profile" {
  name = "ec2-ssm-instance-profile"
  role = aws_iam_role.ec2_ssm_role.name
}
```

![image-20250815215800132](assets/image-20250815215800132.png)

ุงู ูู ููุง 
![image-20250815221019857](assets/image-20250815221019857.png)

ุงู ูู ููุง

ููููู ููุง ูู ุนูุฏ ec2 dashboard



> [!IMPORTANT]
>
> **ููู ุงูู SSM ุจูุญุชุงุฌ NAT Gateway ูู ุงูู Private Subnet ุจุงูุฐุงุชุ**
>
> **ุงูุญุงูุฉ ุงูุฃููู: EC2 instance ูู Public Subnet**
>
> - **ุงูุงุชุตุงู:** ุงูู instance ุฏู ุจูููู ุนูุฏูุง Public IPุ ูุงูู Route Table ุจุชุงุนูุง ุจูุดุงูุฑ ุนูู Internet Gateway.
> - **ุงูู SSM Agent:** ุจููุฏุฑ ูููู ุณูุฑูุฑุงุช SSM ุนูู ุงูุฅูุชุฑูุช **ูุจุงุดุฑุฉ** ุนู ุทุฑูู ุงูู Internet Gateway.
> - **ุงููุชูุฌุฉ:** **ูุด ูุญุชุงุฌ NAT Gateway ููุง ุฎุงูุต**. ุงูู SSM ุจูุดุชุบู ุนูู ุทูู (ุทุจุนูุง ูู ุงูู IAM Role ููุฌูุฏ).
>
> 
>
> **ุงูุญุงูุฉ ุงูุซุงููุฉ (ููู ุงูุฃูู): EC2 instance ูู Private Subnet**
>
> - **ุงูุงุชุตุงู:** ุงูู instance ุฏู ูุนูุฏูุงุด Public IPุ ูุงูู Route Table ุจุชุงุนูุง ูุด ุจูุดุงูุฑ ุนูู Internet Gateway. ูู **ูุญุจูุณุฉ** ุฌูู ุงูู VPC.
> - **ูุดููุฉ ุงูู SSM Agent:** ุงูู Agent ุงููู ุฌูุงูุง ูุญุชุงุฌ ููุตู ููุฅูุชุฑูุช ุนุดุงู ูููู ุณูุฑูุฑุงุช SSM ููุณุฌู ููุณู. ูููู ูุด ููุนุฑู ูุฃูู ูุญุจูุณ.
>
> **ูููุง ุจูุฌู ุฏูุฑ ุงูู NAT Gateway ูุญู ุฅุฌุจุงุฑู:**
>
> ุงูู NAT Gateway ูู "ุงููุงุณุทุฉ" ุงููู ุจุชููุฐ ุงููููู. ูู ุจูุนูู ุงูุขุชู:
>
> 1. **ุจูููุฑ "ุทุฑูู ุฎุฑูุฌ":** ุจูุญุท route ูู ุงูู Private Route Table ุจูููู "ุฃู traffic ุนุงูุฒ ูุทูุน ูุชุ ูุฏูู ููู NAT Gateway".
> 2. **ุจูููุฑ "ูููุฉ ุนุงูุฉ":** ุงูู NAT Gateway ููุณู ุนูุฏู Public IP (ุงูู Elastic IP ุจุชุงุนู).
>
> **ุฅูู ุงููู ุจูุญุตู ููุง ุงูู SSM Agent ุจูุดุชุบูุ**
>
> 1. 
> 2. ุงูู SSM Agent ุงููู ุนูู ุงูู private instance ุจูุจุนุช request ุนุดุงู ูููู ุณูุฑูุฑุงุช SSM ุนูู ุงูุฅูุชุฑูุช.
> 3. ุงูู request ุฏู ุจูุฑูุญ ููู NAT Gateway (ุจุณุจุจ ุงูู route ุงููู ุญุทููุงู).
> 4. ุงูู NAT Gateway ุจูุงุฎุฏ ุงูู request ุฏูุ ูุจูุนูู NAT (ุจูุบูุฑ IP ุงููุตุฏุฑ ููู Public IP ุจุชุงุนู ูู)ุ ูุจูุทูุนู ุนูู ุงูุฅูุชุฑูุช ุนู ุทุฑูู **ุงูู Internet Gateway** (ูุฃู ุงูู NAT Gateway ููุณู ูุงุนุฏ ูู public subnet).







### **`Security Groups` - ุงููุงูุฑููู ุจุชุงุน ูู ูุงุฑุช ุดุจูุฉ**

ุจุต ูุงุจุงุดุงุ ุงูู **`Security Group`** ุฏู ูู ุงูู `firewall` ุงูุงูุชุฑุงุถู ุงููู ุจูุดุชุบู ูุทุจูุฉ ุฃูุงู ุฃุณุงุณูุฉ ุนูู ุงูู `EC2 instances` ุจุชุงุนุชูุ ูุจูุชุญูู ูู ูู ุงู- `traffic` ุงููู ุฏุงุฎู ูุงููู ุฎุงุฑุฌ. ูุจุดูู ุฃุฏูุ ุงูู `Security Group` ูุด ุจูุชุฑูุจ ุนูู ุงูู `instance` ููุณูุงุ ูู ุจูุชุฑูุจ ุนูู ูุฑูุช ุงูุดุจูุฉ ุจุชุงุนุชูุงุ ุงููู ูู ุงูู **`Elastic Network Interfaces (ENIs)`**.

ุงููุงุนุฏุฉ ุงูุฃุณุงุณูุฉ ุงููู ุดุบุงู ุจููุง ูู "ุงูููุน ูู ุงูุฃุตู". ูุนูู ูู ุจูููุน ูู ุญุงุฌุฉ ุจุดูู ุงูุชุฑุงุถูุ ูุฃูุช ุงููู ูุงุฒู ุชุฑูุญ ุจููุณู ูุชุถูู "ููุงุนุฏ" (`rules`) ุนุดุงู ุชุณูุญ ุจุงูู `traffic` ุงููู ุฃูุช ุนุงูุฒู ูุนุฏู. ููุง ุจุชุนูู `Security Group` ุฌุฏูุฏุ ุจููุฒู ูู ุบูุฑ ุฃู ููุงุนุฏ ุฏุฎููุ ูุจูุถูู ุฅู ูุญุฏุด ูุนุฑู ูููู ุงูุณูุฑูุฑ ุจุชุงุนู.

ูู `ENI` ูุงุฒู ูููู ูุฑุจูุท ุนูู ุงูุฃูู ุจู `Security Group` ูุงุญุฏ. ูุจูุง ุฅู ูุนุธู ุงูุณูุฑูุฑุงุช ุจูุจูู ูููุง `ENI` ูุงุญุฏ ุจุณุ ูุงููุงุณ ุจุชููู "ุงูู `Security Group` ุจุชุงุน ุงูุณูุฑูุฑ". ููู ููุง ุจุชุฑูุจ ูุฐุง `ENI` ุนูู ููุณ ุงูุณูุฑูุฑุ ูุงุฒู ุชุงุฎุฏ ุจุงูู ุฅู ูู `ENI` ูููู ูููู ูููู ููู `Security Group` ูุฎุชูู ุชูุงููุง ุจููุงุนุฏ ูุฎุชููุฉุ ูุฏู ุจูุฏููู ุชุญูู ุฏููู ุฌุฏูุง ูู ุงูู `traffic`.

ุงููุธุงู ุฏู ูุฑู ูุดุฎ. ุงูู `ENI` ุงููุงุญุฏ ูููู ุชุฑูุจ ุนููู ุฃูุชุฑ ูู `Security Group` (ูุบุงูุฉ 5)ุ ููู ููุณ ุงูููุชุ ุงูู `Security Group` ุงููุงุญุฏ ูููู ุชุฑูุจู ุนูู ุนุฏุฏ ูุง ููุงุฆู ูู ุงูู `ENIs`. ุฏู ุจูุฎููู ุชูุฏุฑ ุชุนูู `Security Group` ูุงุญุฏ ูุซูุงู ููู ุงูู `web servers` ุจุชุงุนุชู ูุชุทุจูู ุนูููู ูููู ุนุดุงู ุชูุญุฏ ููุงุนุฏ ุงูุฃูุงู.

### **Inbound Rules - ุชุญุฏูุฏ ููู ูุณููุญ ูู ูููู ุงูุณูุฑูุฑ ุจุชุงุนู**

ุงูู **Inbound Rules** ูู  ุจุชุงุนุฉ ุงูู Security Groupุ ููู ุงููู ุจุชุชุญูู ูู ููู ูุณููุญ ูู **ูุจุฏุฃ ุงุชุตุงู** ุจุงูุณูุฑูุฑ ุจุชุงุนู. ุจูุง ุฅู ุงูู Security Group ุจูููุน ูู ุญุงุฌุฉ ุจุดูู ุงูุชุฑุงุถูุ ูุฃูุช ูุงุฒู ุชุนูู rule ููู ููุน traffic ุนุงูุฒ ุชุณูุญ ุจูู. ุฃู ูุงุนุฏุฉ ุฏุฎูู ุจุชุชููู ูู 3 ุนูุงุตุฑ ุฃุณุงุณูุฉ: **Source** (ููู ุงููู ูุณููุญ ูู ูููููุ)ุ **Protocol** (ููุน ุงูุงุชุตุงู ุฅููุ ุฒู TCP ุฃู UDP)ุ ู **Port Range** (ุนูู ุฃููู port ูุณููุญ ูู ูููููุ).

ููุซุงู ุนูููุ ุชุฎูู ุนูุฏู web server ุนุงูุฒ ุงููุงุณ ุชุดูู ุงููููุน ุจุชุงุนูุ ููู ููุณ ุงูููุช ุฃูุช ูุญุชุงุฌ ุชุฎุด ุนููู SSH ุนุดุงู ุชุฏูุฑู. ููุง ูุชุญุชุงุฌ ุชุนูู ูุงุนุฏุชูู ูุฎุชููุชูู. ุงููุงุนุฏุฉ ุงูุฃููู ูุชูุชุญ **port 443** (ุจุชุงุน HTTPS) ูุชุฎูู ุงูู Source ุจุชุงุนูุง ูู **0.0.0.0/0**ุ ูุฏู ูุนูุงู "ุงุณูุญ ูุฃู IP ูู ุงูุนุงูู ุฅูู ููุชุญ ุงููููุน ุจุชุงุนู". ุฃูุง ุงููุงุนุฏุฉ ุงูุชุงููุฉุ ูุนุดุงู ุงูุฃูุงูุ ูุชูุชุญ **port 22** (ุจุชุงุน SSH) ูุชุฎูู ุงูู Source ุจุชุงุนูุง ูู ุงูู IP ุจุชุงุนู ุฃูุช ุจุณ (ูุซูุงู **198.51.100.10/32**)ุ ูุฏู ูุนูุงู "ุงุณูุญ ููู IP ุจุชุงุนู ุฃูุง ุจุณ ุฅูู ุฃุนูู SSH".

| `Source`           | `Protocol` | `Port Range` | ุงููุตู                                      |
| :----------------- | :--------- | :----------- | :----------------------------------------- |
| `0.0.0.0/0`        | `TCP`      | `443`        | ุงุณูุญ ูุฃู ุญุฏ ูู ุงูุนุงูู ููุชุญ ุงููููุน ุจุชุงุนู.   |
| `198.51.100.10/32` | `TCP`      | `22`         | ุงุณูุญ ููู `IP` ุจุชุงุนู ุฃูุง ุจุณ ุฅูู ุฃุนูู `SSH`. |

**ููุญูุธุฉ ูููุฉ ุฌุฏูุง:** ุชุฑุชูุจ ุงูููุงุนุฏ ุฏู ูุด ููู ุฎุงูุต. AWS ุจุชุจุต ุนูู ูู ุงูููุงุนุฏ ุงููู ุฃูุช ุญุงุทุทูุงุ ููู ููุช ุฃู ูุงุนุฏุฉ ูุงุญุฏุฉ ุจุณ ุจุชุทุงุจู ุงูู traffic ุงููู ุฌุงูุ ุจุชุณูุญ ูู ูุนุฏู ุนูู ุทูู.



### **ูุซุงู `Terraform`**

ุฏู ููุฏ `Terraform` ุงููู ุจูุจูู `Security Group` ุจููุณ ุงูููุงุนุฏ ุงููู ูู ุงูุฌุฏูู ุงููู ููู ุจุงูุธุจุท:

```terraform
resource "aws_security_group" "web_server_sg" {
  name        = "web-server-sg"
  description = "Allow HTTPS and SSH access"
  vpc_id      = aws_vpc.main.id 


  ingress {
    description = "Allow HTTPS traffic from anywhere"
    from_port   = 443
    to_port     = 443
    protocol    = "tcp"
    cidr_blocks = ["0.0.0.0/0"]
  }


  ingress {
    description = "Allow SSH traffic from my IP only"
    from_port   = 22
    to_port     = 22
    protocol    = "tcp"

    cidr_blocks = ["198.51.100.10/32"] 
  }



  tags = {
    Name = "WebServer-SG"
  }
}
```



---

### **`Outbound Rules` - ุชุญุฏูุฏ ุงูุณูุฑูุฑ ุจุชุงุนู ูุณููุญ ูู ูููู ููู**

ุงูู **`Outbound Rules`** ูู "ูุงููุฉ ุงูุณูุงุญ ุจุงูุฎุฑูุฌ" ุจุชุงุนุฉ ุงูู `Security Group`. ูู ุงููู ุจุชุชุญูู ูู ุงูู `traffic` ุงููู **ุทุงูุน ูู** ุงูุณูุฑูุฑ ุจุชุงุนู ููุณููุญ ูู ูุฑูุญ ููู. ุฒู ุงูู `Inbound Rules` ุจุงูุธุจุทุ ุฃู ูุงุนุฏุฉ ุฎุฑูุฌ ุจุชุชููู ูู 3 ุนูุงุตุฑ ุฃุณุงุณูุฉ:
1.  **`Destination` (ุงููุฌูุฉ):** ุงูุณูุฑูุฑ ุจุชุงุนู ูุณููุญ ูู ูููู ุฃููู `IPs`ุ
2.  **`Protocol` (ุงูุจุฑูุชูููู):**
3.  **`Port Range` (ูุฏู ุงูุจูุฑุชุงุช):**

ูู ูุนุธู ุงูุญุงูุงุชุ ููุงุนุฏ ุงูุฎุฑูุฌ ุจุชููู ุฃูู ุชูููุฏูุง ุจูุชูุฑ ูู ููุงุนุฏ ุงูุฏุฎูู. ูุนุดุงู ุชุณูู ุนูููุ `AWS` ุจุดูู ุฃูุชููุงุชููู ุจุชุญุทูู ูุงุนุฏุฉ ุฎุฑูุฌ ุงูุชุฑุงุถูุฉ ุฃูู ูุง ุจุชุนูู ุฃู `Security Group` ุฌุฏูุฏ.

ุงููุงุนุฏุฉ ุงูุงูุชุฑุงุถูุฉ ุฏู ุจุชููู ุจุงูููุธุฑ ุฏู:

| `Destination` | `Protocol` | `Port Range` | ุงููุตู                                               |
| :------------ | :--------- | :----------- | :-------------------------------------------------- |
| `0.0.0.0/0`   | `All`      | `All`        | ุงุณูุญ ููุณูุฑูุฑ ุฏู ูููู ุฃู ุญุฏ ูู ุฃู ุญุชุฉ ุนูู ุฃู `port`. |

**ุงููุฏู ุงูุฃุณุงุณู ูู ุงููุงุนุฏุฉ ุฏู** ูู ุฅููุง ุชุณูุญ ููู `instance` ุจุชุงุนุชู ุฅููุง ุชูุตู ููุฅูุชุฑูุช ุนุดุงู ุชุนูู `download` ููู `updates` (ุฒู `apt update`)ุ ุฃู ุชููู ุฎุฏูุงุช `AWS` ุงูุชุงููุฉุ ุฃู ุชุชุตู ุจุฃู `API` ุฎุงุฑุฌู. ุฃูุช ูููู ุชูุณุญ ุงููุงุนุฏุฉ ุฏูุ ููู ูู ุนููุช ูุฏูุ ุงูู `Security Group` ููููุน ุงูู `instance` ุจุชุงุนุชู ุฅููุง ุชููู ุงูุฅูุชุฑูุช ุฃู ุฃู ุญุงุฌุฉ ุชุงููุฉ ุจุฑูุ ููุชุจูู ูุญุจูุณุฉ ุชูุงููุง (ุฅูุง ูู ุนููุช ููุงุนุฏ ุฎุฑูุฌ ุชุงููุฉ ุฃูุซุฑ ุชุญุฏูุฏูุง).

---
### 

#### **1. `Terraform` ุจุงูู `Outbound Rule` ุงูุงูุชุฑุงุถูุฉ:**
`Terraform` ุฐูู ููุงูุฉ ุฅูู ุจูุนูู ููุณ ุณููู `AWS`. ูู ูุนููุชุด ุฃู ุจููู `egress`ุ ูู ููุนูู `Allow All` ุฃูุชููุงุชูู. ููู ุงูู `best practice` ูู ุฅูู ุชูุชุจูุง ุจุดูู ุตุฑูุญ ุนุดุงู ุงูููุฏ ุจุชุงุนู ูุจูู ูุงุถุญ.

```terraform
resource "aws_security_group" "default_outbound_sg" {
  name   = "default-outbound-sg"
  vpc_id = aws_vpc.main.id


  ingress {
    from_port   = 22
    to_port     = 22
    protocol    = "tcp"
    cidr_blocks = ["YOUR_IP/32"]
  }


  egress {
    from_port   = 0       
    to_port     = 0       
    protocol    = "-1"    
    cidr_blocks = ["0.0.0.0/0"] # ูุฃู ุญุชุฉ ูู ุงูุนุงูู
  }
}
```



---





---

### **`Sources` ู `Destinations` (ุงููุตุงุฏุฑ ูุงููุฌูุงุช)**

ุงูู `source` (ูู ุงูู `inbound rule`) ุฃู ุงูู `destination` (ูู ุงูู `outbound rule`) ูููู ูููู ุฃู `CIDR block`. ููู ุงูุฃููู ูู ูุฏูุ ุฅู ุงูู `source` ูููู ูููู ุงูู **`resource ID` ุจุชุงุน `security group` ุชุงูู**.

ูู ุญุฏุฏุช `security group` ูู `source`ุ ุงููุงุนุฏุฉ ุฏู ูุชุณูุญ ุจุงูู `traffic` ุงููู ุฌุงู ูู **ุฃู `instance` ูุชุฑูุจ ุนูููุง ุงูู `security group` ุฏู**. ุฏู ุจูุฎูู ุนูููุฉ ุงูุณูุงุญ ููู `instances` ุฅููุง ุชููู ุจุนุถูุง ุณููุฉ ุฌุฏูุงุ ุจูุฌุฑุฏ ุฅูู ุชุฏููู ูููู ููุณ ุงูู `security group`.

**ุงููุดููุฉ ุจุงูุทุฑููุฉ ุงูุชูููุฏูุฉ:**
ุชุฎูู ุฅูู ุนูุฏู `Web Server` ุนุงูุฒ ูููู `Database Server`. ุงูุทุฑููุฉ ุงูุจุฏุงุฆูุฉ ูู ุฅูู ุชุฑูุญ ุนูู ุงูู `Security Group` ุจุชุงุน ุงูู `Database` ูุชุถูู `Inbound Rule` ุจุชููู:
"ุงุณูุญ ุจุงูุงุชุตุงู ุนูู `port 3306` ูู **ุงูู `Private IP`** ุจุชุงุน ุงูู `Web Server`".

**ุนููุจ ุงูุทุฑููุฉ ุฏู:**

1.  **ูุด ุฏููุงููููุฉ:** ูู ูุณุญุช ุงูู `Web Server` ุฏู ูุนููุช ูุงุญุฏ ุฌุฏูุฏุ ููุงุฎุฏ `Private IP` ุฌุฏูุฏุ ูุณุงุนุชูุง ูุงุฒู ุชุฑูุญ ุชุนุฏู ุงูู `Security Group Rule` ุฏู ุจุฅูุฏู ูุชุญุท ุงูู `IP` ุงูุฌุฏูุฏ.
2.  **ุตุนุจุฉ ูู ุญุงูุฉ ุงูู `Auto Scaling`:** ูู ุนูุฏู `Auto Scaling Group` ุจูุนูู `launch` ูุนุดุฑุงุช ุงูู `Web Servers`ุ ููุจูู ูุณุชุญูู ุชุถูู `IP` ูู `server` ุฌุฏูุฏ ููู `Rule` ุฏู.

---

**ุงูุญู : ุงุณุชุฎุฏุงู `Security Group ID`**

`AWS` ุนููุช ุญู ุนุจูุฑู ูููุดููุฉ ุฏู. ุจุฏู ูุง ุชููู "ุงุณูุญ ููู `IP` ุงูููุงูู"ุ ุฃูุช ุจุชููู **"ุงุณูุญ ูุฃู `instance` ูุนุงูุง Security Group"**.

**ุฅุฒุงู ุจุชุดุชุบูุ**

1.  **ุจุชุนูู `Security Group` ููู `Web Servers`:** ููุณููู `web-sg`. ุฃู `web server` ุฌุฏูุฏ ุจุชุนูููุ ุจุชุฑูุจ ุนููู ุงูู `SG` ุฏู.
2.  **ุจุชุนูู `Security Group` ููู `Database Servers`:** ููุณููู `db-sg`.
3.  **ุจุชุนูู "ุนูุงูุฉ ุซูุฉ" ุจูููู:**
    ุจุชุฑูุญ ุนูู ุงูู `Security Group` ุจุชุงุน ุงูู `Database` (`db-sg`)ุ ูุจุชุถูู `Inbound Rule` ุจุชููู ุงูุขุชู:
    *   `Protocol`: `TCP`
    *   `Port Range`: `3306`
    *   `Source`: **ุงูู `ID` ุจุชุงุน `web-sg`** (ูุซูุงู `sg-12345678`).

**ูุนูู ุงููุงุนุฏุฉ ุฏู ุฅูู ุจุงูุธุจุทุ**
ุงููุงุนุฏุฉ ุฏู ุจุชููู ูู `AWS`:

> "ูุง `AWS`ุ ุฑุงูุจู ุฃู `traffic` ุฌุงู ุนูู `port 3306`. ูู ุงูู `packet` ุฏู ุฌุงู ูู **`ENI` ูุชุฑูุจ ุนููู `web-sg`**ุ ุงุณูุญููู ูุนุฏู. ูู ุฌุงู ูู ุฃู ุญุชุฉ ุชุงููุฉุ ุงููุนูู."

`AWS` ููุง ูุด ุจุชุจุต ุนูู ุงูู `IP` ุฎุงูุตุ ูู ุจุชุจุต ุนูู `Security Group ID` ุงููู ุงูู `ENI` ูุงุจุณูุง.

---

### **ุชุทุจูููุง ูู `Terraform` (ูู ุงููุซุงู ุจุชุงุน ุงูู `Egress Rule`)**

ูู ุงููุซุงู ุงููู ูุงุชุ ุฅุญูุง ููุง ุจูุนูู `Outbound Rule` ููู `Application Server`.

```terraform
  egress {
    description     = "Allow traffic to the RDS database"
    from_port       = 3306
    to_port         = 3306
    protocol        = "tcp"
    security_groups = [aws_security_group.database_sg.id]
  }
```



*   `security_groups = [aws_security_group.database_sg.id]`:
    ุฏู ูุนูุงู ุฅู ุงูู `Application Server` ุฏู ูุณููุญ ูู ูุทูุน `traffic` ุนูู `port 3306` **ููุท ูููุท** ูู ุงูู `Destination IP` ุจุชุงุน ุงูู `traffic` ุฏู ูู `Private IP` ุจุชุงุน `ENI` ูุชุฑูุจ ุนููู `database_sg`.
    ุฃูุช ูุฏู ุนููุช `firewall rule` ุฐููุฉ ูุฏููุงููููุฉ ุฌุฏูุง.

*   **`Inbound` ุนูู ุงูู `DB`:** ูุด ุจูุณุชูุจู ุบูุฑ ูู ุงููู ูุงุจุณูู `web-sg`.
*   **`Outbound` ูู ุงูู `App`:** ูุด ุจูุทูุน ุบูุฑ ููู ูุงุจุณูู `db-sg`.

ุฃูุช ูุฏู ุจููุช "ููู" ุขูู ููููู ุจูู ุงูู `application tier` ูุงูู `database tier` ุจุชุงุนุชู ูู ุบูุฑ ูุง ุชูุชุจ `IP` ูุงุญุฏ ุจุฅูุฏู. ูู ุนููุช `scale` ููู `web servers` ูู 100 ุณูุฑูุฑุ ูููู ููุนุฑููุง ูููููุง ุงูู `database` ุฃูุชููุงุชูู. ููู ุบูุฑุช ุงูู `database server`ุ ุงูู `web servers` ูุชูุถู ุนุงุฑูุฉ ุชูููู ุทุงููุง ูุชุฑูุจ ุนููู ููุณ ุงูู `db-sg`.

**ููุทุฉ ูุชูุฏูุฉ:**
ุงูู `source security group` ุงููู ุจุชุณุชุฎุฏูู ูููู ูููู ููุฌูุฏ ูู `AWS account` ุชุงูู ุฎุงูุต. ูู ุงูุญุงูุฉ ุฏูุ ูุชุญุชุงุฌ ุชุญุฏุฏ ุงูู `AWS account owner ID` ุนุดุงู ุชุนุฑู ุชุณุชุฎุฏู `security group` ูู ุญุณุงุจ ูุฎุชูู.

---

### **`Stateful Firewall`**

ุงูู `Security Group` ุจูุดุชุบู ูู **`stateful firewall`**. ูููุฉ `Stateful` ุฏู ูู ุฃูู ุฎุงุตูุฉ ูููุ ููุนูุงูุง ุฅูู "ุจูุญุชูุธ ุจุญุงูุฉ ุงูุงุชุตุงู" ุฃู "ุจููุชูุฑ" ุงูู `connections`.

**ูุนูู ุฅููุ**
ูุนูุงู ุฅูู ููุง `security group` ุจูุณูุญ ูู `traffic` ุฅูู ูุนุฏู ูู ุงุชุฌุงูุ ูู **ุจุดูู ุฐูู ุจูุณูุญ ููุฑุฏ ุจุชุงุน ููุณ ุงูู `traffic` ุฏู ุฅูู ูุฑุฌุน ูู ุงูุงุชุฌุงู ุงูุนูุณู**ุ ูู ุบูุฑ ูุง ุชุญุชุงุฌ ุชุนูู `rule` ูุฎุตูุตุฉ ููุฑุฏ.

*   **ูุซุงู:** ููุง ุจุชุณูุญ ูู `instance` ุฅููุง ุชุนูู ุงุชุตุงู ุฎุฑูุฌ (`outbound`) ุนุดุงู ุชุนูู `download` ูู `updates` ูู ุนูู ุงูุฅูุชุฑูุชุ ุงูู `security group` ุจูุณูุญ ุฃูุชููุงุชูู ููุฑุฏูุฏ ุจุชุงุนุฉ ุงูู `download` ุฏู ุฅููุง ุชุฑุฌุน ูุชุฎุด ููู `instance` ุจุชุงุนุชู.

ุงูู `Security groups` ุจุชุณุชุฎุฏู ุญุงุฌุฉ ุงุณููุง **`connection tracking`** ุนุดุงู ุชูุฑุฑ ุชุณูุญ ููุฑุฏูุฏ ุฏู ุชุนุฏู ููุง ูุฃ. ุจุงููุณุจุฉ ููู `TCP` ู `UDP` `traffic`ุ ุงูู `connection tracking` ุจูุจุต ุนูู ูุนูููุงุช ุงูู `flow` (ุชุฏูู ุงูุจูุงูุงุช) ููู `packet` ุจูุนุฏู ุจูุงุกู ุนูู ูุงุนุฏุฉ ุฃูุช ุญุงุทุทูุง. ุนู ุทุฑูู ูุชุงุจุนุฉ ุงูู `flows` ุฏูุ ุงูู `security group` ุจููุฏุฑ ูููุฒ ุจูู ุงูู `reply traffic` (ุงูุฑุฏูุฏ) ุงููู ุชุจุน ููุณ ุงูู `flow` ูุจูู ุฃู `unsolicited traffic` (ุงุชุตุงู ุฌุฏูุฏ ูุญุฏุด ุทูุจู).

ูุนูููุงุช ุงูู `flow` ุฏู ุจุชุดูู:
*   **`Protocol`**
*   **`Source` ู `destination IP address`**
*   **`Source` ู `destination port number`**

---

### **`Default Security Group` **

ูู `VPC` ุจูููู ุฌูุงู `default security group` **ููููุนุด ูุชูุณุญ**. ุฃูุช ูุด ูุฌุจุฑ ุชุณุชุฎุฏููุ ููู ูู ุงุณุชุฎุฏูุชูุ ุชูุฏุฑ ุชุนุฏู ุงูููุงุนุฏ ุจุชุงุนุชู ุนุดุงู ุชูุงุณุจ ุงุญุชูุงุฌุงุชู. ุงูุญู ุงูุจุฏูู ูุงูุฃูุถู ูู ุฅูู ุชุฎุชุงุฑ ุชุนูู `custom group` (ูุฌููุนุฉ ูุฎุตุตุฉ) ุจุชุงุนุชู ูุชุณุชุฎุฏููุง ุจุฏููุง ููู.



